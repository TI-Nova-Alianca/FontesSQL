USE [MercanetPRD]
GO

/****** Object:  StoredProcedure [dbo].[MERCP_CONCORRENTE_INTEGRACOES]    Script Date: 10/05/2022 11:54:31 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



ALTER PROCEDURE [dbo].[MERCP_CONCORRENTE_INTEGRACOES] (@P_TIPO INT) AS

BEGIN

-- Cria sononimos para os caminhos/nomes das tabelas, de modo que possa ser usada a mesma
-- rotina de integracao, mas acessando o database correto cfe. cada ambiente.
EXEC MERCP_CRIA_SINONIMOS_TABELAS;
																	  

	 

DECLARE @VOBJETO       VARCHAR(100) SELECT @VOBJETO = 'MERCP_CONCORRENTE_INTEGRACOES';
DECLARE @VDATA         DATETIME;
DECLARE @VERRO         VARCHAR(1000);
DECLARE @VCOD_ERRO     VARCHAR(1000);
DECLARE @VD_E_L_E_T_   VARCHAR(50);
DECLARE @VR_E_C_N_O_   FLOAT;
DECLARE @VR_E_C_D_E_L_ FLOAT;

DECLARE @C_INTERFACE       CURSOR;
DECLARE @VR_E_C_N_O_CURSOR INT;
DECLARE @C_LISTA_PROD      CURSOR;
DECLARE @C_CIDADES         CURSOR;
DECLARE @C_ESTADOS         CURSOR;
DECLARE @C_PAISES          CURSOR;
DECLARE @C_RAMOS_1         CURSOR;
DECLARE @C_RAMOS_2         CURSOR;
DECLARE @C_PORTADORES      CURSOR;
DECLARE @C_TRANSPORTADORAS CURSOR;
DECLARE @C_TPPROD          CURSOR;
DECLARE @C_MARCA           CURSOR;
DECLARE @C_FAMILIA         CURSOR;
DECLARE @C_GRUPO           CURSOR;
DECLARE @C_PEDIDO_PROD     CURSOR;
DECLARE @C_NOTA_PROD       CURSOR;
DECLARE @C_NOTA_DEV_PROD   CURSOR;
DECLARE @C_CLASCOM         CURSOR;
DECLARE @C_PROMOTORES      CURSOR;

-- VARIAVEIS PARA CLIENTE (SA1)
DECLARE @VA1_FILIAL   VARCHAR(50),  @VA1_COD      VARCHAR(50),  @VA1_LOJA     VARCHAR(50),  @VA1_NOME     VARCHAR(50),  @VA1_PESSOA   VARCHAR(50),
        @VA1_CGC      VARCHAR(50),  @VA1_END      VARCHAR(50),  @VA1_BAIRRO   VARCHAR(50),  @VA1_INSCR    VARCHAR(50),  @VA1_MUN      VARCHAR(50),
        @VA1_EST      VARCHAR(50),  @VA1_CEP      VARCHAR(50),  @VA1_CONTATO  VARCHAR(50),  @VA1_DDI      VARCHAR(50),  @VA1_TEL      VARCHAR(50),
        @VA1_ULTCOM   VARCHAR(50),  @VA1_NREDUZ   VARCHAR(50),  @VA1_ENDCOB   VARCHAR(50),  @VA1_BAIRROC  VARCHAR(50),  @VA1_MUNC     VARCHAR(50),
        @VA1_ESTC     VARCHAR(50),  @VA1_CEPC     VARCHAR(50),  @VA1_FAX      VARCHAR(50),  @VA1_TIPO     VARCHAR(50),  @VA1_NATUREZ  VARCHAR(50),
        @VA1_CONTA    VARCHAR(50),  @VA1_RISCO    VARCHAR(50),  @VA1_ATIVIDA  VARCHAR(50),  @VA1_TELEX    VARCHAR(50),  @VA1_ENDENT   VARCHAR(50),
        @VA1_ENDREC   VARCHAR(50),  @VA1_RECINSS  VARCHAR(50),  @VA1_INSCRM   VARCHAR(50),  @VA1_COMIS    FLOAT,        @VA1_REGIAO   VARCHAR(50),
        @VA1_BCO1     VARCHAR(50),  @VA1_BCO2     VARCHAR(50),  @VA1_BCO3     VARCHAR(50),  @VA1_BCO4     VARCHAR(50),  @VA1_BCO5     VARCHAR(50),
        @VA1_TRANSP   VARCHAR(50),  @VA1_TPFRET   VARCHAR(50),  @VA1_COND     VARCHAR(50),  @VA1_CLASSE   VARCHAR(50),  @VA1_DESC     FLOAT,
        @VA1_PRIOR    VARCHAR(50),  @VA1_LC       FLOAT,        @VA1_VENCLC   VARCHAR(50),  @VA1_MCOMPRA  FLOAT,        @VA1_METR     FLOAT,
        @VA1_MSALDO   FLOAT,        @VA1_NROCOM   FLOAT,        @VA1_PRICOM   VARCHAR(50),  @VA1_TEMVIS   FLOAT,        @VA1_ULTVIS   VARCHAR(50),
        @VA1_MENSAGE  VARCHAR(50),  @VA1_NROPAG   FLOAT,        @VA1_SALDUP   FLOAT,        @VA1_SALPEDL  FLOAT,        @VA1_SUFRAMA  VARCHAR(50),
        @VA1_TRANSF   VARCHAR(50),  @VA1_ATR      FLOAT,        @VA1_VACUM    FLOAT,        @VA1_SALPED   FLOAT,        @VA1_TITPROT  FLOAT,
        @VA1_DTULTIT  VARCHAR(50),  @VA1_CHQDEVO  FLOAT,        @VA1_DTULCHQ  VARCHAR(50),  @VA1_MATR     FLOAT,        @VA1_MAIDUPL  FLOAT,
        @VA1_TABELA   VARCHAR(50),  @VA1_INCISS   VARCHAR(50),  @VA1_AGREG    VARCHAR(50),  @VA1_SALDUPM  FLOAT,        @VA1_PAGATR   FLOAT,
        @VA1_CARGO1   VARCHAR(50),  @VA1_CARGO2   VARCHAR(50),  @VA1_CARGO3   VARCHAR(50),  @VA1_SUPER    VARCHAR(50),  @VA1_RTEC     VARCHAR(50),
        @VA1_ALIQIR   FLOAT,        @VA1_OBSERV   VARCHAR(50),  @VA1_CALCSUF  VARCHAR(50),  @VA1_RG       VARCHAR(50),  @VA1_DTNASC   VARCHAR(50),
        @VA1_SALPEDB  FLOAT,        @VA1_CLIFAT   VARCHAR(50),  @VA1_GRPTRIB  VARCHAR(50),  @VA1_BAIRROE  VARCHAR(50),  @VA1_CEPE     VARCHAR(50),
        @VA1_MUNE     VARCHAR(50),  @VA1_ESTE     VARCHAR(50),  @VA1_SATIV1   VARCHAR(50),  @VA1_SATIV2   VARCHAR(50),  @VA1_SATIV3   VARCHAR(50),
        @VA1_SATIV4   VARCHAR(50),  @VA1_SATIV5   VARCHAR(50),  @VA1_SATIV6   VARCHAR(50),  @VA1_CODMUN   VARCHAR(50),  @VA1_SATIV7   VARCHAR(50),
        @VA1_SATIV8   VARCHAR(50),  @VA1_CODHIST  VARCHAR(50),  @VA1_PAIS     VARCHAR(50),  @VA1_EMAIL    VARCHAR(70),  @VA1_HPAGE    VARCHAR(50),
        @VA1_OBS      VARCHAR(50),  @VA1_CODMARC  VARCHAR(50),  @VA1_TMPSTD   VARCHAR(50),  @VA1_COMAGE   FLOAT,        @VA1_DEST_3   VARCHAR(50),
        @VA1_ESTADO   VARCHAR(50),  @VA1_CXPOSTA  VARCHAR(50),  @VA1_DEST_2   VARCHAR(50),  @VA1_CODAGE   VARCHAR(50),  @VA1_TIPCLI   VARCHAR(50),
        @VA1_CONDPAG  VARCHAR(50),  @VA1_DEST_1   VARCHAR(50),  @VA1_DIASPAG  FLOAT,        @VA1_CLASVEN  VARCHAR(50),  @VA1_FORMVIS  VARCHAR(50),
        @VA1_RECCOFI  VARCHAR(50),  @VA1_RECCSLL  VARCHAR(50),  @VA1_RECPIS   VARCHAR(50),  @VA1_TMPVIS   VARCHAR(50),  @VA1_PFISICA  VARCHAR(50),
        @VA1_LCFIN    FLOAT,        @VA1_MOEDALC  FLOAT,        @VA1_RECISS   VARCHAR(50),  @VA1_DDD      VARCHAR(50),  @VA1_TIPPER   VARCHAR(50),
        @VA1_COD_MUN  VARCHAR(50),  @VA1_SALFIN   FLOAT,        @VA1_SALFINM  FLOAT,        @VA1_B2B      VARCHAR(50),  @VA1_GRPVEN   VARCHAR(50),
        @VA1_VEND     VARCHAR(50),  @VA1_CLICNV   VARCHAR(50),  @VA1_SITUA    VARCHAR(50),  @VA1_TPESSOA  VARCHAR(50),  @VA1_ABATIMP  VARCHAR(50),
        @VA1_TPISSRS  VARCHAR(50),  @VA1_CTARE    VARCHAR(50),  @VA1_RECFET   VARCHAR(50),  @VA1_MSBLQL   VARCHAR(1),   @VA1_VACANAL  VARCHAR(100),
        @VA1_SIMPNAC  INT,          @VA1_OBSALI   VARCHAR(50),  @VA1_CNAE     VARCHAR(15),  @VA1_VAREGE   VARCHAR(10),  @VA1_VAOC     VARCHAR(50),
        @VA1_VAPROMO  VARCHAR(50),	@VA1_CONTAT3  VARCHAR(15),	@VA1_TELCOB   VARCHAR(15),	@VA1_VAEMLF   VARCHAR(60),	@VA1_VABCOF   VARCHAR(3),
		@VA1_VAAGFIN  VARCHAR(5),   @VA1_VACTAFN  VARCHAR(12),  @VA1_VACGCFI  VARCHAR(14),  @VA1_VEND2    VARCHAR(50),  @VA1_TABELA2  VARCHAR(50);

-- VARIAVEIS PARA REPRESENTANE (SA3)
DECLARE @VA3_FILIAL   VARCHAR(50),  @VA3_COD      VARCHAR(50),  @VA3_NOME     VARCHAR(50),  @VA3_NREDUZ   VARCHAR(50),  @VA3_END      VARCHAR(50),
        @VA3_BAIRRO   VARCHAR(50),  @VA3_MUN      VARCHAR(50),  @VA3_EST      VARCHAR(50),  @VA3_CEP      VARCHAR(50),  @VA3_FORNECE  VARCHAR(50),
        @VA3_LOJA     VARCHAR(50),  @VA3_GERASE2  VARCHAR(50),  @VA3_BCO1     VARCHAR(50),  @VA3_REGIAO   VARCHAR(50),  @VA3_CGC      VARCHAR(50),
        @VA3_COMIS    FLOAT,        @VA3_FAX      VARCHAR(50),  @VA3_TEL      VARCHAR(50),  @VA3_TELEX    VARCHAR(50),  @VA3_INSCRM   VARCHAR(50),
        @VA3_INSCR    VARCHAR(50),  @VA3_FRETE    VARCHAR(50),  @VA3_ICM      VARCHAR(50),  @VA3_IPI      VARCHAR(50),  @VA3_ICMSRET  VARCHAR(50),
        @VA3_ACREFIN  VARCHAR(50),  @VA3_ALBAIXA  FLOAT,        @VA3_ALEMISS  FLOAT,        @VA3_TIPO     VARCHAR(50),  @VA3_GEREN    VARCHAR(50),
        @VA3_SUPER    VARCHAR(50),  @VA3_PERDESC  FLOAT,        @VA3_DIARESE  FLOAT,        @VA3_EMAIL    VARCHAR(50),  @VA3_HPAGE    VARCHAR(50),
        @VA3_DIA      FLOAT,        @VA3_DDD      VARCHAR(50),  @VA3_CLIFIM   VARCHAR(50),  @VA3_CLIINI   VARCHAR(50),  @VA3_CODUSR   VARCHAR(50),
        @VA3_PEDFIM   VARCHAR(50),  @VA3_PEDINI   VARCHAR(50),  @VA3_PROXCLI  VARCHAR(50),  @VA3_PROXPED  VARCHAR(50),  @VA3_SENHA    VARCHAR(50),
        @VA3_GRPREP   VARCHAR(50),  @VA3_ISS      VARCHAR(50),  @VA3_FAT_RH   VARCHAR(50),  @VA3_GRUPSAN  VARCHAR(50),  @VA3_DEPEND   VARCHAR(50),
        @VA3_PEN_ALI  FLOAT,        @VA3_TIPVEND  VARCHAR(50),  @VA3_DDDTEL   VARCHAR(50),  @VA3_NUMRA    VARCHAR(50),  @VA3_ATIVO    VARCHAR(1);

-- VARIAVEIS PARA PRODUTOS (SB1)
DECLARE @VB1_FILIAL   VARCHAR(50),  @VB1_COD      VARCHAR(50),  @VB1_DESC     VARCHAR(50),  @VB1_TIPO     VARCHAR(50),  @VB1_UM       VARCHAR(50),
        @VB1_LOCPAD   VARCHAR(50),  @VB1_GRUPO    VARCHAR(50),  @VB1_TAB_IPI  VARCHAR(50),  @VB1_ORIGEM   VARCHAR(50),  @VB1_CLASFIS  VARCHAR(50),
        @VB1_CONTA    VARCHAR(50),  @VB1_CC       VARCHAR(50),  @VB1_TE       VARCHAR(50),  @VB1_TS       VARCHAR(50),  @VB1_PROC     VARCHAR(50),
        @VB1_IPI      FLOAT,        @VB1_PICM     FLOAT,        @VB1_LE       FLOAT,        @VB1_LM       FLOAT,        @VB1_IRRF     VARCHAR(50),
        @VB1_POSIPI   VARCHAR(50),  @VB1_EX_NCM   VARCHAR(50),  @VB1_EX_NBM   VARCHAR(50),  @VB1_ALIQISS  FLOAT,        @VB1_CODISS   VARCHAR(50),
        @VB1_PICMRET  FLOAT,        @VB1_PICMENT  FLOAT,        @VB1_IMPZFRC  VARCHAR(50),  @VB1_BITMAP   VARCHAR(50),  @VB1_SEGUM    VARCHAR(50),
        @VB1_CONV     FLOAT,        @VB1_TIPCONV  VARCHAR(50),  @VB1_ALTER    VARCHAR(50),  @VB1_INSS     VARCHAR(50),  @VB1_QE       FLOAT,
        @VB1_PRV1     FLOAT,        @VB1_EMIN     FLOAT,        @VB1_CUSTD    FLOAT,        @VB1_UPRC     FLOAT,        @VB1_UCOM     VARCHAR(50),
        @VB1_PESO     FLOAT,        @VB1_ESTSEG   FLOAT,        @VB1_ESTFOR   VARCHAR(50),  @VB1_FORPRZ   VARCHAR(50),  @VB1_PE       FLOAT,
        @VB1_TIPE     VARCHAR(50),  @VB1_TOLER    FLOAT,        @VB1_FAMILIA  VARCHAR(50),  @VB1_LOJPROC  VARCHAR(50),  @VB1_QB       FLOAT,
        @VB1_APROPRI  VARCHAR(50),  @VB1_FANTASM  VARCHAR(50),  @VB1_TIPODEC  VARCHAR(50),  @VB1_DATREF   VARCHAR(50),  @VB1_RASTRO   VARCHAR(50),
        @VB1_UREV     VARCHAR(50),  @VB1_FORAEST  VARCHAR(50),  @VB1_COMIS    FLOAT,        @VB1_MONO     VARCHAR(50),  @VB1_MRP      VARCHAR(50),
        @VB1_PERINV   FLOAT,        @VB1_DTREFP1  VARCHAR(50),  @VB1_GRTRIB   VARCHAR(50),  @VB1_NOTAMIN  FLOAT,        @VB1_PRVALID  FLOAT,
        @VB1_NUMCOP   FLOAT,        @VB1_CONTSOC  VARCHAR(50),  @VB1_CONINI   VARCHAR(50),  @VB1_CODBAR   VARCHAR(50),  @VB1_GRADE    VARCHAR(50),
        @VB1_FORMLOT  VARCHAR(50),  @VB1_LOCALIZ  VARCHAR(50),  @VB1_OPERPAD  VARCHAR(50),  @VB1_CONTRAT  VARCHAR(50),  @VB1_DESC_P   VARCHAR(50),
        @VB1_FPCOD    VARCHAR(50),  @VB1_DESC_I   VARCHAR(50),  @VB1_VLREFUS  FLOAT,        @VB1_DESC_GI  VARCHAR(50),  @VB1_IMPORT   VARCHAR(50),
        @VB1_ANUENTE  VARCHAR(50),  @VB1_OPC      VARCHAR(80),  @VB1_CODOBS   VARCHAR(50),  @VB1_FABRIC   VARCHAR(50),  @VB1_SITPROD  VARCHAR(50),
        @VB1_MODELO   VARCHAR(50),  @VB1_SETOR    VARCHAR(50),  @VB1_BALANCA  VARCHAR(50),  @VB1_TECLA    VARCHAR(50),  @VB1_PRODPAI  VARCHAR(50),
        @VB1_CODEMB   VARCHAR(50),  @VB1_SOLICIT  VARCHAR(50),  @VB1_GRUPCOM  VARCHAR(50),  @VB1_ALADI    VARCHAR(50),  @VB1_CONTCQP  FLOAT,
        @VB1_REVATU   VARCHAR(50),  @VB1_ESPECIF  VARCHAR(80),  @VB1_NALNCCA  VARCHAR(50),  @VB1_NUMCQPR  FLOAT,        @VB1_NALSH    VARCHAR(50),
        @VB1_MAT_PRI  VARCHAR(50),  @VB1_TIPOCQ   VARCHAR(50),  @VB1_MIDIA    VARCHAR(50),  @VB1_VLR_IPI  FLOAT,        @VB1_QTMIDIA  FLOAT,
        @VB1_PIS      VARCHAR(50),  @VB1_PPIS     FLOAT,        @VB1_COFINS   VARCHAR(50),  @VB1_PCOFINS  FLOAT,        @VB1_CSLL     VARCHAR(50),
        @VB1_PCSLL    FLOAT,        @VB1_REDPIS   FLOAT,        @VB1_CODITE   VARCHAR(50),  @VB1_DATASUB  VARCHAR(50),  @VB1_REDCOF   FLOAT,
        @VB1_ESPECIE  FLOAT,        @VB1_CLASSVE  VARCHAR(50),  @VB1_ENVOBR   VARCHAR(50),  @VB1_FLAGSUG  VARCHAR(50),  @VB1_GRUDES   VARCHAR(50),
        @VB1_ITEMCC   VARCHAR(50),  @VB1_MCUSTD   VARCHAR(50),  @VB1_MTBF     FLOAT,        @VB1_MTTR     FLOAT,        @VB1_REDINSS  FLOAT,
        @VB1_REDIRRF  FLOAT,        @VB1_QTDSER   FLOAT,        @VB1_SERIE    VARCHAR(50),  @VB1_FAIXAS   FLOAT,        @VB1_NROPAG   FLOAT,
        @VB1_ISBN     VARCHAR(50),  @VB1_TITORIG  VARCHAR(50),  @VB1_LINGUA   VARCHAR(50),  @VB1_EDICAO   VARCHAR(50),  @VB1_OBSISBN  VARCHAR(50),
        @VB1_CLVL     VARCHAR(50),  @VB1_ATIVO    VARCHAR(50),  @VB1_PESBRU   FLOAT,        @VB1_TIPCAR   VARCHAR(50),  @VB1_VLR_ICM  FLOAT,
        @VB1_CORPRI   VARCHAR(50),  @VB1_CORSEC   VARCHAR(50),  @VB1_NICONE   VARCHAR(50),  @VB1_ATRIB1   VARCHAR(50),  @VB1_ATRIB2   VARCHAR(50),
        @VB1_ATRIB3   VARCHAR(50),  @VB1_REGSEQ   VARCHAR(50),  @VB1_VLRSELO  FLOAT,        @VB1_CODNOR   VARCHAR(50),  @VB1_UCALSTD  VARCHAR(50),
        @VB1_CPOTENC  VARCHAR(50),  @VB1_POTENCI  FLOAT,        @VB1_REQUIS   VARCHAR(50),  @VB1_QTDACUM  FLOAT,        @VB1_QTDINIC  FLOAT,
        @VB1_CNAE     VARCHAR(50),  @VB1_FRETISS  VARCHAR(50),  @VB1_CALCFET  VARCHAR(50),  @VB1_MSBLQL   VARCHAR(50),  @VB1_AGREGCU  VARCHAR(50),
        @VB1_QUADPRO  VARCHAR(50),  @VB1_EMAX     FLOAT,        @VB1_FRACPER  FLOAT,        @VB1_INT_ICM  FLOAT,        @VB1_SELO     VARCHAR(50),
        @VB1_LOTVEN   FLOAT,        @VB1_OK       VARCHAR(50),  @VB1_USAFEFO  VARCHAR(50),  @VB1_UMOEC    FLOAT,        @VB1_UVLRC    FLOAT,
        @VB1_GCCUSTO  VARCHAR(50),  @VB1_CCCUSTO  VARCHAR(50),  @VB1_CLASSE   VARCHAR(50),  @VB1_PAUTFET  FLOAT,        @VB1_RETOPER  VARCHAR(50),
        @VB1_CRDEST   FLOAT,        @VB1_LITROS   FLOAT,        @VB1_VAMARCM  VARCHAR(6),   @VB1_CLINF    VARCHAR(6),   @VB1_CODLIN   VARCHAR(6),
        --@VB1_VAEANUN  VARCHAR(15),  @VB1_VADUNCX  VARCHAR(15),  @VB1_P_BRT    FLOAT,        @VB1_VAPLLAS  FLOAT,        @VB1_VAPLCAM  FLOAT,
		@VB1_VAEANUN  VARCHAR(15),  @VB1_VADUNCX  VARCHAR(15),  @VB1_VAPLLAS  FLOAT,        @VB1_VAPLCAM  FLOAT,
		@VB1_QTDEMB   FLOAT;

-- VARIAVEIS PARA CONDICAO PAGAMENTO (SE4)
DECLARE @VE4_FILIAL   VARCHAR(15),  @VE4_CODIGO   VARCHAR(15),  @VE4_TIPO     VARCHAR(15),  @VE4_COND     VARCHAR(40),  @VE4_DESCRI   VARCHAR(15),
        @VE4_IPI      VARCHAR(15),  @VE4_DDD      VARCHAR(15),  @VE4_DESCFIN  FLOAT,        @VE4_DIADESC  FLOAT,        @VE4_FORMA    VARCHAR(15),
        @VE4_ACRSFIN  FLOAT,        @VE4_SOLID    VARCHAR(15),  @VE4_PERCOM   FLOAT,        @VE4_SUPER    FLOAT,        @VE4_INFER    FLOAT,
        @VE4_FATOR    FLOAT,        @VE4_JURCART  VARCHAR(15),  @VE4_PLANO    VARCHAR(15),  @VE4_ACRES    VARCHAR(15),  @VE4_MSBLQL   VARCHAR(100),
		@VE4_VAEXMER  VARCHAR(1);

-- VARIAVEIS PARA OPERACAO VENDA (SF4)
DECLARE @VF4_FILIAL   VARCHAR(10),  @VF4_CODIGO   VARCHAR(10),  @VF4_TIPO     VARCHAR(10),  @VF4_ICM      VARCHAR(10),  @VF4_IPI      VARCHAR(10),
        @VF4_CREDICM  VARCHAR(10),  @VF4_CREDIPI  VARCHAR(10),  @VF4_DUPLIC   VARCHAR(10),  @VF4_ESTOQUE  VARCHAR(10),  @VF4_CF       VARCHAR(10),
        @VF4_TEXTO    VARCHAR(20),  @VF4_BASEIPI  FLOAT,        @VF4_PODER3   VARCHAR(10),  @VF4_LFICM    VARCHAR(10),  @VF4_LFIPI    VARCHAR(10),
        @VF4_DESTACA  VARCHAR(10),  @VF4_INCIDE   VARCHAR(10),  @VF4_COMPL    VARCHAR(10),  @VF4_IPIFRET  VARCHAR(10),  @VF4_ISS      VARCHAR(10),
        @VF4_LFISS    VARCHAR(10),  @VF4_NRLIVRO  VARCHAR(10),  @VF4_UPRC     VARCHAR(10),  @VF4_CONSUMO  VARCHAR(10),  @VF4_FORMULA  VARCHAR(10),
        @VF4_AGREG    VARCHAR(10),  @VF4_CIAP     VARCHAR(10),  @VF4_INCSOL   VARCHAR(10),  @VF4_DESPIPI  VARCHAR(10),  @VF4_LIVRO    VARCHAR(64),
        @VF4_ATUTEC   VARCHAR(10),  @VF4_ATUATF   VARCHAR(10),  @VF4_TPIPI    VARCHAR(10),  @VF4_PISCOF   VARCHAR(10),  @VF4_PISCRED  VARCHAR(10),
        @VF4_BASEISS  FLOAT,        @VF4_BSICMST  FLOAT,        @VF4_CREDST   VARCHAR(10),  @VF4_STDESC   VARCHAR(10),  @VF4_DESPICM  VARCHAR(10),
        @VF4_SITTRIB  VARCHAR(10),  @VF4_TESDV    VARCHAR(10),  @VF4_MOVPRJ   VARCHAR(10),  @VF4_IPILICM  VARCHAR(10),  @VF4_ICMSDIF  VARCHAR(10),
        @VF4_TESP3    VARCHAR(10),  @VF4_QTDZERO  VARCHAR(10),  @VF4_SLDNPT   VARCHAR(10),  @VF4_DEVZERO  VARCHAR(10),  @VF4_TIPOPER  VARCHAR(10),
        @VF4_TRFICM   VARCHAR(10),  @VF4_TESENV   VARCHAR(10),  @VF4_REGDSTA  VARCHAR(10),  @VF4_LFICMST  VARCHAR(10),  @VF4_PSCFST   VARCHAR(10),
        @VF4_CRDTRAN  FLOAT,        @VF4_ISSST    VARCHAR(10),  @VF4_CONTSOC  VARCHAR(10),  @VF4_CRPRST   FLOAT,        @VF4_IPIPC    VARCHAR(10),
        @VF4_CRPRELE  FLOAT,        @VF4_CTIPI    VARCHAR(10),  @VF4_CALCFET  VARCHAR(10),  @VF4_OBSICM   VARCHAR(10),  @VF4_OBSSOL   VARCHAR(10),
        @VF4_CFPS     VARCHAR(10),  @VF4_CFEXT    VARCHAR(10),  @VF4_BASEPIS  FLOAT,        @VF4_BASECOF  FLOAT,        @VF4_MSBLQL   VARCHAR(10),
        @VF4_PICMDIF  FLOAT,        @VF4_SELO     VARCHAR(10),  @VF4_FINALID  VARCHAR(260), @VF4_RETISS   VARCHAR(10),  @VF4_TPREG    VARCHAR(10),
        @VF4_AFRMM    VARCHAR(10),  @VF4_CRDPRES  FLOAT,        @VF4_DSPRDIC  VARCHAR(10),  @VF4_AGRCOF   VARCHAR(10),  @VF4_AGRPIS   VARCHAR(10),
        @VF4_CRDEST   VARCHAR(10),  @VF4_COFDSZF  VARCHAR(10),  @VF4_PISBRUT  VARCHAR(10),  @VF4_COFBRUT  VARCHAR(10),  @VF4_PISDSZF  VARCHAR(10),
        @VF4_BCRDPIS  FLOAT,        @VF4_BCRDCOF  FLOAT,        @VF4_TRANFIL  VARCHAR(10),  @VF4_OPEMOV   VARCHAR(10),  @VF4_FRETAUT  VARCHAR(10),
        @VF4_MKPCMP   VARCHAR(10),  @VF4_ICMSST   VARCHAR(10),  @VF4_BENSATF  VARCHAR(10),  @VF4_AGRRETC  VARCHAR(10),  @VF4_TESE3    VARCHAR(10),
        @VF4_IPIOBS   VARCHAR(10),  @VF4_MKPSOL   VARCHAR(10),  @VF4_MARGEM   VARCHAR(20);

-- VARIAVEIS PARA LISTAS DE PRECOS (DA0 e DA1)
DECLARE @VDA0_CODTAB  VARCHAR(3),   @VDA0_DESCRI  VARCHAR(30),  @VDA0_DATDE   VARCHAR(8),   @VDA0_HORADE  VARCHAR(5),   @VDA0_DATATE  VARCHAR(8),
        @VDA0_HORATE  VARCHAR(5),   @VDA0_CONDPG  VARCHAR(3),   @VDA0_TPHORA  VARCHAR(1),   @VDA0_ATIVO   VARCHAR(1),   @VDA0_FILIAL  VARCHAR(2),
        @VDA0_VAUF    VARCHAR(50),  @VDA0_VAESDI  VARCHAR(10),  @VDA1_FILIAL  VARCHAR(2),   @VDA1_ITEM    VARCHAR(4),   @VDA1_CODTAB  VARCHAR(3),
        @VDA1_CODPRO  VARCHAR(15),  @VDA1_GRUPO   VARCHAR(4),   @VDA1_REFGRD  VARCHAR(14),  @VDA1_PRCVEN  FLOAT,        @VDA1_VLRDES  FLOAT,
        @VDA1_PERDES  FLOAT,        @VDA1_ATIVO   VARCHAR(1),   @VDA1_FRETE   FLOAT,        @VDA1_ESTADO  VARCHAR(2),   @VDA1_TPOPER  VARCHAR(1),
        @VDA1_QTDLOT  FLOAT,        @VDA1_INDLOT  VARCHAR(20),  @VDA1_MOEDA   FLOAT,        @VDA1_DATVIG  VARCHAR(8),   @VDA0_PERMAX  FLOAT,
		@VDA0_PERMIN  FLOAT;

-- VARIAVEIS PARA CIDADES (CC2)
DECLARE @VCC2_FILIAL  VARCHAR(2),   @VCC2_EST     VARCHAR(2),   @VCC2_CODMUN  VARCHAR(5),   @VCC2_MUN     VARCHAR(60);

-- VARIAVEIS PARA ESTADOS, RAMOS DE ATIVIDADE II E PROMOTORES (SX5)
DECLARE @VX5_FILIAL   VARCHAR(20),  @VX5_TABELA   VARCHAR(20),  @VX5_CHAVE    VARCHAR(20),  @VX5_DESCRI   VARCHAR(55),  @VX5_DESCSPA  VARCHAR(55),
        @VX5_DESCENG  VARCHAR(55),  @VZX5_46COD   VARCHAR(40),  @VZX5_46DESC  VARCHAR(40);

-- VARIAVEIS PARA PAISES (ZYA)
DECLARE @VYA_FILIAL   VARCHAR(2),   @VYA_CODGI    VARCHAR(3),   @VYA_DESCR    VARCHAR(25),  @VYA_SIGLA    VARCHAR(3),   @VYA_IDIOMA   VARCHAR(25),
        @VYA_NOIDIOM  VARCHAR(25),  @VYA_DINALAD  VARCHAR(4),   @VYA_NALADI   VARCHAR(1),   @VYA_ALADI    VARCHAR(1),   @VYA_COMUM    VARCHAR(1),
        @VYA_MERCOSU  VARCHAR(1),   @VYA_SGPC     VARCHAR(1),   @VYA_LI       VARCHAR(1),   @VYA_PAIS_I   VARCHAR(25),  @VYA_ABICS    VARCHAR(3),
        @VYA_SISEXP   VARCHAR(4),   @VYA_CODRIEX  VARCHAR(25),  @VYA_CODFIES  VARCHAR(3),   @VYA_SGLMEX   VARCHAR(2),   @VYA_NASCIO   VARCHAR(40),
        @VYA_CODERP   VARCHAR(3);

-- VARIAVEIS PARA RAMOS DE ATIVIDADE I, TIPOS E GRUPOS DE PRODUTOS (ZX5)
DECLARE @VZX5_FILIAL  VARCHAR(20),  @VZX5_TABELA  VARCHAR(20),  @VZX5_CHAVE   VARCHAR(20),  @VZX5_DESCRI  VARCHAR(55),  @VZX5_18COD   VARCHAR(20),
        @VZX5_18DESC  VARCHAR(255), @VZX5_39COD   VARCHAR(20),  @VZX5_39DESC  VARCHAR(255), @VZX5_40COD   VARCHAR(20),  @VZX5_40DESC  VARCHAR(255);

-- VARIAVEIS PARA PORTADORES (SA6)
DECLARE @VA6_COD      VARCHAR(3),   @VA6_AGENCIA  VARCHAR(5),   @VA6_DVAGE    VARCHAR(1),   @VA6_NUMCON   VARCHAR(10),  @VA6_DVCTA    VARCHAR(1),
        @VA6_NOME     VARCHAR(40),  @VA6_FILIAL   VARCHAR(6);

-- VARIAVEIS PARA TRANSPORTADORES (SA4)
DECLARE @VA4_FILIAL   VARCHAR(40),  @VA4_COD      VARCHAR(40),  @VA4_NOME     VARCHAR(40),  @VA4_NREDUZ   VARCHAR(40),  @VA4_VIA      VARCHAR(40),
        @VA4_END      VARCHAR(40),  @VA4_MUN      VARCHAR(40),  @VA4_CEP      VARCHAR(40),  @VA4_EST      VARCHAR(40),  @VA4_CGC      VARCHAR(40),
        @VA4_TEL      VARCHAR(40),  @VA4_TELEX    VARCHAR(40),  @VA4_CONTATO  VARCHAR(40),  @VA4_INSEST   VARCHAR(40),  @VA4_EMAIL    VARCHAR(40),
        @VA4_HPAGE    VARCHAR(40),  @VA4_BAIRRO   VARCHAR(40),  @VA4_DDI      VARCHAR(40),  @VA4_DDD      VARCHAR(40),  @VA4_ENDPAD   VARCHAR(40),
        @VA4_ESTFIS   VARCHAR(40),  @VA4_LOCAL    VARCHAR(40);

-- VARIAVEIS PARA MARCAS (ZAZ)
DECLARE @VZAZ_FILIAL  VARCHAR(2),   @VZAZ_CLINF   VARCHAR(6),   @VZAZ_NLINF   VARCHAR(30);

-- VARIAVEIS PARA FAMILIAS (SBM)
DECLARE @VBM_FILIAL   VARCHAR(2),   @VBM_GRUPO    VARCHAR(4),   @VBM_DESC     VARCHAR(30),  @VBM_PICPAD   VARCHAR(30),  @VBM_PROORI   VARCHAR(1),
        @VBM_CODMAR   VARCHAR(3),   @VBM_STATUS   VARCHAR(1),   @VBM_GRUREL   VARCHAR(40),  @VBM_TIPGRU   VARCHAR(2),   @VBM_MARKUP   FLOAT,
        @VBM_PRECO    VARCHAR(3),   @VBM_LENREL   FLOAT,        @VBM_TIPMOV   VARCHAR(1),   @VBM_CLASGRU  VARCHAR(1),   @VBM_FORMUL   VARCHAR(6);

-- VARIAVEIS PARA PEDIDOS (SC5 E SC6)
DECLARE @VC5_FILIAL   VARCHAR(2),   @VC5_NUM      VARCHAR(6),   @VC5_TIPO     VARCHAR(1),   @VC5_CLIENTE  VARCHAR(6),   @VC5_LOJACLI  VARCHAR(2),
        @VC5_CLIENT   VARCHAR(6),   @VC5_LOJAENT  VARCHAR(2),   @VC5_TRANSP   VARCHAR(6),   @VC5_TIPOCLI  VARCHAR(1),   @VC5_CONDPAG  VARCHAR(3),
        @VC5_TABELA   VARCHAR(3),   @VC5_VEND1    VARCHAR(6),   @VC5_COMIS1   FLOAT,        @VC5_VEND2    VARCHAR(6),   @VC5_COMIS2   FLOAT,
        @VC5_VEND3    VARCHAR(6),   @VC5_COMIS3   FLOAT,        @VC5_VEND4    VARCHAR(6),   @VC5_COMIS4   FLOAT,        @VC5_VEND5    VARCHAR(6),
        @VC5_COMIS5   FLOAT,        @VC5_DESC1    FLOAT,        @VC5_DESC2    FLOAT,        @VC5_DESC3    FLOAT,        @VC5_DESC4    FLOAT,
        @VC5_BANCO    VARCHAR(3),   @VC5_DESCFI   FLOAT,        @VC5_EMISSAO  VARCHAR(8),   @VC5_COTACAO  VARCHAR(6),   @VC5_PARC1    FLOAT,
        @VC5_DATA1    VARCHAR(8),   @VC5_PARC2    FLOAT,        @VC5_DATA2    VARCHAR(8),   @VC5_PARC3    FLOAT,        @VC5_DATA3    VARCHAR(8),
        @VC5_PARC4    FLOAT,        @VC5_DATA4    VARCHAR(8),   @VC5_TPFRETE  VARCHAR(1),   @VC5_FRETE    FLOAT,        @VC5_DESPESA  FLOAT,
        @VC5_FRETAUT  FLOAT,        @VC5_REAJUST  VARCHAR(3),   @VC5_MOEDA    FLOAT,        @VC5_SEGURO   FLOAT,        @VC5_PESOL    FLOAT,
        @VC5_PBRUTO   FLOAT,        @VC5_REIMP    FLOAT,        @VC5_REDESP   VARCHAR(6),   @VC5_VOLUME1  FLOAT,        @VC5_VOLUME2  FLOAT,
        @VC5_VOLUME3  FLOAT,        @VC5_VOLUME4  FLOAT,        @VC5_ESPECI1  VARCHAR(10),  @VC5_ESPECI2  VARCHAR(10),  @VC5_ESPECI3  VARCHAR(10),
        @VC5_ESPECI4  VARCHAR(10),  @VC5_ACRSFIN  FLOAT,        @VC5_INCISS   VARCHAR(1),   @VC5_LIBEROK  VARCHAR(1),   @VC5_OK       VARCHAR(2),
        @VC5_NOTA     VARCHAR(9),   @VC5_MENNOTA  VARCHAR(120), @VC5_MENPAD   VARCHAR(3),   @VC5_OS       VARCHAR(6),   @VC5_SERIE    VARCHAR(3),
        @VC5_KITREP   VARCHAR(6),   @VC5_TIPLIB   VARCHAR(1),   @VC5_TXMOEDA  FLOAT,        @VC5_DESCONT  FLOAT,        @VC5_PEDEXP   VARCHAR(20),
        @VC5_TPCARGA  VARCHAR(1),   @VC5_PDESCAB  FLOAT,        @VC5_BLQ      VARCHAR(1),   @VC5_FORNISS  VARCHAR(6),   @VC5_CONTRA   VARCHAR(10),
        @VC5_VLR_FRT  FLOAT,        @VC5_VAPDMER  VARCHAR(20);

DECLARE @VC6_FILIAL   VARCHAR(2),   @VC6_ITEM     VARCHAR(2),   @VC6_PRODUTO  VARCHAR(15),  @VC6_DESCRI   VARCHAR(40),  @VC6_UM      VARCHAR(2),
        @VC6_QTDVEN   FLOAT,        @VC6_PRCVEN   FLOAT,        @VC6_VALOR    FLOAT,        @VC6_PEDCLI   VARCHAR(9),   @VC6_SEGUM   VARCHAR(2),
        @VC6_QTDLIB   FLOAT,        @VC6_UNSVEN   FLOAT,        @VC6_QTDLIB2  FLOAT,        @VC6_TES      VARCHAR(3),   @VC6_QTDENT  FLOAT,
        @VC6_QTDENT2  FLOAT,        @VC6_LOCAL    VARCHAR(2),   @VC6_CF       VARCHAR(5),   @VC6_CLI      VARCHAR(6),   @VC6_ENTREG  VARCHAR(8),
        @VC6_LA       VARCHAR(8),   @VC6_DESCONT  FLOAT,        @VC6_VALDESC  FLOAT,        @VC6_LOJA     VARCHAR(2),   @VC6_DATFAT  VARCHAR(8),
        @VC6_NOTA     VARCHAR(9),   @VC6_SERIE    VARCHAR(3),   @VC6_NUM      VARCHAR(6),   @VC6_COMIS1   FLOAT,        @VC6_COMIS2  FLOAT,
        @VC6_COMIS3   FLOAT,        @VC6_COMIS4   FLOAT,        @VC6_COMIS5   FLOAT,        @VC6_PRUNIT   FLOAT,        @VC6_BLOQUEI VARCHAR(2),
        @VC6_RESERVA  VARCHAR(6),   @VC6_OP       VARCHAR(2),   @VC6_OK       VARCHAR(2),   @VC6_NFORI    VARCHAR(9),   @VC6_SERIORI VARCHAR(3),
        @VC6_ITEMORI  VARCHAR(4),   @VC6_IPIDEV   FLOAT,        @VC6_IDENTB6  VARCHAR(6),   @VC6_BLQ      VARCHAR(2),   @VC6_PICMRET FLOAT,
        @VC6_CODISS   VARCHAR(9),   @VC6_GRADE    VARCHAR(1),   @VC6_ITEMGRD  VARCHAR(3),   @VC6_LOTECTL  VARCHAR(10),  @VC6_NUMLOTE VARCHAR(6),
        @VC6_DTVALID  VARCHAR(8),   @VC6_NUMORC   VARCHAR(8),   @VC6_CHASSI   VARCHAR(17),  @VC6_OPC      VARCHAR(80),  @VC6_LOCALIZ VARCHAR(15),
        @VC6_NUMSERI  VARCHAR(20),  @VC6_NUMOP    VARCHAR(6),   @VC6_ITEMOP   VARCHAR(2),   @VC6_CLASFIS  VARCHAR(3),   @VC6_QTDRESE FLOAT,
        @VC6_CONTRAT  VARCHAR(6),   @VC6_NUMOS    VARCHAR(10),  @VC6_NUMOSFA  VARCHAR(10),  @VC6_CODFAB   VARCHAR(6),   @VC6_LOJAFA  VARCHAR(2),
        @VC6_ITEMCON  VARCHAR(2),   @VC6_TPOP     VARCHAR(1),   @VC6_REVISAO  VARCHAR(3),   @VC6_SERVIC   VARCHAR(3),   @VC6_ENDPAD  VARCHAR(15),
        @VC6_TPCONTR  VARCHAR(1),   @VC6_ITCONTR  VARCHAR(2),   @VC6_GEROUPV  VARCHAR(1),   @VC6_PROJPMS  VARCHAR(10),  @VC6_EDTPMS  VARCHAR(12),
        @VC6_TASKPMS  VARCHAR(12),  @VC6_TRT      VARCHAR(3),   @VC6_QTDEMP   FLOAT,        @VC6_QTDEMP2  FLOAT,        @VC6_PROJET  VARCHAR(6),
        @VC6_ITPROJ   VARCHAR(2),   @VC6_POTENCI  FLOAT,        @VC6_LICITA   VARCHAR(6),   @VC6_REGWMS   VARCHAR(1),   @VC6_NUMCP   VARCHAR(6),
        @VC6_NUMSC    VARCHAR(6),   @VC6_ITEMSC   VARCHAR(4),   @VC6_SUGENTR  VARCHAR(8),   @VC6_ITEMED   VARCHAR(3),   @VC6_ABSCINS FLOAT,
        @VC6_ABATISS  FLOAT,        @VC6_ABATMAT  FLOAT,        @VC6_FUNRURA  FLOAT,        @VC6_FETAB    FLOAT,        @VC6_CODROM  VARCHAR(6),
        @VC6_PEDCOM   VARCHAR(6),   @VC6_ITPC     VARCHAR(4),   @VC6_FILPED   VARCHAR(2),   @VC6_TPDEDUZ  VARCHAR(1),   @VC6_MOTDED  VARCHAR(1),
        @VC6_FORDED   VARCHAR(6),   @VC6_LOJDED   VARCHAR(2),   @VC6_SERDED   VARCHAR(3),   @VC6_NFDED    VARCHAR(9),   @VC6_VLNFD   FLOAT,
        @VC6_PCDED    FLOAT,        @VC6_VLDED    FLOAT,        @VC6_ABATINS  FLOAT,        @VC6_CODLAN   VARCHAR(6);

-- VARIAVEIS PARA NOTAS FISCAIS VENDA (SF2 E SD2)
DECLARE @VF2_FILIAL   VARCHAR(20),  @VF2_DOC      VARCHAR(9),   @VF2_SERIE    VARCHAR(3),   @VF2_CLIENTE  VARCHAR(6),   @VF2_LOJA    VARCHAR(2),
        @VF2_COND     VARCHAR(3),   @VF2_DUPL     VARCHAR(9),   @VF2_EMISSAO  VARCHAR(8),   @VF2_EST      VARCHAR(2),   @VF2_FRETE   FLOAT,
        @VF2_SEGURO   FLOAT,        @VF2_ICMFRET  FLOAT,        @VF2_TIPOCLI  VARCHAR(1),   @VF2_VALBRUT  FLOAT,        @VF2_VALINSS FLOAT,
        @VF2_VALICM   FLOAT,        @VF2_BASEICM  FLOAT,        @VF2_VALIPI   FLOAT,        @VF2_BASEIPI  FLOAT,        @VF2_VALMERC FLOAT,
        @VF2_NFORI    VARCHAR(9),   @VF2_DESCONT  FLOAT,        @VF2_SERIORI  VARCHAR(3),   @VF2_TIPO     VARCHAR(1),   @VF2_ESPECI1 VARCHAR(10),
        @VF2_ESPECI2  VARCHAR(10),  @VF2_ESPECI3  VARCHAR(10),  @VF2_ESPECI4  VARCHAR(10),  @VF2_VOLUME1  FLOAT,        @VF2_VOLUME2 FLOAT,
        @VF2_VOLUME3  FLOAT,        @VF2_VOLUME4  FLOAT,        @VF2_ICMSRET  FLOAT,        @VF2_PLIQUI   FLOAT,        @VF2_PBRUTO  FLOAT,
        @VF2_TRANSP   VARCHAR(6),   @VF2_REDESP   VARCHAR(6),   @VF2_VEND1    VARCHAR(6),   @VF2_VEND2    VARCHAR(6),   @VF2_VEND3   VARCHAR(6),
        @VF2_VEND4    VARCHAR(6),   @VF2_VEND5    VARCHAR(6),   @VF2_OK       VARCHAR(4),   @VF2_FIMP     VARCHAR(1),   @VF2_DTLANC  VARCHAR(8),
        @VF2_DTREAJ   VARCHAR(8),   @VF2_REAJUST  VARCHAR(3),   @VF2_DTBASE0  VARCHAR(8),   @VF2_FATORB0  FLOAT,        @VF2_DTBASE1 VARCHAR(8),
        @VF2_FATORB1  FLOAT,        @VF2_VARIAC   FLOAT,        @VF2_BASEISS  FLOAT,        @VF2_VALISS   FLOAT,        @VF2_VALFAT  FLOAT,
        @VF2_CONTSOC  FLOAT,        @VF2_BRICMS   FLOAT,        @VF2_FRETAUT  FLOAT,        @VF2_ICMAUTO  FLOAT,        @VF2_DESPESA FLOAT,
        @VF2_NEXTDOC  VARCHAR(9),   @VF2_ESPECIE  VARCHAR(5),   @VF2_PDV      VARCHAR(10),  @VF2_MAPA     VARCHAR(10),  @VF2_ECF     VARCHAR(1),
        @VF2_BASIMP1  FLOAT,        @VF2_PREFIXO  VARCHAR(3),   @VF2_BASIMP2  FLOAT,        @VF2_BASIMP3  FLOAT,        @VF2_BASIMP4 FLOAT,
        @VF2_BASIMP5  FLOAT,        @VF2_BASIMP6  FLOAT,        @VF2_VALIMP1  FLOAT,        @VF2_VALIMP2  FLOAT,        @VF2_VALIMP3 FLOAT,
        @VF2_VALIMP4  FLOAT,        @VF2_VALIMP5  FLOAT,        @VF2_VALIMP6  FLOAT,        @VF2_ORDPAGO  VARCHAR(6),   @VF2_NFCUPOM VARCHAR(9),
        @VF2_HORA     VARCHAR(5),   @VF2_BASEINS  FLOAT,        @VF2_LOTE     VARCHAR(20),  @VF2_MOEDA    FLOAT,        @VF2_REGIAO  VARCHAR(20),
        @VF2_TXMOEDA  FLOAT,        @VF2_VALCOFI  FLOAT,        @VF2_VALCSLL  FLOAT,        @VF2_VALPIS   FLOAT,        @VF2_VALIRRF FLOAT,
        @VF2_CARGA    VARCHAR(20),  @VF2_SEQCAR   VARCHAR(20),  @VF2_NEXTSER  VARCHAR(20),  @VF2_PEDPEND  VARCHAR(20),  @VF2_DESCCAB FLOAT,
        @VF2_DTENTR   VARCHAR(20),  @VF2_FORMUL   VARCHAR(20),  @VF2_TIPODOC  VARCHAR(20),  @VF2_NFEACRS  VARCHAR(20),  @VF2_TIPOREM VARCHAR(20),
        @VF2_SEQENT   VARCHAR(20),  @VF2_VEICUL1  VARCHAR(20),  @VF2_VEICUL2  VARCHAR(20),  @VF2_VEICUL3  VARCHAR(20),  @VF2_ICMSDIF FLOAT,
        @VF2_BASEPS3  FLOAT,        @VF2_VALPS3   FLOAT,        @VF2_BASECF3  FLOAT,        @VF2_VALCF3   FLOAT,        @VF2_NFELETR VARCHAR(20),
        @VF2_EMINFE   VARCHAR(20),  @VF2_HORNFE   VARCHAR(20),  @VF2_CODNFE   VARCHAR(24),  @VF2_CREDNFE  FLOAT,        @VF2_VALACRS FLOAT,
        @VF2_RECISS   VARCHAR(20),  @VF2_TIPORET  VARCHAR(20),  @VF2_HAWB     VARCHAR(20),  @VF2_VLR_FRT  FLOAT,        @VF2_DTDIGIT VARCHAR(20);

DECLARE @VD2_FILIAL   VARCHAR(2),   @VD2_COD      VARCHAR(15),  @VD2_UM       VARCHAR(2),   @VD2_SEGUM    VARCHAR(2),   @VD2_QUANT   FLOAT,
        @VD2_PRCVEN   FLOAT,        @VD2_TOTAL    FLOAT,        @VD2_VALIPI   FLOAT,        @VD2_VALICM   FLOAT,        @VD2_TES     VARCHAR(3),
        @VD2_CF       VARCHAR(5),   @VD2_DESC     FLOAT,        @VD2_IPI      FLOAT,        @VD2_PICM     FLOAT,        @VD2_PESO    FLOAT,
        @VD2_CONTA    VARCHAR(20),  @VD2_PEDIDO   VARCHAR(6),   @VD2_ITEMPV   VARCHAR(2),   @VD2_CLIENTE  VARCHAR(6),   @VD2_LOJA    VARCHAR(2),
        @VD2_LOCAL    VARCHAR(2),   @VD2_DOC      VARCHAR(9),   @VD2_EMISSAO  VARCHAR(8),   @VD2_GRUPO    VARCHAR(4),   @VD2_TP      VARCHAR(2),
        @VD2_SERIE    VARCHAR(3),   @VD2_CUSTO1   FLOAT,        @VD2_CUSTO2   FLOAT,        @VD2_CUSTO3   FLOAT,        @VD2_CUSTO4  FLOAT,
        @VD2_CUSTO5   FLOAT,        @VD2_PRUNIT   FLOAT,        @VD2_QTSEGUM  FLOAT,        @VD2_NUMSEQ   VARCHAR(6),   @VD2_EST     VARCHAR(2),
        @VD2_DESCON   FLOAT,        @VD2_TIPO     VARCHAR(1),   @VD2_NFORI    VARCHAR(9),   @VD2_SERIORI  VARCHAR(3),   @VD2_QTDEDEV FLOAT,
        @VD2_VALDEV   FLOAT,        @VD2_ORIGLAN  VARCHAR(2),   @VD2_BRICMS   FLOAT,        @VD2_BASEORI  FLOAT,        @VD2_BASEICM FLOAT,
        @VD2_VALACRS  FLOAT,        @VD2_IDENTB6  VARCHAR(6),   @VD2_ITEM     VARCHAR(9),   @VD2_CODISS   VARCHAR(9),   @VD2_GRADE   VARCHAR(1),
        @VD2_SEQCALC  VARCHAR(14),  @VD2_ICMSRET  FLOAT,        @VD2_COMIS1   FLOAT,        @VD2_COMIS2   FLOAT,        @VD2_COMIS3  FLOAT,
        @VD2_COMIS4   FLOAT,        @VD2_COMIS5   FLOAT,        @VD2_LOTECTL  VARCHAR(10),  @VD2_NUMLOTE  VARCHAR(6),   @VD2_DTVALID VARCHAR(8),
        @VD2_DESCZFR  FLOAT,        @VD2_PDV      VARCHAR(10),  @VD2_NUMSERI  VARCHAR(20),  @VD2_DTLCTCT  VARCHAR(8),   @VD2_CUSFF1  FLOAT,
        @VD2_CUSFF2   FLOAT,        @VD2_CUSFF3   FLOAT,        @VD2_CUSFF4   FLOAT,        @VD2_CUSFF5   FLOAT,        @VD2_CLASFIS VARCHAR(3),
        @VD2_BASIMP1  FLOAT,        @VD2_BASIMP2  FLOAT,        @VD2_BASIMP3  FLOAT,        @VD2_BASIMP4  FLOAT,        @VD2_BASIMP5 FLOAT,
        @VD2_BASIMP6  FLOAT,        @VD2_VALIMP1  FLOAT,        @VD2_VALIMP2  FLOAT,        @VD2_VALIMP3  FLOAT,        @VD2_VALIMP4 FLOAT,
        @VD2_VALIMP5  FLOAT,        @VD2_VALIMP6  FLOAT,        @VD2_ITEMORI  VARCHAR(4),   @VD2_CODFAB   VARCHAR(6),   @VD2_LOJAFA  VARCHAR(2),
        @VD2_ALIQINS  FLOAT,        @VD2_ALIQISS  FLOAT,        @VD2_BASEINS  FLOAT,        @VD2_BASEIPI  FLOAT,        @VD2_BASEISS FLOAT,
        @VD2_CCUSTO   VARCHAR(50),  @VD2_DESPESA  FLOAT,        @VD2_ENVCNAB  VARCHAR(50),  @VD2_ITEMCC   VARCHAR(50),  @VD2_LOCALIZ VARCHAR(50),
        @VD2_PREEMB   VARCHAR(50),  @VD2_SEGURO   FLOAT,        @VD2_VALFRE   FLOAT,        @VD2_VALINS   FLOAT,        @VD2_VALISS  FLOAT,
        @VD2_CLVL     VARCHAR(50),  @VD2_ICMFRET  FLOAT,        @VD2_SERVIC   VARCHAR(50),  @VD2_STSERV   VARCHAR(50),  @VD2_PROJPMS VARCHAR(50),
        @VD2_TASKPMS  VARCHAR(50),  @VD2_LICITA   VARCHAR(50),  @VD2_REMITO   VARCHAR(50),  @VD2_SERIREM  VARCHAR(50),  @VD2_ITEMREM VARCHAR(50),
        @VD2_ALQIMP1  FLOAT,        @VD2_ALQIMP2  FLOAT,        @VD2_ALQIMP3  FLOAT,        @VD2_ALQIMP4  FLOAT,        @VD2_ALQIMP5 FLOAT,
        @VD2_ALQIMP6  FLOAT,        @VD2_TPDCENV  VARCHAR(50),  @VD2_OK       VARCHAR(50),  @VD2_EDTPMS   VARCHAR(50),  @VD2_VARPRUN FLOAT,
        @VD2_FORMUL   VARCHAR(50),  @VD2_TIPODOC  VARCHAR(50),  @VD2_VAC      FLOAT,        @VD2_TIPOREM  VARCHAR(50),  @VD2_QTDEFAT FLOAT,
        @VD2_QTDAFAT  FLOAT,        @VD2_SEQUEN   VARCHAR(50),  @VD2_POTENCI  FLOAT,        @VD2_DESCICM  FLOAT,        @VD2_BASEPS3 FLOAT,
        @VD2_ALIQPS3  FLOAT,        @VD2_VALPS3   FLOAT,        @VD2_BASECF3  FLOAT,        @VD2_ALIQCF3  FLOAT,        @VD2_VALCF3  FLOAT,
        @VD2_OP       VARCHAR(50),  @VD2_TPESTR   VARCHAR(50),  @VD2_VALBRUT  FLOAT,        @VD2_REGWMS   VARCHAR(50),  @VD2_DTDIGIT VARCHAR(50),
        @VD2_NUMCP    VARCHAR(50),  @VD2_CFPS     VARCHAR(50);

-- VARIAVEIS PARA NOTAS FISCAIS DEVOLUCAO (SF1 E SD1)
DECLARE @VF1_FILIAL   VARCHAR(2),   @VF1_DOC      VARCHAR(9),   @VF1_SERIE    VARCHAR(3),   @VF1_FORNECE  VARCHAR(6),   @VF1_LOJA    VARCHAR(2),
        @VF1_COND     VARCHAR(3),   @VF1_DUPL     VARCHAR(9),   @VF1_EMISSAO  VARCHAR(8),   @VF1_EST      VARCHAR(2),   @VF1_FRETE   FLOAT,
        @VF1_DESPESA  FLOAT,        @VF1_BASEICM  FLOAT,        @VF1_VALICM   FLOAT,        @VF1_BASEIPI  FLOAT,        @VF1_VALIPI  FLOAT,
        @VF1_VALMERC  FLOAT,        @VF1_VALBRUT  FLOAT,        @VF1_TIPO     VARCHAR(1),   @VF1_DESCONT  FLOAT,        @VF1_DTDIGIT VARCHAR(8),
        @VF1_CPROVA   VARCHAR(14),  @VF1_BRICMS   FLOAT,        @VF1_ICMSRET  FLOAT,        @VF1_BASEFD   FLOAT,        @VF1_DTLANC  VARCHAR(8),
        @VF1_OK       VARCHAR(2),   @VF1_ORIGLAN  VARCHAR(2),   @VF1_TX       VARCHAR(1),   @VF1_CONTSOC  FLOAT,        @VF1_IRRF    FLOAT,
        @VF1_FORMUL   VARCHAR(1),   @VF1_NFORIG   VARCHAR(9),   @VF1_SERORIG  VARCHAR(3),   @VF1_ESPECIE  VARCHAR(5),   @VF1_IMPORT  VARCHAR(1),
        @VF1_II       FLOAT,        @VF1_REMITO   VARCHAR(6),   @VF1_BASIMP2  FLOAT,        @VF1_BASIMP3  FLOAT,        @VF1_BASIMP4 FLOAT,
        @VF1_BASIMP5  FLOAT,        @VF1_BASIMP6  FLOAT,        @VF1_VALIMP1  FLOAT,        @VF1_VALIMP2  FLOAT,        @VF1_VALIMP3 FLOAT,
        @VF1_VALIMP4  FLOAT,        @VF1_VALIMP5  FLOAT,        @VF1_VALIMP6  FLOAT,        @VF1_ORDPAGO  VARCHAR(6),   @VF1_HORA    VARCHAR(5),
        @VF1_INSS     FLOAT,        @VF1_ISS      FLOAT,        @VF1_BASIMP1  FLOAT,        @VF1_HAWB     VARCHAR(17),  @VF1_TIPO_NF VARCHAR(1),
        @VF1_IPI      FLOAT,        @VF1_ICMS     FLOAT,        @VF1_PESOL    FLOAT,        @VF1_FOB_R    FLOAT,        @VF1_SEGURO  FLOAT,
        @VF1_CIF      FLOAT,        @VF1_MOEDA    FLOAT,        @VF1_PREFIXO  VARCHAR(3),   @VF1_STATUS   VARCHAR(1),   @VF1_VALEMB  FLOAT,
        @VF1_RECBMTO  VARCHAR(8),   @VF1_APROV    VARCHAR(6),   @VF1_CTR_NFC  VARCHAR(9),   @VF1_TXMOEDA  FLOAT,        @VF1_PEDVEND VARCHAR(6),
        @VF1_TIPODOC  VARCHAR(2),   @VF1_TIPOREM  VARCHAR(1),   @VF1_GNR      VARCHAR(6),   @VF1_VALPIS   FLOAT,        @VF1_VALCOFI FLOAT,
        @VF1_VALCSLL  FLOAT,        @VF1_BASEPS3  FLOAT,        @VF1_VALPS3   FLOAT,        @VF1_BASECF3  FLOAT,        @VF1_VALCF3  FLOAT,
        @VF1_NFELETR  VARCHAR(9),   @VF1_EMINFE   VARCHAR(8),   @VF1_HORNFE   VARCHAR(8),   @VF1_CODNFE   VARCHAR(24),  @VF1_CREDNFE FLOAT,
        @VF1_VNAGREG  FLOAT,        @VF1_NUMRPS   VARCHAR(12),  @VF1_VALIRF   FLOAT,        @VF1_NUMMOV   VARCHAR(2),   @VF1_RECISS  VARCHAR(1),
        @VF1_FILORIG  VARCHAR(2),   @VF1_NUMRA    VARCHAR(6),   @VF1_BASEINS  FLOAT,        @VF1_DOCFOL   VARCHAR(6),   @VF1_VERBAFO VARCHAR(3),
        @VF1_VALFDS   FLOAT,        @VF1_CHVNFE   VARCHAR(44),  @VF1_ESTCRED  FLOAT,        @VF1_FIMP     VARCHAR(10),  @VF1_TPFRETE VARCHAR(1),
        @VF1_TPNFEXP  VARCHAR(1),   @VF1_NODIA    VARCHAR(10),  @VF1_DIACTB   VARCHAR(2),   @VF1_TRANSP   VARCHAR(6),   @VF1_PLIQUI  FLOAT,
        @VF1_PBRUTO   FLOAT,        @VF1_ESPECI1  VARCHAR(10),  @VF1_VOLUME1  FLOAT,        @VF1_ESPECI2  VARCHAR(10),  @VF1_VOLUME2 FLOAT,
        @VF1_ESPECI3  VARCHAR(10),  @VF1_VOLUME3  FLOAT,        @VF1_ESPECI4  VARCHAR(10),  @VF1_VOLUME4  FLOAT,        @VF1_VALFAB  FLOAT,
        @VF1_VALFAC   FLOAT,        @VF1_VALFET   FLOAT,        @VF1_PLACA    VARCHAR(8);

DECLARE @VD1_FILIAL   VARCHAR(2),   @VD1_ITEM     VARCHAR(4),   @VD1_COD      VARCHAR(15),  @VD1_UM       VARCHAR(2),   @VD1_QUANT   FLOAT,
        @VD1_VUNIT    FLOAT,        @VD1_TOTAL    FLOAT,        @VD1_LOCAL    VARCHAR(2),   @VD1_SEGUM    VARCHAR(2),   @VD1_VALIPI  FLOAT,
        @VD1_VALICM   FLOAT,        @VD1_TES      VARCHAR(3),   @VD1_NFORI    VARCHAR(9),   @VD1_CONTA    VARCHAR(20),  @VD1_ITEMCTA VARCHAR(9),
        @VD1_CC       VARCHAR(9),   @VD1_CLVL     VARCHAR(9),   @VD1_CF       VARCHAR(5),   @VD1_DESC     FLOAT,        @VD1_FORNECE VARCHAR(6),
        @VD1_LOJA     VARCHAR(2),   @VD1_IPI      FLOAT,        @VD1_DOC      VARCHAR(9),   @VD1_EMISSAO  VARCHAR(8),   @VD1_DTDIGIT VARCHAR(8),
        @VD1_PICM     FLOAT,        @VD1_PESO     FLOAT,        @VD1_SERIE    VARCHAR(3),   @VD1_OP       VARCHAR(13),  @VD1_PEDIDO  VARCHAR(6),
        @VD1_ITEMPC   VARCHAR(4),   @VD1_GRUPO    VARCHAR(4),   @VD1_TIPO     VARCHAR(1),   @VD1_CUSTO2   FLOAT,        @VD1_NUMSEQ  VARCHAR(6),
        @VD1_CUSTO3   FLOAT,        @VD1_CUSTO4   FLOAT,        @VD1_CUSTO5   FLOAT,        @VD1_ITEMORI  VARCHAR(4),   @VD1_TP      VARCHAR(2),
        @VD1_QTSEGUM  FLOAT,        @VD1_ORIGLAN  VARCHAR(2),   @VD1_DATACUS  VARCHAR(8),   @VD1_SERIORI  VARCHAR(3),   @VD1_NUMCQ   VARCHAR(6),
        @VD1_QTDEDEV  FLOAT,        @VD1_VALDEV   FLOAT,        @VD1_ICMSRET  FLOAT,        @VD1_IDENTB6  VARCHAR(6),   @VD1_BRICMS  FLOAT,
        @VD1_SKIPLOT  VARCHAR(1),   @VD1_DATORI   VARCHAR(8),   @VD1_SEQCALC  VARCHAR(14),  @VD1_BASEICM  FLOAT,        @VD1_VALDESC FLOAT,
        @VD1_LOTEFOR  VARCHAR(18),  @VD1_BASEIPI  FLOAT,        @VD1_LOTECTL  VARCHAR(10),  @VD1_NUMLOTE  VARCHAR(6),   @VD1_DTVALID VARCHAR(8),
        @VD1_PLACA    VARCHAR(7),   @VD1_CHASSI   VARCHAR(17),  @VD1_ANOFAB   VARCHAR(2),   @VD1_MODFAB   VARCHAR(2),   @VD1_FORMUL  VARCHAR(1),
        @VD1_MODELO   VARCHAR(15),  @VD1_COMBUST  VARCHAR(10),  @VD1_COR      VARCHAR(3),   @VD1_NUMPV    VARCHAR(6),   @VD1_ITEMPV  VARCHAR(2),
        @VD1_EQUIPS   VARCHAR(3),   @VD1_II       FLOAT,        @VD1_TEC      VARCHAR(16),  @VD1_CONHEC   VARCHAR(17),  @VD1_CUSFF1  FLOAT,
        @VD1_CUSFF2   FLOAT,        @VD1_CLASFIS  VARCHAR(3),   @VD1_CUSFF3   FLOAT,        @VD1_REMITO   VARCHAR(9),   @VD1_SERIREM VARCHAR(3),
        @VD1_CUSFF4   FLOAT,        @VD1_CUSFF5   FLOAT,        @VD1_CODCIAP  VARCHAR(6),   @VD1_BASIMP1  FLOAT,        @VD1_CUSTO   FLOAT,
        @VD1_BASIMP3  FLOAT,        @VD1_BASIMP4  FLOAT,        @VD1_BASIMP5  FLOAT,        @VD1_BASIMP6  FLOAT,        @VD1_VALIMP1 FLOAT,
        @VD1_VALIMP2  FLOAT,        @VD1_VALIMP3  FLOAT,        @VD1_VALIMP4  FLOAT,        @VD1_CIF      FLOAT,        @VD1_ITEMREM VARCHAR(4),
        @VD1_VALIMP5  FLOAT,        @VD1_TIPO_NF  VARCHAR(1),   @VD1_VALIMP6  FLOAT,        @VD1_CBASEAF  VARCHAR(14),  @VD1_ICMSCOM FLOAT,
        @VD1_BASIMP2  FLOAT,        @VD1_ALQIMP1  FLOAT,        @VD1_ALQIMP2  FLOAT,        @VD1_ALQIMP3  FLOAT,        @VD1_ALQIMP4 FLOAT,
        @VD1_ALQIMP5  FLOAT,        @VD1_ALQIMP6  FLOAT,        @VD1_QTDPEDI  FLOAT,        @VD1_VALFRE   FLOAT,        @VD1_RATEIO  VARCHAR(1),
        @VD1_SEGURO   FLOAT,        @VD1_DESPESA  FLOAT,        @VD1_BASEIRR  FLOAT,        @VD1_ALIQIRR  FLOAT,        @VD1_VALIRR  FLOAT,
        @VD1_BASEISS  FLOAT,        @VD1_ALIQISS  FLOAT,        @VD1_CUSORI   FLOAT,        @VD1_VALISS   FLOAT,        @VD1_BASEINS FLOAT,
        @VD1_ALIQINS  FLOAT,        @VD1_VALINS   FLOAT,        @VD1_VALACRS  FLOAT,        @VD1_LOCPAD   VARCHAR(6),   @VD1_ORDEM   VARCHAR(6),
        @VD1_SERVIC   VARCHAR(3),   @VD1_STSERV   VARCHAR(1),   @VD1_ENDER    VARCHAR(15),  @VD1_TIPODOC  VARCHAR(2),   @VD1_REGWMS  VARCHAR(1),
        @VD1_POTENCI  FLOAT,        @VD1_TRT      VARCHAR(3),   @VD1_GRADE    VARCHAR(1),   @VD1_ITEMGRD  VARCHAR(3),   @VD1_TESACLA VARCHAR(3),
        @VD1_PRUNDA   FLOAT,        @VD1_BASEPS3  FLOAT,        @VD1_ALIQPS3  FLOAT,        @VD1_VALPS3   FLOAT,        @VD1_BASECF3 FLOAT,
        @VD1_ALIQCF3  FLOAT,        @VD1_VALCF3   FLOAT,        @VD1_CODISS   VARCHAR(9),   @VD1_CFPS     VARCHAR(6),   @VD1_NUMDESP VARCHAR(16),
        @VD1_ORIGEM   VARCHAR(3),   @VD1_DESCICM  FLOAT,        @VD1_BASESES  FLOAT,        @VD1_VALSES   FLOAT,        @VD1_ALIQSES FLOAT,
        @VD1_RGESPST  VARCHAR(1),   @VD1_ABATISS  FLOAT,        @VD1_ABATMAT  FLOAT,        @VD1_BASNDES  FLOAT,        @VD1_ICMNDES FLOAT,
        @VD1_VALFDS   FLOAT,        @VD1_PRFDSUL  FLOAT,        @VD1_UFERMS   FLOAT,        @VD1_ESTCRED  FLOAT,        @VD1_VALANTI FLOAT,
        @VD1_CRPRSIM  FLOAT,        @VD1_ALIQSOL  FLOAT,        @VD1_CRPRESC  FLOAT,        @VD1_ALIQII   FLOAT,        @VD1_MARGEM  FLOAT,
        @VD1_SLDDEP   FLOAT,        @VD1_NFVINC   VARCHAR(9),   @VD1_SERVINC  VARCHAR(3),   @VD1_ITMVINC  VARCHAR(4),   @VD1_ICMSDIF FLOAT,
        @VD1_GARANTI  VARCHAR(1),   @VD1_PCCENTR  VARCHAR(6),   @VD1_ITPCCEN  VARCHAR(4),   @VD1_QTPCCEN  FLOAT,        @VD1_DFABRIC VARCHAR(8),
        @VD1_ABATINS  FLOAT,        @VD1_BASEFAB  FLOAT,        @VD1_ALIQFAB  FLOAT,        @VD1_VALFAB   FLOAT,        @VD1_BASEFAC FLOAT,
        @VD1_ALIQFAC  FLOAT,        @VD1_VALFAC   FLOAT,        @VD1_BASEFET  FLOAT,        @VD1_ALIQFET  FLOAT,        @VD1_VALFET  FLOAT,
        @VD1_CODLAN   VARCHAR(6),   @VD1_AVLINSS  FLOAT;

-- VARIAVEIS PARA TITULOS MCR01 (SE1)
DECLARE @VE1_FILIAL   VARCHAR(50),  @VE1_PREFIXO  VARCHAR(50),  @VE1_NUM      VARCHAR(50),  @VE1_PARCELA  VARCHAR(50),  @VE1_EMISSAO VARCHAR(50),
        @VE1_VENCTO   VARCHAR(50),  @VE1_VENCREA  VARCHAR(50),  @VE1_CLIENTE  VARCHAR(50),  @VE1_NOMCLI   VARCHAR(50),  @VE1_VALOR   FLOAT,
        @VE1_TIPO     VARCHAR(50),  @VE1_NATUREZ  VARCHAR(50),  @VE1_PORTADO  VARCHAR(50),  @VE1_AGEDEP   VARCHAR(50),  @VE1_LOJA    VARCHAR(50),
        @VE1_IRRF     FLOAT,        @VE1_ISS      FLOAT,        @VE1_INSS     FLOAT,        @VE1_NUMBCO   VARCHAR(50),  @VE1_INDICE  VARCHAR(50),
        @VE1_BAIXA    VARCHAR(50),  @VE1_NUMBOR   VARCHAR(50),  @VE1_DATABOR  VARCHAR(50),  @VE1_EMIS1    VARCHAR(50),  @VE1_HIST    VARCHAR(50),
        @VE1_LA       VARCHAR(50),  @VE1_LOTE     VARCHAR(50),  @VE1_MOTIVO   VARCHAR(50),  @VE1_MOVIMEN  VARCHAR(50),  @VE1_OP      VARCHAR(50),
        @VE1_SITUACA  VARCHAR(50),  @VE1_CONTRAT  VARCHAR(50),  @VE1_SALDO    FLOAT,        @VE1_SUPERVI  VARCHAR(50),  @VE1_VEND1   VARCHAR(50),
        @VE1_VEND2    VARCHAR(50),  @VE1_VEND3    VARCHAR(50),  @VE1_VEND4    VARCHAR(50),  @VE1_VEND5    VARCHAR(50),  @VE1_COMIS1  FLOAT,
        @VE1_COMIS2   FLOAT,        @VE1_COMIS3   FLOAT,        @VE1_COMIS4   FLOAT,        @VE1_COMIS5   FLOAT,        @VE1_DESCONT FLOAT,
        @VE1_MULTA    FLOAT,        @VE1_JUROS    FLOAT,        @VE1_CORREC   FLOAT,        @VE1_VALLIQ   FLOAT,        @VE1_VENCORI VARCHAR(50),
        @VE1_CONTA    VARCHAR(50),  @VE1_VALJUR   FLOAT,        @VE1_PORCJUR  FLOAT,        @VE1_MOEDA    FLOAT,        @VE1_BASCOM1 FLOAT,
        @VE1_BASCOM2  FLOAT,        @VE1_BASCOM3  FLOAT,        @VE1_BASCOM4  FLOAT,        @VE1_BASCOM5  FLOAT,        @VE1_OK      VARCHAR(50),
        @VE1_FATPREF  VARCHAR(50),  @VE1_FATURA   VARCHAR(50),  @VE1_PROJETO  VARCHAR(50),  @VE1_CLASCON  VARCHAR(50),  @VE1_VALCOM1 FLOAT,
        @VE1_VALCOM2  FLOAT,        @VE1_VALCOM3  FLOAT,        @VE1_VALCOM4  FLOAT,        @VE1_VALCOM5  FLOAT,        @VE1_OCORREN VARCHAR(50),
        @VE1_INSTR1   VARCHAR(50),  @VE1_INSTR2   VARCHAR(50),  @VE1_PEDIDO   VARCHAR(50),  @VE1_DTVARIA  VARCHAR(50),  @VE1_VARURV  FLOAT,
        @VE1_NUMNOTA  VARCHAR(50),  @VE1_SERIE    VARCHAR(50),  @VE1_VLCRUZ   FLOAT,        @VE1_DTFATUR  VARCHAR(50),  @VE1_IDENTEE VARCHAR(50),
        @VE1_STATUS   VARCHAR(50),  @VE1_ORIGEM   VARCHAR(50),  @VE1_NUMCART  VARCHAR(50),  @VE1_FLUXO    VARCHAR(50),  @VE1_DESCFIN FLOAT,
        @VE1_DIADESC  FLOAT,        @VE1_CARTAO   VARCHAR(50),  @VE1_CARTVAL  VARCHAR(50),  @VE1_VLRREAL  FLOAT,        @VE1_CARTAUT VARCHAR(50),
        @VE1_ADM      VARCHAR(50),  @VE1_TRANSF   VARCHAR(50),  @VE1_ORDPAGO  VARCHAR(50),  @VE1_BCOCHQ   VARCHAR(50),  @VE1_AGECHQ  VARCHAR(50),
        @VE1_CTACHQ   VARCHAR(50),  @VE1_NUMLIQ   VARCHAR(50),  @VE1_COFINS   FLOAT,        @VE1_FLAGFAT  VARCHAR(50),  @VE1_CSLL    FLOAT,
        @VE1_FILORIG  VARCHAR(50),  @VE1_PIS      FLOAT,        @VE1_TIPOFAT  VARCHAR(50),  @VE1_TIPOLIQ  VARCHAR(50),  @VE1_MESBASE VARCHAR(50),
        @VE1_ANOBASE  VARCHAR(50),  @VE1_PLNUCOB  VARCHAR(50),  @VE1_CODINT   VARCHAR(50),  @VE1_CODEMP   VARCHAR(50),  @VE1_MATRIC  VARCHAR(50),
        @VE1_ACRESC   FLOAT,        @VE1_SDACRES  FLOAT,        @VE1_DECRESC  FLOAT,        @VE1_SDDECRE  FLOAT,        @VE1_MULTNAT VARCHAR(50),
        @VE1_MSFIL    VARCHAR(50),  @VE1_MSEMP    VARCHAR(50),  @VE1_PROJPMS  VARCHAR(50),  @VE1_TIPODES  VARCHAR(50),  @VE1_TXMOEDA FLOAT,
        @VE1_DESDOBR  VARCHAR(50),  @VE1_NRDOC    VARCHAR(50),  @VE1_MODSPB   VARCHAR(50),  @VE1_FETHAB   FLOAT,        @VE1_NFELETR VARCHAR(50),
        @VE1_IDCNAB   VARCHAR(50),  @VE1_PARCFET  VARCHAR(50),  @VE1_PLCOEMP  VARCHAR(50),  @VE1_PLTPCOE  VARCHAR(50),  @VE1_BASEPIS FLOAT,
        @VE1_BASECOF  FLOAT,        @VE1_BASECSL  FLOAT,        @VE1_CODCOR   VARCHAR(50),  @VE1_PARCCSS  VARCHAR(50),  @VE1_SABTPIS FLOAT,
        @VE1_SABTCOF  FLOAT,        @VE1_SABTCSL  FLOAT,        @VE1_RECIBO   VARCHAR(50),  @VE1_DTACRED  VARCHAR(50),  @VE1_EMITCHQ VARCHAR(50),
        @VE1_CODORCA  VARCHAR(50),  @VE1_CODIMOV  VARCHAR(50),  @VE1_FILDEB   VARCHAR(50),  @VE1_NUMSOL   VARCHAR(50),  @VE1_NUMRA   VARCHAR(50),
        @VE1_INSCRIC  VARCHAR(50),  @VE1_SERREC   VARCHAR(50),  @VE1_DATAEDI  VARCHAR(50),  @VE1_CODBAR   VARCHAR(50),  @VE1_CHQDEV  VARCHAR(50),
        @VE1_CODDIG   VARCHAR(50),  @VE1_VLBOLSA  FLOAT,        @VE1_LIDESCF  VARCHAR(50),  @VE1_VLFIES   FLOAT,        @VE1_NUMCRD  VARCHAR(50),
        @VE1_DEBITO   VARCHAR(50),  @VE1_CCD      VARCHAR(50),  @VE1_ITEMD    VARCHAR(50),  @VE1_CLVLDB   VARCHAR(50),  @VE1_CREDIT  VARCHAR(50),
        @VE1_CCC      VARCHAR(50),  @VE1_ITEMC    VARCHAR(50),  @VE1_CLVLCR   VARCHAR(50),  @VE1_DESCON1  FLOAT,        @VE1_DESCON2 FLOAT,
        @VE1_DTDESC3  VARCHAR(50),  @VE1_DTDESC1  VARCHAR(50),  @VE1_DTDESC2  VARCHAR(50),  @VE1_VLMULTA  FLOAT,        @VE1_DESCON3 FLOAT,
        @VE1_MOTNEG   VARCHAR(50),  @VE1_FORNISS  VARCHAR(50),  @VE1_PARTOT   VARCHAR(50),  @VE1_SITFAT   VARCHAR(50),  @VE1_VRETISS FLOAT,
        @VE1_PARCIRF  VARCHAR(50),  @VE1_SCORGP   VARCHAR(50),  @VE1_FRETISS  VARCHAR(50),  @VE1_TXMDCOR  FLOAT,        @VE1_SATBIRF FLOAT,
        @VE1_TIPREG   VARCHAR(50),  @VE1_CONEMP   VARCHAR(50),  @VE1_VERCON   VARCHAR(50),  @VE1_SUBCON   VARCHAR(50),  @VE1_VERSUB  VARCHAR(50),
        @VE1_PLLOTE   VARCHAR(50),  @VE1_PLOPELT  VARCHAR(50),  @VE1_CODRDA   VARCHAR(50),  @VE1_FORMREC  VARCHAR(50),  @VE1_BCOCLI  VARCHAR(50),
        @VE1_AGECLI   VARCHAR(50),  @VE1_CTACLI   VARCHAR(50),  @VE1_NUMCON   VARCHAR(50);

-- VARIAVEIS PARA MOVIMENTOS TITULOS MCR02 (SE5)
DECLARE @VE5_FILIAL   VARCHAR(2),   @VE5_DATA     VARCHAR(8),   @VE5_TIPO     VARCHAR(3),   @VE5_MOEDA    VARCHAR(2),   @VE5_VALOR   FLOAT,
        @VE5_NATUREZ  VARCHAR(10),  @VE5_BANCO    VARCHAR(3),   @VE5_AGENCIA  VARCHAR(5),   @VE5_CONTA    VARCHAR(10),  @VE5_NUMCHEQ VARCHAR(15),
        @VE5_DOCUMEN  VARCHAR(50),  @VE5_VENCTO   VARCHAR(8),   @VE5_RECPAG   VARCHAR(1),   @VE5_BENEF    VARCHAR(30),  @VE5_HISTOR  VARCHAR(40),
        @VE5_TIPODOC  VARCHAR(2),   @VE5_VLMOED2  FLOAT,        @VE5_LA       VARCHAR(2),   @VE5_SITUACA  VARCHAR(1),   @VE5_LOTE    VARCHAR(8),
        @VE5_PREFIXO  VARCHAR(3),   @VE5_NUMERO   VARCHAR(9),   @VE5_PARCELA  VARCHAR(1),   @VE5_CLIFOR   VARCHAR(6),   @VE5_LOJA    VARCHAR(2),
        @VE5_DTDIGIT  VARCHAR(8),   @VE5_TIPOLAN  VARCHAR(1),   @VE5_DEBITO   VARCHAR(20),  @VE5_CREDITO  VARCHAR(20),  @VE5_MOTBX   VARCHAR(3),
        @VE5_RATEIO   VARCHAR(1),   @VE5_RECONC   VARCHAR(1),   @VE5_SEQ      VARCHAR(2),   @VE5_DTDISPO  VARCHAR(8),   @VE5_CCD     VARCHAR(9),
        @VE5_CCC      VARCHAR(9),   @VE5_OK       VARCHAR(2),   @VE5_ARQRAT   VARCHAR(50),  @VE5_IDENTEE  VARCHAR(6),   @VE5_ORDREC  VARCHAR(6),
        @VE5_FILORIG  VARCHAR(2),   @VE5_ARQCNAB  VARCHAR(12),  @VE5_VLJUROS  FLOAT,        @VE5_VLMULTA  FLOAT,        @VE5_VLCORRE FLOAT,
        @VE5_VLDESCO  FLOAT,        @VE5_CNABOC   VARCHAR(2),   @VE5_SITUA    VARCHAR(2),   @VE5_ITEMD    VARCHAR(9),   @VE5_ITEMC   VARCHAR(9),
        @VE5_CLVLDB   VARCHAR(9),   @VE5_CLVLCR   VARCHAR(9),   @VE5_PROJPMS  VARCHAR(10),  @VE5_EDTPMS   VARCHAR(12),  @VE5_TASKPMS VARCHAR(12),
        @VE5_MODSPB   VARCHAR(1),   @VE5_FATURA   VARCHAR(9),   @VE5_TXMOEDA  FLOAT,        @VE5_CODORCA  VARCHAR(8),   @VE5_FATPREF VARCHAR(3),
        @VE5_SITCOB   VARCHAR(1),   @VE5_FORNADT  VARCHAR(6),   @VE5_LOJAADT  VARCHAR(2),   @VE5_CLIENTE  VARCHAR(6),   @VE5_FORNECE VARCHAR(6),
        @VE5_SERREC   VARCHAR(3),   @VE5_OPERAD   VARCHAR(6),   @VE5_MOVCX    VARCHAR(1),   @VE5_KEY      VARCHAR(50),  @VE5_MULTNAT VARCHAR(1),
        @VE5_AGLIMP   VARCHAR(9),   @VE5_VLACRES  FLOAT,        @VE5_VLDECRE  FLOAT,        @VE5_VRETPIS  FLOAT,        @VE5_VRETCOF FLOAT,
        @VE5_VRETCSL  FLOAT,        @VE5_PRETPIS  VARCHAR(1),   @VE5_PRETCOF  VARCHAR(1),   @VE5_PRETCSL  VARCHAR(1),   @VE5_AUTBCO  VARCHAR(25),
        @VE5_PRETIRF  VARCHAR(1),   @VE5_VRETIRF  FLOAT,        @VE5_VRETISS  FLOAT,        @VE5_NUMMOV   VARCHAR(2),   @VE5_DIACTB  VARCHAR(2),
        @VE5_NODIA    VARCHAR(10),  @VE5_BASEIRF  FLOAT,        @VE5_PROCTRA  VARCHAR(20),  @VE5_ORIGEM   VARCHAR(8),   @VE5_FORMAPG VARCHAR(5),
        @VE5_TPDESC   VARCHAR(1),   @VE5_PRINSS   FLOAT,        @VE5_PRISS    FLOAT,        @VE5_PRETINS  VARCHAR(1),   @VE5_VRETINS FLOAT,
        @VE5_IDMOVI   VARCHAR(10),  @VE5_DTCANBX  VARCHAR(8),   @VE5_FLDMED   VARCHAR(1),   @VE5_CGC      VARCHAR(14);

-- VARIAVEIS PARA COMISSOES (SE3)
DECLARE @VE3_FILIAL   VARCHAR(50),  @VE3_VEND     VARCHAR(50),  @VE3_NUM      VARCHAR(50),  @VE3_EMISSAO  VARCHAR(50),  @VE3_SERIE   VARCHAR(50),
        @VE3_CODCLI   VARCHAR(50),  @VE3_LOJA     VARCHAR(50),  @VE3_BASE     FLOAT,        @VE3_PORC     FLOAT,        @VE3_COMIS   FLOAT,
        @VE3_DATA     VARCHAR(50),  @VE3_PREFIXO  VARCHAR(50),  @VE3_PARCELA  VARCHAR(50),  @VE3_TIPO     VARCHAR(50),  @VE3_BAIEMI  VARCHAR(50),
        @VE3_PEDIDO   VARCHAR(50),  @VE3_SEQ      VARCHAR(50),  @VE3_ORIGEM   VARCHAR(50),  @VE3_VENCTO   VARCHAR(50);

-- VARIAVEIS PARA CLASSIFICACAO COMERCIAL CLIENTE (CC3)
DECLARE @VCC3_FILIAL  VARCHAR(20),  @VCC3_COD     VARCHAR(15),  @VCC3_DESC VARCHAR(50);

-----------------------------------------------------------------------------------------------------------------------------------------------------
---  VERSAO   DATA        AUTOR            ALTERACAO
---  1.00001  21/10/2016  ALENCAR          ROTINA CRIADA PARA LER OS REGISTROS DA TABELA DE LOG DE INTERFACE (DB_INTERFACE_PROTHEUS) E
---                                        ATUALIZAR AS INFORMACOES NO MERCANET
---                                        ESSA ROTINA EH EXECUTADA ATRAVES DE JOBS SCHEDULADOS
---                                        O RESPONSAVEL POR LOGAR AS INFORMACOES NA DB_INTERFACE_PROTHEUS EH O PROTHEUS
---                                        @P_TIPO PODE RECEBER OS VALORES:

---                                        CLIENTES                                20
---                                        PEDIDOS                                 30
---                                        NOTAS FISCAIS - DEVOLUCOES              35
---                                        NOTAS FISCAIS (VENDAS, BONIFICACOES E TRANSFERENCIAS) 37
---                                        PRODUTOS                                40
---                                        LISTAS DE PREÇOS (CAPA E ITEM)          41
---                                        TITULOS                                 50
---                                        FAMILIA DE PRODUTOS (LINHA DE PRODUTO)  8004
---                                        REPRESENTANTES                          8005
---                                        OPERACOES DE VENDAS                     8007
---                                        CONDICOES DE PAGAMENTOS                 8012
---                                        ESTADOS                                 8017
---                                        TRANSPORTADORAS                         8020
---                                        TIPO DE PRODUTOS (MARCA)                8100
---                                        MARCA DE PRODUTOS (GRUPO DE DEVOLUCAO)) 8101
---                                        GRUPO DE PRODUTOS                       8102
---                                        CIDADES                                 8103
---                                        PAISES                                  8104
---                                        RAMOS DE ATIVIDADES I                   8105
---                                        RAMOS DE ATIVIDADES II                  8106
---                                        PORTADORES                              8107
---                                        MOVIMENTOS DO TITULO                    8108
---                                        COMISSOES                               8109
---                                        CLASSIFICACAO COMERCIAL CLIENTE         8110
---                                        PROMOTORES                              8111
---  1.00002  21/11/2016  ALENCAR          PASSA POR PARAMETRO O NOVO CAMPO NA DA0 - DA0_VAESDI, QUE DEFINE SE A LISTA E E=ESTATICA; D=DINAMICA.
---                                        NOVOS CAMPOS NA INTEGRACAO DE PRODUTOS (SB1)
---  1.00003  24/02/2017  ALENCAR          PASSA NOVO PARAMETRO @VA1_OBSALI NA CLIENTE SA1
---  1.00004  13/03/2017  ALENCAR          PASSA NOVO PARAMETRO @VB1_P_BRT NA PRODUTO SB1
---                                        PASSA NOVO PARAMETRO @VA1_CNAE NA CLIENTE SA1
---  1.00005  13/03/2017  ALENCAR          IMPLEMENTADO NOVA INTEGRACAO DO CADASTRO DE CLASSIFICACAO COMERCIAL CLIENTE (8110)
---  1.00006  14/06/2017  ALENCAR          PARAMETRO A1_VAREGE NA SA1
---  1.00007  16/06/2017  ALENCAR          PARAMETRO F4_MARGEM NA SF4
---  1.00008  19/06/2017  ALENCAR          PARAMETRO C5_VAPDMER NA SC5
---  1.00009  03/07/2017  SERGIO LUCCHINI  PARAMETRO @VA1_VAOC NA SA1
---                                        PARAMETRO @VB1_VAPLLAS E @VB1_VAPLCAM NA SB1
---  1.00010  23/05/2018  SERGIO LUCCHINI  INCLUIDO A INTEGRACAO DE PROMOTORES. CHAMADO 81267
---           19/06/2018  ROBERT           NAO ESTAVA ENVIANDO PARAMETRO @VA1_VAPROMO PARA A PROCEDURE 'MERCP_SA1010'
---           26/07/2019  ROBERT           DESABILITADA LEITURA CAMPOS B1_VAEANUN E B1_VADUNCX. PASSA A USAR CPOS PADRAO B5_2CODBAR e B1_CODBAR.
---           07/10/2020  ROBERT           TRATAMENTO PARA NOVO CAMPO E4_VAEXMER (DEIXAR A CONDICAO INATIVA QUANDO CONTIVER 'N' NESSE CAMPO)
---           16/04/2021  CLAUDIA		   INCLUIDO O CAMPO DE % MAXIMO DE DESCONTO DA0_PERMAX
---           20/04/2021  CLAUDIA		   INCLUIDO O CAMPO DE % MAXIMO DE DESCONTO DA0_PERMIN
---           20/06/2021  CLAUDIA          INCLUIDOS CAMPOS DE COBRANÇA. GLPI: 9633
---           17/03/2022  ROBERT           VERSAO INICIAL USANDO SONONIMOS PARA NOMES DE TABELAS
--            07/04/2022  ROBERT           REMOVIDOS ALGUNS COMENTARIOS E APLICADA EM BASE DE PRODUCAO
--            10/05/2022  CLAUDIA          RETIRADO CAMPO B1_P_BRT. GLPI: 11822
--
-----------------------------------------------------------------------------------------------------------------------------------------------------

BEGIN TRY

-----------------------------------------------------------------------------------------------
--  PASSO 1 - PARA AS INTEGRACOES QUE CARREGA O CADASTRO INTEIRO, NAO UTILIZA TABELA DE LOG
-----------------------------------------------------------------------------------------------

-------------------------------------------------------------------
--  8020 - TRANSPORTADORAS
--         ATUALIZA SEMPRE TODAS AS TRANSPORTADORAS DO CADASTRO
-------------------------------------------------------------------
IF @P_TIPO = 8020
BEGIN

   -- BUSCA TODOS OS REGISTROS DO CADASTRO
   SET @C_TRANSPORTADORAS = CURSOR STATIC FOR
   SELECT A4_FILIAL,  A4_COD,       A4_NOME,   A4_NREDUZ, A4_VIA,   A4_END,     A4_MUN,
          A4_CEP,     A4_EST,       A4_CGC,    A4_TEL,    A4_TELEX, A4_CONTATO, A4_INSEST,
          A4_EMAIL,   A4_HPAGE,     A4_BAIRRO, A4_DDI,    A4_DDD,   A4_ENDPAD,  D_E_L_E_T_,
          R_E_C_N_O_, R_E_C_D_E_L_, A4_ESTFIS, A4_LOCAL
	 FROM INTEGRACAO_PROTHEUS_SA4
     OPEN @C_TRANSPORTADORAS
    FETCH NEXT FROM @C_TRANSPORTADORAS
     INTO @VA4_FILIAL,  @VA4_COD,       @VA4_NOME,   @VA4_NREDUZ, @VA4_VIA,   @VA4_END,     @VA4_MUN,
          @VA4_CEP,     @VA4_EST,       @VA4_CGC,    @VA4_TEL,    @VA4_TELEX, @VA4_CONTATO, @VA4_INSEST,
          @VA4_EMAIL,   @VA4_HPAGE,     @VA4_BAIRRO, @VA4_DDI,    @VA4_DDD,   @VA4_ENDPAD,  @VD_E_L_E_T_,
          @VR_E_C_N_O_, @VR_E_C_D_E_L_, @VA4_ESTFIS, @VA4_LOCAL
    WHILE @@FETCH_STATUS = 0
   BEGIN

     EXEC [dbo].[MERCP_SA4010] 0, @VA4_FILIAL,  @VA4_COD,       @VA4_NOME,   @VA4_NREDUZ, @VA4_VIA,   @VA4_END,     @VA4_MUN,
                                  @VA4_CEP,     @VA4_EST,       @VA4_CGC,    @VA4_TEL,    @VA4_TELEX, @VA4_CONTATO, @VA4_INSEST,
                                  @VA4_EMAIL,   @VA4_HPAGE,     @VA4_BAIRRO, @VA4_DDI,    @VA4_DDD,   @VA4_ENDPAD,  @VD_E_L_E_T_,
                                  @VR_E_C_N_O_, @VR_E_C_D_E_L_, @VA4_ESTFIS, @VA4_LOCAL

    FETCH NEXT FROM @C_TRANSPORTADORAS
     INTO @VA4_FILIAL,  @VA4_COD,       @VA4_NOME,   @VA4_NREDUZ, @VA4_VIA,   @VA4_END,     @VA4_MUN,
          @VA4_CEP,     @VA4_EST,       @VA4_CGC,    @VA4_TEL,    @VA4_TELEX, @VA4_CONTATO, @VA4_INSEST,
          @VA4_EMAIL,   @VA4_HPAGE,     @VA4_BAIRRO, @VA4_DDI,    @VA4_DDD,   @VA4_ENDPAD,  @VD_E_L_E_T_,
          @VR_E_C_N_O_, @VR_E_C_D_E_L_, @VA4_ESTFIS, @VA4_LOCAL

   END
        CLOSE @C_TRANSPORTADORAS
   DEALLOCATE @C_TRANSPORTADORAS
END;
----------------------------------
--  FIM 8020 - TRANSPORTADORAS
----------------------------------


---------------------------------------------------------
--  8100 - TIPOS DE PRODUTOS
--         ATUALIZA SEMPRE TODAS OS TIPOS DO CADASTRO
---------------------------------------------------------
IF @P_TIPO = 8100
BEGIN
   -- BUSCA TODOS OS REGISTROS DO CADASTRO
   SET @C_TPPROD = CURSOR STATIC FOR
   SELECT ZX5_FILIAL,  ZX5_TABELA,  ZX5_CHAVE,   ZX5_DESCRI,   ZX5_18COD,   ZX5_18DESC, D_E_L_E_T_,  R_E_C_N_O_,
          ZX5_39COD,   ZX5_39DESC,  ZX5_40COD,   ZX5_40DESC, ZX5_46COD,   ZX5_46DESC
     FROM INTEGRACAO_PROTHEUS_ZX5
    WHERE ZX5_TABELA = '40'
      AND ZX5_FILIAL = '  '
        OPEN @C_TPPROD
        FETCH NEXT FROM @C_TPPROD
            INTO @VZX5_FILIAL,  @VZX5_TABELA, @VZX5_CHAVE,   @VZX5_DESCRI,   @VZX5_18COD,   @VZX5_18DESC, @VD_E_L_E_T_,  @VR_E_C_N_O_,
                 @VZX5_39COD,   @VZX5_39DESC, @VZX5_40COD,   @VZX5_40DESC,   @VZX5_46COD,   @VZX5_46DESC
        WHILE @@FETCH_STATUS = 0
   BEGIN

            EXEC [dbo].[MERCP_ZX5010] 0, @VZX5_FILIAL,  @VZX5_TABELA,  @VZX5_CHAVE,   @VZX5_DESCRI,   @VZX5_18COD,   @VZX5_18DESC,
                                         @VD_E_L_E_T_,  @VR_E_C_N_O_,  @VZX5_39COD,   @VZX5_39DESC, @VZX5_40COD,   @VZX5_40DESC,   @VZX5_46COD,   @VZX5_46DESC

        FETCH NEXT FROM @C_TPPROD
            INTO @VZX5_FILIAL,  @VZX5_TABELA,  @VZX5_CHAVE,   @VZX5_DESCRI,   @VZX5_18COD,   @VZX5_18DESC, @VD_E_L_E_T_,  @VR_E_C_N_O_,
                 @VZX5_39COD,   @VZX5_39DESC, @VZX5_40COD,   @VZX5_40DESC,   @VZX5_46COD,   @VZX5_46DESC

   END
        CLOSE @C_TPPROD
   DEALLOCATE @C_TPPROD
END;
------------------------------------
--  FIM 8100 - TIPOS DE PRODUTOS
------------------------------------


    ----------------------------------------------------------
    --- 8101 - MARCA DE PRODUTOS
    ---        ATUALIZA SEMPRE TODAS AS MARCAS DO CADASTRO
    ----------------------------------------------------------
    IF @P_TIPO = 8101
    BEGIN
        --- BUSCA TODOS OS REGISTROS DO CADASTRO
        SET @C_MARCA = CURSOR STATIC FOR
                
            SELECT ZAZ_FILIAL, ZAZ_CLINF, ZAZ_NLINF, D_E_L_E_T_,  R_E_C_N_O_ 
                FROM INTEGRACAO_PROTHEUS_ZAZ

        OPEN @C_MARCA
        FETCH NEXT FROM @C_MARCA
            INTO @VZAZ_FILIAL, @VZAZ_CLINF, @VZAZ_NLINF, @VD_E_L_E_T_,  @VR_E_C_N_O_
        WHILE @@FETCH_STATUS = 0
        BEGIN

            EXEC [dbo].[MERCP_ZAZ010] 0, @VZAZ_FILIAL, @VZAZ_CLINF, @VZAZ_NLINF, @VD_E_L_E_T_,  @VR_E_C_N_O_

        FETCH NEXT FROM @C_MARCA
            INTO @VZAZ_FILIAL, @VZAZ_CLINF, @VZAZ_NLINF, @VD_E_L_E_T_,  @VR_E_C_N_O_
        END

        CLOSE @C_MARCA
        DEALLOCATE @C_MARCA
    END;
    ------------------------------------
    --- FIM 8101 - MARCA DE PRODUTOS
    ------------------------------------



    ------------------------------------------------------------
    --- 8004 - FAMILIAS DE PRODUTOS
    ---        ATUALIZA SEMPRE TODAS AS FAMILIAS DO CADASTRO
    ------------------------------------------------------------
    IF @P_TIPO = 8004
    BEGIN
   
        --- BUSCA TODOS OS REGISTROS DO CADASTRO
        SET @C_FAMILIA = CURSOR STATIC FOR
                
            SELECT BM_FILIAL,  BM_GRUPO,  BM_DESC,  BM_PICPAD,  BM_PROORI,   BM_CODMAR,   BM_STATUS,  BM_GRUREL,
                   BM_TIPGRU,  BM_MARKUP, BM_PRECO, BM_LENREL,  BM_TIPMOV,   D_E_L_E_T_,  R_E_C_N_O_, R_E_C_D_E_L_,
                   BM_CLASGRU, BM_FORMUL
                FROM INTEGRACAO_PROTHEUS_SBM

        OPEN @C_FAMILIA
        FETCH NEXT FROM @C_FAMILIA
            INTO @VBM_FILIAL,  @VBM_GRUPO,  @VBM_DESC,  @VBM_PICPAD,  @VBM_PROORI,   @VBM_CODMAR,   @VBM_STATUS,  @VBM_GRUREL,
              @VBM_TIPGRU,  @VBM_MARKUP, @VBM_PRECO, @VBM_LENREL,  @VBM_TIPMOV,   @VD_E_L_E_T_,  @VR_E_C_N_O_, @VR_E_C_D_E_L_,
              @VBM_CLASGRU, @VBM_FORMUL
        WHILE @@FETCH_STATUS = 0
        BEGIN

            EXEC [dbo].[MERCP_SBM010] 0, @VBM_FILIAL,  @VBM_GRUPO,  @VBM_DESC,  @VBM_PICPAD,  @VBM_PROORI,   @VBM_CODMAR,   @VBM_STATUS,  @VBM_GRUREL,
                                          @VBM_TIPGRU,  @VBM_MARKUP, @VBM_PRECO, @VBM_LENREL,  @VBM_TIPMOV,   @VD_E_L_E_T_,  @VR_E_C_N_O_, @VR_E_C_D_E_L_,
                                          @VBM_CLASGRU, @VBM_FORMUL

        FETCH NEXT FROM @C_FAMILIA
            INTO @VBM_FILIAL,  @VBM_GRUPO,  @VBM_DESC,  @VBM_PICPAD,  @VBM_PROORI,   @VBM_CODMAR,   @VBM_STATUS,  @VBM_GRUREL,
              @VBM_TIPGRU,  @VBM_MARKUP, @VBM_PRECO, @VBM_LENREL,  @VBM_TIPMOV,   @VD_E_L_E_T_,  @VR_E_C_N_O_, @VR_E_C_D_E_L_,
              @VBM_CLASGRU, @VBM_FORMUL
        END

        CLOSE @C_FAMILIA
        DEALLOCATE @C_FAMILIA
           
    END;
    ---------------------------
    ---- FIM 8004 - FAMILIAS DE PRODUTOS
    ---------------------------


    ---------------------------
    ---- 8102 - GRUPOS DE PRODUTOS
    ----          ATUALIZA SEMPRE TODAS OS GRUPOS DO CADASTRO
    ---------------------------
    IF @P_TIPO = 8102
    BEGIN
        --- BUSCA TODOS OS REGISTROS DO CADASTRO
        SET @C_GRUPO = CURSOR STATIC FOR
                
            SELECT ZX5_FILIAL,  ZX5_TABELA,  ZX5_CHAVE,   ZX5_DESCRI,   ZX5_18COD,   ZX5_18DESC, D_E_L_E_T_,  R_E_C_N_O_,
                   ZX5_39COD,   ZX5_39DESC,  ZX5_40COD,   ZX5_40DESC,   ZX5_46COD,   ZX5_46DESC
                FROM INTEGRACAO_PROTHEUS_ZX5
                WHERE ZX5_TABELA = '39'
                AND ZX5_FILIAL = '  '

        OPEN @C_GRUPO
        FETCH NEXT FROM @C_GRUPO
            INTO @VZX5_FILIAL,  @VZX5_TABELA,  @VZX5_CHAVE,   @VZX5_DESCRI,   @VZX5_18COD,   @VZX5_18DESC, @VD_E_L_E_T_,  @VR_E_C_N_O_,
                 @VZX5_39COD,   @VZX5_39DESC,  @VZX5_40COD,   @VZX5_40DESC,   @VZX5_46COD,   @VZX5_46DESC
        WHILE @@FETCH_STATUS = 0
        BEGIN

            EXEC [dbo].[MERCP_ZX5010] 0, @VZX5_FILIAL,  @VZX5_TABELA,  @VZX5_CHAVE,   @VZX5_DESCRI,   @VZX5_18COD,   @VZX5_18DESC,
                                         @VD_E_L_E_T_,  @VR_E_C_N_O_,  @VZX5_39COD,   @VZX5_39DESC,   @VZX5_40COD,   @VZX5_40DESC,   @VZX5_46COD,   @VZX5_46DESC

        FETCH NEXT FROM @C_GRUPO
            INTO @VZX5_FILIAL,  @VZX5_TABELA,  @VZX5_CHAVE,   @VZX5_DESCRI,   @VZX5_18COD,   @VZX5_18DESC, @VD_E_L_E_T_,  @VR_E_C_N_O_,
                 @VZX5_39COD,   @VZX5_39DESC,  @VZX5_40COD,   @VZX5_40DESC,   @VZX5_46COD,   @VZX5_46DESC
        END

        CLOSE @C_GRUPO
        DEALLOCATE @C_GRUPO

    END;
    ---------------------------
    ---- FIM 8102 - GRUPOS DE PRODUTOS
    ---------------------------


    ---------------------------
    ---- 8103 - CIDADES
    ----          ATUALIZA SEMPRE TODAS AS CIDADES DO CADASTRO
    ---------------------------
    IF @P_TIPO = 8103
    BEGIN

        --- BUSCA TODOS OS REGISTROS DO CADASTRO
        SET @C_CIDADES = CURSOR STATIC FOR
                
            SELECT CC2_FILIAL   , CC2_EST      , CC2_CODMUN   , CC2_MUN      , D_E_L_E_T_   , R_E_C_N_O_   , R_E_C_D_E_L_
                FROM INTEGRACAO_PROTHEUS_CC2

        OPEN @C_CIDADES
        FETCH NEXT FROM @C_CIDADES
            INTO @VCC2_FILIAL   , @VCC2_EST,        @VCC2_CODMUN   , @VCC2_MUN,        @VD_E_L_E_T_   , @VR_E_C_N_O_   , @VR_E_C_D_E_L_ 
        WHILE @@FETCH_STATUS = 0
        BEGIN

            EXEC [dbo].[MERCP_CC2010] 0, @VCC2_FILIAL   , @VCC2_EST,        @VCC2_CODMUN   , @VCC2_MUN,        @VD_E_L_E_T_   , @VR_E_C_N_O_   , @VR_E_C_D_E_L_ 

        FETCH NEXT FROM @C_CIDADES
            INTO @VCC2_FILIAL   , @VCC2_EST,        @VCC2_CODMUN   , @VCC2_MUN,        @VD_E_L_E_T_   , @VR_E_C_N_O_   , @VR_E_C_D_E_L_ 
        END

        CLOSE @C_CIDADES
        DEALLOCATE @C_CIDADES

    END;
    ---------------------------
    ---- FIM 8103 - CIDADES
    ---------------------------


-----------------------------------------------------------
--  8017 - ESTADOS
--         ATUALIZA SEMPRE TODAS OS ESTADOS DO CADASTRO
-----------------------------------------------------------
IF @P_TIPO = 8017
BEGIN

   -- BUSCA TODOS OS REGISTROS DO CADASTRO
   SET @C_ESTADOS = CURSOR STATIC FOR
   SELECT X5_FILIAL, X5_TABELA, X5_CHAVE, X5_DESCRI, X5_DESCSPA, X5_DESCENG, D_E_L_E_T_, R_E_C_N_O_
     FROM INTEGRACAO_PROTHEUS_SX5
    WHERE X5_TABELA = '12'
     OPEN @C_ESTADOS
    FETCH NEXT FROM @C_ESTADOS
     INTO @VX5_FILIAL, @VX5_TABELA, @VX5_CHAVE, @VX5_DESCRI, @VX5_DESCSPA, @VX5_DESCENG, @VD_E_L_E_T_, @VR_E_C_N_O_
    WHILE @@FETCH_STATUS = 0
   BEGIN

     EXEC [dbo].[MERCP_SX5010] 0, @VX5_FILIAL, @VX5_TABELA, @VX5_CHAVE, @VX5_DESCRI, @VX5_DESCSPA, @VX5_DESCENG, @VD_E_L_E_T_, @VR_E_C_N_O_

    FETCH NEXT FROM @C_ESTADOS
     INTO @VX5_FILIAL, @VX5_TABELA, @VX5_CHAVE, @VX5_DESCRI, @VX5_DESCSPA, @VX5_DESCENG, @VD_E_L_E_T_, @VR_E_C_N_O_
   END

        CLOSE @C_ESTADOS
   DEALLOCATE @C_ESTADOS

END;
--------------------------
--  FIM 8017 - ESTADOS
--------------------------


    ---------------------------
    ---- 8104 - PAISES
    ----          ATUALIZA SEMPRE TODAS OS PAISES DO CADASTRO
    ---------------------------
    IF @P_TIPO = 8104
    BEGIN
        --- BUSCA TODOS OS REGISTROS DO CADASTRO
        SET @C_PAISES = CURSOR STATIC FOR
                
            SELECT YA_FILIAL, YA_CODGI,  YA_DESCR,   YA_SIGLA,   YA_IDIOMA,  YA_NOIDIOM,   YA_DINALAD,
                   YA_NALADI, YA_ALADI,  YA_COMUM,   YA_MERCOSU, YA_SGPC,    YA_LI,        YA_PAIS_I,
                   YA_ABICS,  YA_SISEXP, YA_CODRIEX, D_E_L_E_T_, R_E_C_N_O_, R_E_C_D_E_L_, YA_CODFIES,
                   YA_SGLMEX, YA_NASCIO, YA_CODERP
              FROM INTEGRACAO_PROTHEUS_SYA

        OPEN @C_PAISES
        FETCH NEXT FROM @C_PAISES
            INTO @VYA_FILIAL, @VYA_CODGI,  @VYA_DESCR,   @VYA_SIGLA,   @VYA_IDIOMA,  @VYA_NOIDIOM,   @VYA_DINALAD,
                 @VYA_NALADI, @VYA_ALADI,  @VYA_COMUM,   @VYA_MERCOSU, @VYA_SGPC,    @VYA_LI,        @VYA_PAIS_I,
                 @VYA_ABICS,  @VYA_SISEXP, @VYA_CODRIEX, @VD_E_L_E_T_, @VR_E_C_N_O_, @VR_E_C_D_E_L_, @VYA_CODFIES,
                 @VYA_SGLMEX, @VYA_NASCIO, @VYA_CODERP
        WHILE @@FETCH_STATUS = 0
        BEGIN

            EXEC [dbo].[MERCP_SYA010] 0, @VYA_FILIAL, @VYA_CODGI,  @VYA_DESCR,   @VYA_SIGLA,   @VYA_IDIOMA,  @VYA_NOIDIOM,   @VYA_DINALAD,
                                         @VYA_NALADI, @VYA_ALADI,  @VYA_COMUM,   @VYA_MERCOSU, @VYA_SGPC,    @VYA_LI,        @VYA_PAIS_I,
                                         @VYA_ABICS,  @VYA_SISEXP, @VYA_CODRIEX, @VD_E_L_E_T_, @VR_E_C_N_O_, @VR_E_C_D_E_L_, @VYA_CODFIES,
                                         @VYA_SGLMEX, @VYA_NASCIO, @VYA_CODERP

        FETCH NEXT FROM @C_PAISES
            INTO @VYA_FILIAL, @VYA_CODGI,  @VYA_DESCR,   @VYA_SIGLA,   @VYA_IDIOMA,  @VYA_NOIDIOM,   @VYA_DINALAD,
                 @VYA_NALADI, @VYA_ALADI,  @VYA_COMUM,   @VYA_MERCOSU, @VYA_SGPC,    @VYA_LI,        @VYA_PAIS_I,
                 @VYA_ABICS,  @VYA_SISEXP, @VYA_CODRIEX, @VD_E_L_E_T_, @VR_E_C_N_O_, @VR_E_C_D_E_L_, @VYA_CODFIES,
                 @VYA_SGLMEX, @VYA_NASCIO, @VYA_CODERP
        END

        CLOSE @C_PAISES
        DEALLOCATE @C_PAISES

    END;
    ---------------------------
    ---- FIM 8104 - PAISES
    ---------------------------



    ---------------------------
    ---- 8105 - RAMOS DE ATIVIDADES I
    ----          ATUALIZA SEMPRE TODAS OS RAMOS DO CADASTRO
    ---------------------------
    IF @P_TIPO = 8105
    BEGIN

        --- BUSCA TODOS OS REGISTROS DO CADASTRO
        SET @C_RAMOS_1 = CURSOR STATIC FOR
                
            SELECT ZX5_FILIAL, ZX5_TABELA, ZX5_CHAVE, ZX5_DESCRI, ZX5_18COD, ZX5_18DESC, D_E_L_E_T_, R_E_C_N_O_,
                   ZX5_39COD,   ZX5_39DESC, ZX5_40COD,   ZX5_40DESC,   ZX5_46COD,   ZX5_46DESC
                FROM INTEGRACAO_PROTHEUS_ZX5
                WHERE ZX5_TABELA = '18'
                AND ZX5_CHAVE <> ' '

        OPEN @C_RAMOS_1
        FETCH NEXT FROM @C_RAMOS_1
            INTO @VZX5_FILIAL, @VZX5_TABELA, @VZX5_CHAVE, @VZX5_DESCRI, @VZX5_18COD, @VZX5_18DESC, @VD_E_L_E_T_, @VR_E_C_N_O_,
                 @VZX5_39COD,  @VZX5_39DESC, @VZX5_40COD, @VZX5_40DESC, @VZX5_46COD, @VZX5_46DESC
        WHILE @@FETCH_STATUS = 0
        BEGIN

            EXEC [dbo].[MERCP_ZX5010] 0, @VZX5_FILIAL, @VZX5_TABELA, @VZX5_CHAVE, @VZX5_DESCRI, @VZX5_18COD, @VZX5_18DESC, @VD_E_L_E_T_, @VR_E_C_N_O_,
                                         @VZX5_39COD,  @VZX5_39DESC, @VZX5_40COD, @VZX5_40DESC, @VZX5_46COD, @VZX5_46DESC

        FETCH NEXT FROM @C_RAMOS_1
            INTO @VZX5_FILIAL, @VZX5_TABELA, @VZX5_CHAVE, @VZX5_DESCRI, @VZX5_18COD, @VZX5_18DESC, @VD_E_L_E_T_, @VR_E_C_N_O_,
                 @VZX5_39COD,  @VZX5_39DESC, @VZX5_40COD, @VZX5_40DESC, @VZX5_46COD, @VZX5_46DESC
        END

        CLOSE @C_RAMOS_1
        DEALLOCATE @C_RAMOS_1

    END;
    ---------------------------
    ---- FIM 8105 - RAMOS DE ATIVIDADES I
    ---------------------------



---------------------------------------------------------
--  8106 - RAMOS DE ATIVIDADES II
--         ATUALIZA SEMPRE TODAS OS RAMOS DO CADASTRO
---------------------------------------------------------
IF @P_TIPO = 8106
BEGIN

   -- BUSCA TODOS OS REGISTROS DO CADASTRO
   SET @C_RAMOS_2 = CURSOR STATIC FOR
   SELECT X5_FILIAL, X5_TABELA, X5_CHAVE, X5_DESCRI, X5_DESCSPA, X5_DESCENG, D_E_L_E_T_, R_E_C_N_O_
     FROM INTEGRACAO_PROTHEUS_SX5
    WHERE X5_TABELA = 'T3' 
     OPEN @C_RAMOS_2
    FETCH NEXT FROM @C_RAMOS_2
     INTO @VX5_FILIAL, @VX5_TABELA, @VX5_CHAVE, @VX5_DESCRI, @VX5_DESCSPA, @VX5_DESCENG, @VD_E_L_E_T_, @VR_E_C_N_O_
    WHILE @@FETCH_STATUS = 0
   BEGIN

     EXEC [dbo].[MERCP_SX5010] 0, @VX5_FILIAL, @VX5_TABELA, @VX5_CHAVE, @VX5_DESCRI, @VX5_DESCSPA, @VX5_DESCENG, @VD_E_L_E_T_, @VR_E_C_N_O_

    FETCH NEXT FROM @C_RAMOS_2
     INTO @VX5_FILIAL, @VX5_TABELA, @VX5_CHAVE, @VX5_DESCRI, @VX5_DESCSPA, @VX5_DESCENG, @VD_E_L_E_T_, @VR_E_C_N_O_
   END

        CLOSE @C_RAMOS_2
   DEALLOCATE @C_RAMOS_2

END;
-----------------------------------------
--  FIM 8106 - RAMOS DE ATIVIDADES II
-----------------------------------------


    ---------------------------
    ---- 8107 - PORTADORES
    ----          ATUALIZA SEMPRE TODAS OS PORTADORES DO CADASTRO
    ---------------------------
    IF @P_TIPO = 8107
    BEGIN

        --- BUSCA TODOS OS REGISTROS DO CADASTRO
        SET @C_PORTADORES = CURSOR STATIC FOR
                
            SELECT A6_COD     , A6_AGENCIA , A6_DVAGE   , A6_NUMCON  , A6_DVCTA   , A6_NOME    , A6_FILIAL 
                FROM INTEGRACAO_PROTHEUS_SA6

        OPEN @C_PORTADORES
        FETCH NEXT FROM @C_PORTADORES
            INTO @VA6_COD     , @VA6_AGENCIA , @VA6_DVAGE   , @VA6_NUMCON  , @VA6_DVCTA   , @VA6_NOME    , @VA6_FILIAL 
        WHILE @@FETCH_STATUS = 0
        BEGIN

            EXEC [dbo].[MERCP_SA6010] 0, @VA6_COD     , @VA6_AGENCIA , @VA6_DVAGE   , @VA6_NUMCON  , @VA6_DVCTA   , @VA6_NOME    , @VA6_FILIAL 

        FETCH NEXT FROM @C_PORTADORES
            INTO @VA6_COD     , @VA6_AGENCIA , @VA6_DVAGE   , @VA6_NUMCON  , @VA6_DVCTA   , @VA6_NOME    , @VA6_FILIAL 
        END

        CLOSE @C_PORTADORES
        DEALLOCATE @C_PORTADORES
    END;
    ---------------------------
    ---- FIM 8107 - PORTADORES
    ---------------------------


    ---------------------------
    ---- 8110 - CLASSIFICACAO COMERCIAL CLIENTE
    ----          ATUALIZA SEMPRE TODAS AS CLASSIFICACOES DO CADASTRO
    ---------------------------
    IF @P_TIPO = 8110
    BEGIN

        --- BUSCA TODOS OS REGISTROS DO CADASTRO
        SET @C_CLASCOM = CURSOR STATIC FOR
                
            SELECT I.CC3_FILIAL, I.CC3_COD, I.CC3_DESC, I.D_E_L_E_T_, I.R_E_C_N_O_
                FROM INTEGRACAO_PROTHEUS_CC3 I

        OPEN @C_CIDADES
        FETCH NEXT FROM @C_CIDADES
            INTO @VCC3_FILIAL, @VCC3_COD, @VCC3_DESC, @VD_E_L_E_T_, @VR_E_C_N_O_
        WHILE @@FETCH_STATUS = 0
        BEGIN

            EXEC MERCP_CC3010 0, @VCC3_FILIAL, @VCC3_COD, @VCC3_DESC, @VD_E_L_E_T_, @VR_E_C_N_O_

        FETCH NEXT FROM @C_CIDADES
            INTO @VCC3_FILIAL, @VCC3_COD, @VCC3_DESC, @VD_E_L_E_T_, @VR_E_C_N_O_
        END

        CLOSE @C_CLASCOM
        DEALLOCATE @C_CLASCOM

    END;
    ---------------------------
    ---- FIM 8110 - CLASSIFICACAO COMERCIAL CLIENTE
    ---------------------------


----------------------------------------------
--  8111 - PROMOTORES
--         ATUALIZA SEMPRE TODO O CADASTRO
----------------------------------------------
IF @P_TIPO = 8111
BEGIN

   -- BUSCA TODOS OS REGISTROS DO CADASTRO
   SET @C_PROMOTORES = CURSOR STATIC FOR
   SELECT ZX5_FILIAL, ZX5_TABELA, ZX5_CHAVE, ZX5_DESCRI, ZX5_18COD, ZX5_18DESC, D_E_L_E_T_, R_E_C_N_O_,
          ZX5_39COD,  ZX5_39DESC, ZX5_40COD, ZX5_40DESC, ZX5_46COD, ZX5_46DESC
     FROM INTEGRACAO_PROTHEUS_ZX5
    WHERE ZX5_TABELA = '46'
     OPEN @C_PROMOTORES
    FETCH NEXT FROM @C_PROMOTORES
     INTO @VZX5_FILIAL, @VZX5_TABELA, @VZX5_CHAVE, @VZX5_DESCRI, @VZX5_18COD, @VZX5_18DESC, @VD_E_L_E_T_, @VR_E_C_N_O_,
          @VZX5_39COD,  @VZX5_39DESC, @VZX5_40COD, @VZX5_40DESC, @VZX5_46COD, @VZX5_46DESC
    WHILE @@FETCH_STATUS = 0
   BEGIN

     EXEC [dbo].[MERCP_ZX5010] 0, @VZX5_FILIAL, @VZX5_TABELA, @VZX5_CHAVE, @VZX5_DESCRI, @VZX5_18COD, @VZX5_18DESC, @VD_E_L_E_T_, @VR_E_C_N_O_,
                                  @VZX5_39COD,  @VZX5_39DESC, @VZX5_40COD, @VZX5_40DESC, @VZX5_46COD, @VZX5_46DESC

    FETCH NEXT FROM @C_PROMOTORES
     INTO @VZX5_FILIAL, @VZX5_TABELA, @VZX5_CHAVE, @VZX5_DESCRI, @VZX5_18COD, @VZX5_18DESC, @VD_E_L_E_T_, @VR_E_C_N_O_,
          @VZX5_39COD,  @VZX5_39DESC, @VZX5_40COD, @VZX5_40DESC, @VZX5_46COD, @VZX5_46DESC
   END

        CLOSE @C_PROMOTORES
   DEALLOCATE @C_PROMOTORES

END;
----------------------------
--  FIM 8111 - PROMOTORES
----------------------------


    --------------------------------------------
    --- PASSO 2 - PARA AS INTEGRACOES QUE UTILIZAM LOG, BUSCA TODOS OS REGISTROS NAO PROCESSADOS NA TABELA DE INTERFACE
    --------------------------------------------
    ELSE
    BEGIN
    
        SET @C_INTERFACE = CURSOR STATIC FOR
                SELECT DISTINCT R_E_C_N_O_
                    FROM DB_INTERFACE_PROTHEUS
                    WHERE TIPO  = @P_TIPO
                    AND STATUS  = 'INS'
          OPEN @C_INTERFACE
         FETCH NEXT FROM @C_INTERFACE
          INTO @VR_E_C_N_O_CURSOR
         WHILE @@FETCH_STATUS = 0
         BEGIN

           ---------------------------
           ---- 20 - CLIENTES
           ---------------------------
           IF @P_TIPO = 20
           BEGIN
              SELECT @VA1_FILIAL  = A1_FILIAL,  @VA1_COD     = A1_COD,      @VA1_LOJA    = A1_LOJA,    @VA1_NOME    = A1_NOME,    @VA1_PESSOA  = A1_PESSOA,
                     @VA1_CGC     = A1_CGC,     @VA1_END     = A1_END,      @VA1_BAIRRO  = A1_BAIRRO,  @VA1_INSCR   = A1_INSCR,   @VA1_MUN     = A1_MUN,
                     @VA1_EST     = A1_EST,     @VA1_CEP     = A1_CEP,      @VA1_CONTATO = A1_CONTATO, @VA1_DDI     = A1_DDI,     @VA1_TEL     = A1_TEL,
                     @VA1_ULTCOM  = A1_ULTCOM,  @VA1_NREDUZ  = A1_NREDUZ,   @VA1_ENDCOB  = A1_ENDCOB,  @VA1_BAIRROC = A1_BAIRROC, @VA1_MUNC    = A1_MUNC,
                     @VA1_ESTC    = A1_ESTC,    @VA1_CEPC    = A1_CEPC,     @VA1_FAX     = A1_FAX,     @VA1_TIPO    = A1_TIPO,    @VA1_NATUREZ = A1_NATUREZ,
                     @VA1_CONTA   = A1_CONTA,   @VA1_RISCO   = A1_RISCO,    @VA1_ATIVIDA = A1_ATIVIDA, @VA1_TELEX   = A1_TELEX,   @VA1_ENDENT  = A1_ENDENT,
                     @VA1_ENDREC  = A1_ENDREC,  @VA1_RECINSS = A1_RECINSS,  @VA1_INSCRM  = A1_INSCRM,  @VA1_COMIS   = A1_COMIS,   @VA1_REGIAO  = A1_REGIAO,
                     @VA1_BCO1    = A1_BCO1,    @VA1_BCO2    = A1_BCO2,     @VA1_BCO3    = A1_BCO3,    @VA1_BCO4    = A1_BCO4,    @VA1_BCO5    = A1_BCO5,
                     @VA1_TRANSP  = A1_TRANSP,  @VA1_TPFRET  = A1_TPFRET,   @VA1_COND    = A1_COND,    @VA1_CLASSE  = A1_CLASSE,  @VA1_DESC    = A1_DESC,
                     @VA1_PRIOR   = A1_PRIOR,   @VA1_LC      = A1_LC,       @VA1_VENCLC  = A1_VENCLC,  @VA1_MCOMPRA = A1_MCOMPRA, @VA1_METR    = A1_METR,
                     @VA1_MSALDO  = A1_MSALDO,  @VA1_NROCOM  = A1_NROCOM,   @VA1_PRICOM  = A1_PRICOM,  @VA1_TEMVIS  = A1_TEMVIS,  @VA1_ULTVIS  = A1_ULTVIS,
                     @VA1_MENSAGE = A1_MENSAGE, @VA1_NROPAG  = A1_NROPAG,   @VA1_SALDUP  = A1_SALDUP,  @VA1_SALPEDL = A1_SALPEDL, @VA1_SUFRAMA = A1_SUFRAMA,
                     @VA1_TRANSF  = A1_TRANSF,  @VA1_ATR     = A1_ATR,      @VA1_VACUM   = A1_VACUM,   @VA1_SALPED  = A1_SALPED,  @VA1_TITPROT = A1_TITPROT,
                     @VA1_DTULTIT = A1_DTULTIT, @VA1_CHQDEVO = A1_CHQDEVO,  @VA1_DTULCHQ = A1_DTULCHQ, @VA1_MATR    = A1_MATR,    @VA1_MAIDUPL = A1_MAIDUPL,
                     @VA1_TABELA  = A1_TABELA,  @VA1_INCISS  = A1_INCISS,   @VA1_AGREG   = A1_AGREG,   @VA1_SALDUPM = A1_SALDUPM, @VA1_PAGATR  = A1_PAGATR,
                     @VA1_CARGO1  = A1_CARGO1,  @VA1_CARGO2  = A1_CARGO2,   @VA1_CARGO3  = A1_CARGO3,  @VA1_SUPER   = A1_SUPER,   @VA1_RTEC    = A1_RTEC,
                     @VA1_ALIQIR  = A1_ALIQIR,  @VA1_OBSERV  = A1_OBSERV,   @VA1_CALCSUF = A1_CALCSUF, @VA1_RG      = A1_RG,      @VA1_DTNASC  = A1_DTNASC,
                     @VA1_SALPEDB = A1_SALPEDB, @VA1_CLIFAT  = A1_CLIFAT,   @VA1_GRPTRIB = A1_GRPTRIB, @VA1_BAIRROE = A1_BAIRROE, @VA1_CEPE    = A1_CEPE,
                     @VA1_MUNE    = A1_MUNE,    @VA1_ESTE    = A1_ESTE,     @VA1_SATIV1  = A1_SATIV1,  @VA1_SATIV2  = A1_SATIV2,  @VA1_SATIV3  = A1_SATIV3,
                     @VA1_SATIV4  = A1_SATIV4,  @VA1_SATIV5  = A1_SATIV5,   @VA1_SATIV6  = A1_SATIV6,  @VA1_CODMUN  = A1_CODMUN,  @VA1_SATIV7  = A1_SATIV7,
                     @VA1_SATIV8  = A1_SATIV8,  @VA1_CODHIST =  A1_CODHIST, @VA1_PAIS    = A1_PAIS,    @VA1_EMAIL   = A1_EMAIL,   @VA1_HPAGE   = A1_HPAGE,
                     @VA1_OBS     = A1_OBS,     @VA1_CODMARC = A1_CODMARC,  @VA1_TMPSTD  = A1_TMPSTD,  @VA1_COMAGE  = A1_COMAGE,  @VA1_DEST_3  = A1_DEST_3,
                     @VA1_ESTADO  = A1_ESTADO,  @VA1_CXPOSTA = A1_CXPOSTA,  @VA1_DEST_2  = A1_DEST_2,  @VA1_CODAGE  = A1_CODAGE,  @VA1_TIPCLI  = A1_TIPCLI,
                     @VA1_CONDPAG = A1_CONDPAG, @VA1_DEST_1  = A1_DEST_1,   @VA1_DIASPAG = A1_DIASPAG, @VA1_CLASVEN = A1_CLASVEN, @VA1_FORMVIS = A1_FORMVIS,
                     @VA1_RECCOFI = A1_RECCOFI, @VA1_RECCSLL = A1_RECCSLL,  @VA1_RECPIS  = A1_RECPIS,  @VA1_TMPVIS  = A1_TMPVIS,  @VA1_PFISICA = A1_PFISICA,
                     @VA1_LCFIN   = A1_LCFIN,   @VA1_MOEDALC = A1_MOEDALC,  @VA1_RECISS  = A1_RECISS,  @VA1_DDD     = A1_DDD,     @VA1_TIPPER  = A1_TIPPER,
                     @VA1_COD_MUN = A1_COD_MUN, @VA1_SALFIN  = A1_SALFIN,   @VA1_SALFINM = A1_SALFINM, @VA1_B2B     = A1_B2B,     @VA1_GRPVEN  = A1_GRPVEN,
                     @VA1_VEND    = A1_VEND,    @VA1_CLICNV  = A1_CLICNV,   @VA1_SITUA   = A1_SITUA,   @VA1_TPESSOA = A1_TPESSOA, @VA1_ABATIMP = A1_ABATIMP,
                     @VA1_TPISSRS = A1_TPISSRS, @VA1_CTARE   = A1_CTARE,    @VA1_RECFET  = A1_RECFET,  @VD_E_L_E_T_ = D_E_L_E_T_, @VR_E_C_N_O_ = R_E_C_N_O_,
                     @VA1_MSBLQL  = A1_MSBLQL,  @VA1_VACANAL = A1_VACANAL,  @VA1_SIMPNAC = A1_SIMPNAC, @VA1_OBSALI  = A1_OBSALI,  @VA1_CNAE    = A1_CNAE,
                     @VA1_VAREGE  = A1_VAREGE,  @VA1_VAOC    = A1_VAOC,     @VA1_VAPROMO = A1_VAPROMO, @VA1_CONTAT3 = A1_CONTAT3, @VA1_TELCOB  = A1_TELCOB,
					 @VA1_VAEMLF  = A1_VAEMLF, @VA1_VABCOF   = A1_VABCOF,   @VA1_VAAGFIN = A1_VAAGFIN, @VA1_VACTAFN = A1_VACTAFN, @VA1_VACGCFI = A1_VACGCFI,
					 @VA1_VEND2   = A1_VEND2,  @VA1_TABELA2  = A1_TABELA2 
														   
               FROM INTEGRACAO_PROTHEUS_SA1
               WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

              EXEC [dbo].[MERCP_SA1010] 0, @VA1_FILIAL,  @VA1_COD,     @VA1_LOJA,    @VA1_NOME,    @VA1_PESSOA,  @VA1_CGC,     @VA1_END,     @VA1_BAIRRO,  @VA1_INSCR,
                                           @VA1_MUN,     @VA1_EST,     @VA1_CEP,     @VA1_CONTATO, @VA1_DDI,     @VA1_TEL,     @VA1_ULTCOM,  @VA1_NREDUZ,  @VA1_ENDCOB,  @VA1_BAIRROC,
                                           @VA1_MUNC,    @VA1_ESTC,    @VA1_CEPC,    @VA1_FAX,     @VA1_TIPO,    @VA1_NATUREZ, @VA1_CONTA,   @VA1_RISCO,   @VA1_ATIVIDA, @VA1_TELEX,
                                           @VA1_ENDENT,  @VA1_ENDREC,  @VA1_RECINSS, @VA1_INSCRM,  @VA1_COMIS,   @VA1_REGIAO,  @VA1_BCO1,    @VA1_BCO2,    @VA1_BCO3,    @VA1_BCO4,
                                           @VA1_BCO5,    @VA1_TRANSP,  @VA1_TPFRET,  @VA1_COND,    @VA1_CLASSE,  @VA1_DESC,    @VA1_PRIOR,   @VA1_LC,      @VA1_VENCLC,  @VA1_MCOMPRA,
                                           @VA1_METR,    @VA1_MSALDO,  @VA1_NROCOM,  @VA1_PRICOM,  @VA1_TEMVIS,  @VA1_ULTVIS,  @VA1_MENSAGE, @VA1_NROPAG,  @VA1_SALDUP,  @VA1_SALPEDL,
                                           @VA1_SUFRAMA, @VA1_TRANSF,  @VA1_ATR,     @VA1_VACUM,   @VA1_SALPED,  @VA1_TITPROT, @VA1_DTULTIT, @VA1_CHQDEVO, @VA1_DTULCHQ, @VA1_MATR,
                                           @VA1_MAIDUPL, @VA1_TABELA,  @VA1_INCISS,  @VA1_AGREG,   @VA1_SALDUPM, @VA1_PAGATR,  @VA1_CARGO1,  @VA1_CARGO2,  @VA1_CARGO3,  @VA1_SUPER,
                                           @VA1_RTEC,    @VA1_ALIQIR,  @VA1_OBSERV,  @VA1_CALCSUF, @VA1_RG,      @VA1_DTNASC,  @VA1_SALPEDB, @VA1_CLIFAT,  @VA1_GRPTRIB, @VA1_BAIRROE,
                                           @VA1_CEPE,    @VA1_MUNE,    @VA1_ESTE,    @VA1_SATIV1,  @VA1_SATIV2,  @VA1_SATIV3,  @VA1_SATIV4,  @VA1_SATIV5,  @VA1_SATIV6,  @VA1_CODMUN,
                                           @VA1_SATIV7,  @VA1_SATIV8,  @VA1_CODHIST, @VA1_PAIS,    @VA1_EMAIL,   @VA1_HPAGE,   @VA1_OBS,     @VA1_CODMARC, @VA1_TMPSTD,  @VA1_COMAGE,
                                           @VA1_DEST_3,  @VA1_ESTADO,  @VA1_CXPOSTA, @VA1_DEST_2,  @VA1_CODAGE,  @VA1_TIPCLI,  @VA1_CONDPAG, @VA1_DEST_1,  @VA1_DIASPAG, @VA1_CLASVEN,
                                           @VA1_FORMVIS, @VA1_RECCOFI, @VA1_RECCSLL, @VA1_RECPIS,  @VA1_TMPVIS,  @VA1_PFISICA, @VA1_LCFIN,   @VA1_MOEDALC, @VA1_RECISS,  @VA1_DDD,
                                           @VA1_TIPPER,  @VA1_COD_MUN, @VA1_SALFIN,  @VA1_SALFINM, @VA1_B2B,     @VA1_GRPVEN,  @VA1_VEND,    @VA1_CLICNV,  @VA1_SITUA,   @VA1_TPESSOA,
                                           @VA1_ABATIMP, @VA1_TPISSRS, @VA1_CTARE,   @VA1_RECFET,  @VD_E_L_E_T_, @VR_E_C_N_O_, @VA1_MSBLQL,  @VA1_VACANAL, @VA1_SIMPNAC, @VA1_OBSALI,
                                           @VA1_CNAE,    @VA1_VAREGE,  @VA1_VAOC,    @VA1_VAPROMO, @VA1_CONTAT3, @VA1_TELCOB,  @VA1_VAEMLF,  @VA1_VABCOF,  @VA1_VAAGFIN, @VA1_VACTAFN,
										   @VA1_VACGCFI, @VA1_VEND2,   @VA1_TABELA2


            END;
           ---------------------------
           ---- FIM 20 - CLIENTES
           ---------------------------


           ---------------------------
           ---- 8005 - REPRESENTANTES
           ---------------------------
           IF @P_TIPO = 8005
           BEGIN
               SELECT @VA3_FILIAL  = A3_FILIAL,  @VA3_COD     = A3_COD,     @VA3_NOME    = A3_NOME,    @VA3_NREDUZ  = A3_NREDUZ,  @VA3_END       = A3_END,
                      @VA3_BAIRRO  = A3_BAIRRO,  @VA3_MUN     = A3_MUN,     @VA3_EST     = A3_EST,     @VA3_CEP     = A3_CEP,     @VA3_FORNECE   = A3_FORNECE,
                      @VA3_LOJA    = A3_LOJA,    @VA3_GERASE2 = A3_GERASE2, @VA3_BCO1    = A3_BCO1,    @VA3_REGIAO  = A3_REGIAO,  @VA3_CGC       = A3_CGC,
                      @VA3_COMIS   = A3_COMIS,   @VA3_FAX     = A3_FAX,     @VA3_TEL     = A3_TEL,     @VA3_TELEX   = A3_TELEX,   @VA3_INSCRM    = A3_INSCRM,
                      @VA3_INSCR   = A3_INSCR,   @VA3_FRETE   = A3_FRETE,   @VA3_ICM     = A3_ICM,     @VA3_IPI     = A3_IPI,     @VA3_ICMSRET   = A3_ICMSRET,
                      @VA3_ACREFIN = A3_ACREFIN, @VA3_ALBAIXA = A3_ALBAIXA, @VA3_ALEMISS = A3_ALEMISS, @VA3_TIPO    = A3_TIPO,    @VA3_GEREN     = A3_GEREN,
                      @VA3_SUPER   = A3_SUPER,   @VA3_PERDESC = A3_PERDESC, @VA3_DIARESE = A3_DIARESE, @VA3_EMAIL   = A3_EMAIL,   @VA3_HPAGE     = A3_HPAGE,
                      @VA3_DIA     = A3_DIA,     @VA3_DDD     = A3_DDD,     @VA3_CLIFIM  = A3_CLIFIM,  @VA3_CLIINI  = A3_CLIINI,  @VA3_CODUSR    = A3_CODUSR,
                      @VA3_PEDFIM  = A3_PEDFIM,  @VA3_PEDINI  = A3_PEDINI,  @VA3_PROXCLI = A3_PROXCLI, @VA3_PROXPED = A3_PROXPED, @VA3_SENHA     = A3_SENHA,
                      @VA3_GRPREP  = A3_GRPREP,  @VA3_ISS     = A3_ISS,     @VA3_FAT_RH  = A3_FAT_RH,  @VA3_GRUPSAN = A3_GRUPSAN, @VA3_DEPEND    = A3_DEPEND,
                      @VA3_PEN_ALI = A3_PEN_ALI, @VA3_TIPVEND = A3_TIPVEND, @VD_E_L_E_T_ = D_E_L_E_T_, @VR_E_C_N_O_ = R_E_C_N_O_, @VR_E_C_D_E_L_ = R_E_C_D_E_L_,
                      @VA3_DDDTEL  = A3_DDDTEL,  @VA3_NUMRA   = A3_NUMRA,   @VA3_ATIVO   = A3_ATIVO
                 FROM INTEGRACAO_PROTHEUS_SA3
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [dbo].[MERCP_SA3010] 0, @VA3_FILIAL, @VA3_COD,     @VA3_NOME,   @VA3_NREDUZ, @VA3_END,    @VA3_BAIRRO, @VA3_MUN,    @VA3_EST,    
                               @VA3_CEP,    @VA3_FORNECE,@VA3_LOJA,    @VA3_GERASE2,@VA3_BCO1,   @VA3_REGIAO, @VA3_CGC,    @VA3_COMIS,  @VA3_FAX,    
                               @VA3_TEL,    @VA3_TELEX,  @VA3_INSCRM,  @VA3_INSCR,  @VA3_FRETE,  @VA3_ICM,    @VA3_IPI,    @VA3_ICMSRET,@VA3_ACREFIN,
                               @VA3_ALBAIXA,@VA3_ALEMISS,@VA3_TIPO,    @VA3_GEREN,  @VA3_SUPER,  @VA3_PERDESC,@VA3_DIARESE,@VA3_EMAIL,  @VA3_HPAGE,  
                               @VA3_DIA,    @VA3_DDD,    @VA3_CLIFIM,  @VA3_CLIINI, @VA3_CODUSR, @VA3_PEDFIM, @VA3_PEDINI, @VA3_PROXCLI,@VA3_PROXPED,
                               @VA3_SENHA,  @VA3_GRPREP, @VA3_ISS,     @VA3_FAT_RH, @VA3_GRUPSAN,@VA3_DEPEND, @VA3_PEN_ALI,@VA3_TIPVEND,@VD_E_L_E_T_,
                               @VR_E_C_N_O_,@VR_E_C_D_E_L_,@VA3_DDDTEL,@VA3_NUMRA,  @VA3_ATIVO    

            END;
           ---------------------------
           ---- FIM 8005 - REPRESENTANTES
           ---------------------------



           ---------------------------
           ---- 40 - PRODUTOS
           ---------------------------
           IF @P_TIPO = 40
           BEGIN

              SELECT @VB1_FILIAL    = B1_FILIAL,    @VB1_COD     = B1_COD,     @VB1_DESC    = B1_DESC,    @VB1_TIPO    = B1_TIPO,    @VB1_UM      = B1_UM,
                     @VB1_LOCPAD    = B1_LOCPAD,    @VB1_GRUPO   = B1_GRUPO,   @VB1_TAB_IPI = B1_TAB_IPI, @VB1_ORIGEM  = B1_ORIGEM,  @VB1_CLASFIS = B1_CLASFIS,
                     @VB1_CONTA     = B1_CONTA,     @VB1_CC      = B1_CC,      @VB1_TE      = B1_TE,      @VB1_TS      = B1_TS,      @VB1_PROC    = B1_PROC,
                     @VB1_IPI       = B1_IPI,       @VB1_PICM    = B1_PICM,    @VB1_LE      = B1_LE,      @VB1_LM      = B1_LM,      @VB1_IRRF    = B1_IRRF,
                     @VB1_POSIPI    = B1_POSIPI,    @VB1_EX_NCM  = B1_EX_NCM,  @VB1_EX_NBM  = B1_EX_NBM,  @VB1_ALIQISS = B1_ALIQISS, @VB1_CODISS  = B1_CODISS,
                     @VB1_PICMRET   = B1_PICMRET,   @VB1_PICMENT = B1_PICMENT, @VB1_IMPZFRC = B1_IMPZFRC, @VB1_BITMAP  = B1_BITMAP,  @VB1_SEGUM   = B1_SEGUM,
                     @VB1_CONV      = B1_CONV,      @VB1_TIPCONV = B1_TIPCONV, @VB1_ALTER   = B1_ALTER,   @VB1_INSS    = B1_INSS,    @VB1_QE      = B1_QE,
                     @VB1_PRV1      = B1_PRV1,      @VB1_EMIN    = B1_EMIN,    @VB1_CUSTD   = B1_CUSTD,   @VB1_UPRC    = B1_UPRC,    @VB1_UCOM    = B1_UCOM,
                     @VB1_PESO      = B1_PESO,      @VB1_ESTSEG  = B1_ESTSEG,  @VB1_ESTFOR  = B1_ESTFOR,  @VB1_FORPRZ  = B1_FORPRZ,  @VB1_PE      = B1_PE,
                     @VB1_TIPE      = B1_TIPE,      @VB1_TOLER   = B1_TOLER,   @VB1_FAMILIA = B1_FAMILIA, @VB1_LOJPROC = B1_LOJPROC, @VB1_QB      = B1_QB,
                     @VB1_APROPRI   = B1_APROPRI,   @VB1_FANTASM = B1_FANTASM, @VB1_TIPODEC = B1_TIPODEC, @VB1_DATREF  = B1_DATREF,  @VB1_RASTRO  = B1_RASTRO,
                     @VB1_UREV      = B1_UREV,      @VB1_FORAEST = B1_FORAEST, @VB1_COMIS   = B1_COMIS,   @VB1_MONO    = B1_MONO,    @VB1_MRP     = B1_MRP,
                     @VB1_PERINV    = B1_PERINV,    @VB1_DTREFP1 = B1_DTREFP1, @VB1_GRTRIB  = B1_GRTRIB,  @VB1_NOTAMIN = B1_NOTAMIN, @VB1_PRVALID = B1_PRVALID,
                     @VB1_NUMCOP    = B1_NUMCOP,    @VB1_CONTSOC = B1_CONTSOC, @VB1_CONINI  = B1_CONINI,  @VB1_CODBAR  = B1_CODBAR,  @VB1_GRADE   = B1_GRADE,
                     @VB1_FORMLOT   = B1_FORMLOT,   @VB1_LOCALIZ = B1_LOCALIZ, @VB1_OPERPAD = B1_OPERPAD, @VB1_CONTRAT = B1_CONTRAT, @VB1_DESC_P  = B1_DESC_P,
                     @VB1_FPCOD     = B1_FPCOD,     @VB1_DESC_I  = B1_DESC_I,  @VB1_VLREFUS = B1_VLREFUS, @VB1_DESC_GI = B1_DESC_GI, @VB1_IMPORT  = B1_IMPORT,
                     @VB1_ANUENTE   = B1_ANUENTE,   @VB1_OPC     = B1_OPC,     @VB1_CODOBS  = B1_CODOBS,  @VB1_FABRIC  = B1_FABRIC,  @VB1_SITPROD = B1_SITPROD,
                     @VB1_MODELO    = B1_MODELO,    @VB1_SETOR   = B1_SETOR,   @VB1_BALANCA = B1_BALANCA, @VB1_TECLA   = B1_TECLA,   @VB1_PRODPAI = B1_PRODPAI,
                     @VB1_CODEMB    = B1_CODEMB,    @VB1_SOLICIT = B1_SOLICIT, @VB1_GRUPCOM = B1_GRUPCOM, @VB1_ALADI   = B1_ALADI,   @VB1_CONTCQP = B1_CONTCQP,
                     @VB1_REVATU    = B1_REVATU,    @VB1_ESPECIF = B1_ESPECIF, @VB1_NALNCCA = B1_NALNCCA, @VB1_NUMCQPR = B1_NUMCQPR, @VB1_NALSH   = B1_NALSH,
                     @VB1_MAT_PRI   = B1_MAT_PRI,   @VB1_TIPOCQ  = B1_TIPOCQ,  @VB1_MIDIA   = B1_MIDIA,   @VB1_VLR_IPI = B1_VLR_IPI, @VB1_QTMIDIA = B1_QTMIDIA,
                     @VB1_PIS       = B1_PIS,       @VB1_PPIS    = B1_PPIS,    @VB1_COFINS  = B1_COFINS,  @VB1_PCOFINS = B1_PCOFINS, @VB1_CSLL    = B1_CSLL,
                     @VB1_PCSLL     = B1_PCSLL,     @VB1_REDPIS  = B1_REDPIS,  @VB1_CODITE  = B1_CODITE,  @VB1_DATASUB = B1_DATASUB, @VB1_REDCOF  = B1_REDCOF,
                     @VB1_ESPECIE   = B1_ESPECIE,   @VB1_CLASSVE = B1_CLASSVE, @VB1_ENVOBR  = B1_ENVOBR,  @VB1_FLAGSUG = B1_FLAGSUG, @VB1_GRUDES  = B1_GRUDES,
                     @VB1_ITEMCC    = B1_ITEMCC,    @VB1_MCUSTD  = B1_MCUSTD,  @VB1_MTBF    = B1_MTBF,    @VB1_MTTR    = B1_MTTR,    @VB1_REDINSS = B1_REDINSS,
                     @VB1_REDIRRF   = B1_REDIRRF,   @VB1_QTDSER  = B1_QTDSER,  @VB1_SERIE   = B1_SERIE,   @VB1_FAIXAS  = B1_FAIXAS,  @VB1_NROPAG  = B1_NROPAG,
                     @VB1_ISBN      = B1_ISBN,      @VB1_TITORIG = B1_TITORIG, @VB1_LINGUA  = B1_LINGUA,  @VB1_EDICAO  = B1_EDICAO,  @VB1_OBSISBN = B1_OBSISBN,
                     @VB1_CLVL      = B1_CLVL,      @VB1_ATIVO   = B1_ATIVO,   @VB1_PESBRU  = B1_PESBRU,  @VB1_TIPCAR  = B1_TIPCAR,  @VB1_VLR_ICM = B1_VLR_ICM,
                     @VB1_CORPRI    = B1_CORPRI,    @VB1_CORSEC  = B1_CORSEC,  @VB1_NICONE  = B1_NICONE,  @VB1_ATRIB1  = B1_ATRIB1,  @VB1_ATRIB2  = B1_ATRIB2,
                     @VB1_ATRIB3    = B1_ATRIB3,    @VB1_REGSEQ  = B1_REGSEQ,  @VB1_VLRSELO = B1_VLRSELO, @VB1_CODNOR  = B1_CODNOR,  @VB1_UCALSTD = B1_UCALSTD,
                     @VB1_CPOTENC   = B1_CPOTENC,   @VB1_POTENCI = B1_POTENCI, @VB1_REQUIS  = B1_REQUIS,  @VB1_QTDACUM = B1_QTDACUM, @VB1_QTDINIC = B1_QTDINIC,
--Robert 26/07/19    @VB1_CNAE      = B1_CNAE,      @VB1_FRETISS = B1_FRETISS, @VB1_CALCFET = B1_CALCFET, @VD_E_L_E_T_ = D_E_L_E_T_, @VR_E_C_N_O_ = R_E_C_N_O_,
                     @VB1_CNAE      = B1_CNAE,      @VB1_FRETISS = B1_FRETISS, @VB1_CALCFET = B1_CALCFET, @VD_E_L_E_T_ = SB1.D_E_L_E_T_, @VR_E_C_N_O_ = SB1.R_E_C_N_O_,
--Robert 26/07/19    @VR_E_C_D_E_L_ = R_E_C_D_E_L_, @VB1_MSBLQL  = B1_MSBLQL,  @VB1_AGREGCU = B1_AGREGCU, @VB1_QUADPRO = B1_QUADPRO, @VB1_EMAX    = B1_EMAX,
                     @VR_E_C_D_E_L_ = SB1.R_E_C_D_E_L_, @VB1_MSBLQL  = B1_MSBLQL,  @VB1_AGREGCU = B1_AGREGCU, @VB1_QUADPRO = B1_QUADPRO, @VB1_EMAX    = B1_EMAX,
                     @VB1_FRACPER   = B1_FRACPER,   @VB1_INT_ICM = B1_INT_ICM, @VB1_SELO    = B1_SELO,    @VB1_LOTVEN  = B1_LOTVEN,  @VB1_OK      = B1_OK,
                     @VB1_USAFEFO   = B1_USAFEFO,   @VB1_UMOEC   = B1_UMOEC,   @VB1_UVLRC   = B1_UVLRC,   @VB1_GCCUSTO = B1_GCCUSTO, @VB1_CCCUSTO = B1_CCCUSTO,
                     @VB1_CLASSE    = B1_CLASSE,    @VB1_PAUTFET = B1_PAUTFET, @VB1_RETOPER = B1_RETOPER, @VB1_CRDEST  = B1_CRDEST,  @VB1_LITROS  = B1_LITROS,
--Robert 26/07/19    @VB1_VAMARCM   = B1_VAMARCM,   @VB1_CLINF   = B1_CLINF,   @VB1_CODLIN  = B1_CODLIN,  @VB1_VAEANUN = B1_VAEANUN, @VB1_VADUNCX = B1_VADUNCX,
                     @VB1_VAMARCM   = B1_VAMARCM,   @VB1_CLINF   = B1_CLINF,   @VB1_CODLIN  = B1_CODLIN,  @VB1_VAEANUN = B5_2CODBAR, @VB1_VADUNCX = B1_CODBAR,
                     --@VB1_P_BRT     = B1_PESBRU,     @VB1_VAPLLAS = B1_VAPLLAS, @VB1_VAPLCAM = B1_VAPLCAM,
					 @VB1_VAPLLAS = B1_VAPLLAS, @VB1_VAPLCAM = B1_VAPLCAM,
--Andre 28/04/20     
					 @VB1_QTDEMB    = B1_QTDEMB
                FROM INTEGRACAO_PROTHEUS_SB1 SB1, INTEGRACAO_PROTHEUS_SB5 SB5
														  
																								   
               WHERE SB1.R_E_C_N_O_ = @VR_E_C_N_O_CURSOR
			     AND SB5.B5_FILIAL = SB1.B1_FILIAL AND SB5.B5_COD = SB1.B1_COD


              EXEC [dbo].[MERCP_SB1010] 0, @VB1_FILIAL,  @VB1_COD,     @VB1_DESC,    @VB1_TIPO,    @VB1_UM,      @VB1_LOCPAD,  @VB1_GRUPO,   @VB1_TAB_IPI,
                                           @VB1_ORIGEM,  @VB1_CLASFIS, @VB1_CONTA,   @VB1_CC,      @VB1_TE,      @VB1_TS,      @VB1_PROC,    @VB1_IPI,     @VB1_PICM,
                                           @VB1_LE,      @VB1_LM,      @VB1_IRRF,    @VB1_POSIPI,  @VB1_EX_NCM,  @VB1_EX_NBM,  @VB1_ALIQISS, @VB1_CODISS,  @VB1_PICMRET,
                                           @VB1_PICMENT, @VB1_IMPZFRC, @VB1_BITMAP,  @VB1_SEGUM,   @VB1_CONV,    @VB1_TIPCONV, @VB1_ALTER,   @VB1_INSS,    @VB1_QE,
                                           @VB1_PRV1,    @VB1_EMIN,    @VB1_CUSTD,   @VB1_UPRC,    @VB1_UCOM,    @VB1_PESO,    @VB1_ESTSEG,  @VB1_ESTFOR,  @VB1_FORPRZ,
                                           @VB1_PE,      @VB1_TIPE,    @VB1_TOLER,   @VB1_FAMILIA, @VB1_LOJPROC, @VB1_QB,      @VB1_APROPRI, @VB1_FANTASM, @VB1_TIPODEC,
                                           @VB1_DATREF,  @VB1_RASTRO,  @VB1_UREV,    @VB1_FORAEST, @VB1_COMIS,   @VB1_MONO,    @VB1_MRP,     @VB1_PERINV,  @VB1_DTREFP1,
                                           @VB1_GRTRIB,  @VB1_NOTAMIN, @VB1_PRVALID, @VB1_NUMCOP,  @VB1_CONTSOC, @VB1_CONINI,  @VB1_CODBAR,  @VB1_GRADE,   @VB1_FORMLOT,
                                           @VB1_LOCALIZ, @VB1_OPERPAD, @VB1_CONTRAT, @VB1_DESC_P,  @VB1_FPCOD,   @VB1_DESC_I,  @VB1_VLREFUS, @VB1_DESC_GI, @VB1_IMPORT,
                                           @VB1_ANUENTE, @VB1_OPC,     @VB1_CODOBS,  @VB1_FABRIC,  @VB1_SITPROD, @VB1_MODELO,  @VB1_SETOR,   @VB1_BALANCA, @VB1_TECLA,
                                           @VB1_PRODPAI, @VB1_CODEMB,  @VB1_SOLICIT, @VB1_GRUPCOM, @VB1_ALADI,   @VB1_CONTCQP, @VB1_REVATU,  @VB1_ESPECIF, @VB1_NALNCCA,
                                           @VB1_NUMCQPR, @VB1_NALSH,   @VB1_MAT_PRI, @VB1_TIPOCQ,  @VB1_MIDIA,   @VB1_VLR_IPI, @VB1_QTMIDIA, @VB1_PIS,     @VB1_PPIS,
                                           @VB1_COFINS,  @VB1_PCOFINS, @VB1_CSLL,    @VB1_PCSLL,   @VB1_REDPIS,  @VB1_CODITE,  @VB1_DATASUB, @VB1_REDCOF,  @VB1_ESPECIE,
                                           @VB1_CLASSVE, @VB1_ENVOBR,  @VB1_FLAGSUG, @VB1_GRUDES,  @VB1_ITEMCC,  @VB1_MCUSTD,  @VB1_MTBF,    @VB1_MTTR,    @VB1_REDINSS,
                                           @VB1_REDIRRF, @VB1_QTDSER,  @VB1_SERIE,   @VB1_FAIXAS,  @VB1_NROPAG,  @VB1_ISBN,    @VB1_TITORIG, @VB1_LINGUA,  @VB1_EDICAO,
                                           @VB1_OBSISBN, @VB1_CLVL,    @VB1_ATIVO,   @VB1_PESBRU,  @VB1_TIPCAR,  @VB1_VLR_ICM, @VB1_CORPRI,  @VB1_CORSEC,  @VB1_NICONE,
                                           @VB1_ATRIB1,  @VB1_ATRIB2,  @VB1_ATRIB3,  @VB1_REGSEQ,  @VB1_VLRSELO, @VB1_CODNOR,  @VB1_UCALSTD, @VB1_CPOTENC, @VB1_POTENCI,
                                           @VB1_REQUIS,  @VB1_QTDACUM, @VB1_QTDINIC, @VB1_CNAE,    @VB1_FRETISS, @VB1_CALCFET, @VD_E_L_E_T_, @VR_E_C_N_O_, @VR_E_C_D_E_L_,
                                           @VB1_MSBLQL,  @VB1_AGREGCU, @VB1_QUADPRO, @VB1_EMAX,    @VB1_FRACPER, @VB1_INT_ICM, @VB1_SELO,    @VB1_LOTVEN,  @VB1_OK,     
                                           @VB1_USAFEFO, @VB1_UMOEC,   @VB1_UVLRC,   @VB1_GCCUSTO, @VB1_CCCUSTO, @VB1_CLASSE,  @VB1_PAUTFET, @VB1_RETOPER, @VB1_CRDEST,
                                           --@VB1_LITROS,  @VB1_VAMARCM, @VB1_CLINF,   @VB1_CODLIN,  @VB1_VAEANUN, @VB1_VADUNCX, @VB1_P_BRT,   @VB1_VAPLLAS, @VB1_VAPLCAM,
										   @VB1_LITROS,  @VB1_VAMARCM, @VB1_CLINF,   @VB1_CODLIN,  @VB1_VAEANUN, @VB1_VADUNCX,  @VB1_VAPLLAS, @VB1_VAPLCAM,
										   @VB1_QTDEMB
           END;
           ---------------------------
           ---- FIM 40 - PRODUTOS
           ---------------------------


           ---------------------------
           ---- 8012 - CONDICAO PAGAMENTO
           ---------------------------
           IF @P_TIPO = 8012
           BEGIN

               SELECT @VE4_FILIAL = E4_FILIAL, @VE4_CODIGO = E4_CODIGO, @VE4_TIPO   = E4_TIPO,    @VE4_COND    = E4_COND,   @VE4_DESCRI = E4_DESCRI,
                      @VE4_IPI    = E4_IPI,    @VE4_DDD    = E4_DDD,    @VE4_DESCFIN= E4_DESCFIN, @VE4_DIADESC = E4_DIADESC,@VE4_FORMA  = E4_FORMA,
                      @VE4_ACRSFIN= E4_ACRSFIN,@VE4_SOLID  = E4_SOLID,  @VE4_PERCOM = E4_PERCOM,  @VE4_SUPER   = E4_SUPER,  @VE4_INFER  = E4_INFER,
                      @VE4_FATOR  = E4_FATOR,  @VE4_JURCART= E4_JURCART,@VE4_PLANO  = E4_PLANO,   @VD_E_L_E_T_ = D_E_L_E_T_,@VR_E_C_N_O_= R_E_C_N_O_,
                      @VR_E_C_D_E_L_= R_E_C_D_E_L_, @VE4_ACRES=E4_ACRES,@VE4_MSBLQL = E4_MSBLQL,  @VE4_VAEXMER = E4_VAEXMER
                 FROM INTEGRACAO_PROTHEUS_SE4
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [dbo].[MERCP_SE4010] 0, @VE4_FILIAL, @VE4_CODIGO,  @VE4_TIPO,      @VE4_COND,   @VE4_DESCRI, @VE4_IPI,    @VE4_DDD,    @VE4_DESCFIN,
                               @VE4_DIADESC,@VE4_FORMA,  @VE4_ACRSFIN, @VE4_SOLID,     @VE4_PERCOM, @VE4_SUPER,  @VE4_INFER,  @VE4_FATOR,  @VE4_JURCART,
                               @VE4_PLANO,  @VD_E_L_E_T_,@VR_E_C_N_O_, @VR_E_C_D_E_L_, @VE4_ACRES,  @VE4_MSBLQL, @VE4_VAEXMER
       
            END;
           ---------------------------
           ---- FIM 8012 - CONDICAO PAGAMENTO
           ---------------------------


           ---------------------------
           ---- 8007 - OPERACAO VENDA
           ---------------------------
           IF @P_TIPO = 8007
           BEGIN
               SELECT @VF4_FILIAL = F4_FILIAL, @VF4_CODIGO = F4_CODIGO, @VF4_TIPO   = F4_TIPO,    @VF4_ICM     = F4_ICM,    @VF4_IPI    = F4_IPI
                   ,  @VF4_CREDICM= F4_CREDICM,@VF4_CREDIPI= F4_CREDIPI,@VF4_DUPLIC = F4_DUPLIC,  @VF4_ESTOQUE = F4_ESTOQUE,@VF4_CF     = F4_CF
                   ,  @VF4_TEXTO  = F4_TEXTO,  @VF4_BASEIPI= F4_BASEIPI, @VF4_PODER3  = F4_PODER3, @VF4_LFICM  = F4_LFICM
                   ,  @VF4_LFIPI  = F4_LFIPI,  @VF4_DESTACA= F4_DESTACA,@VF4_INCIDE = F4_INCIDE,  @VF4_COMPL   = F4_COMPL,  @VF4_IPIFRET= F4_IPIFRET
                   ,  @VF4_ISS    = F4_ISS,    @VF4_LFISS  = F4_LFISS,  @VF4_NRLIVRO= F4_NRLIVRO, @VF4_UPRC    = F4_UPRC,   @VF4_CONSUMO= F4_CONSUMO
                   ,  @VF4_FORMULA= F4_FORMULA,@VF4_AGREG  = F4_AGREG,  @VF4_CIAP   = F4_CIAP,    @VF4_INCSOL  = F4_INCSOL, @VF4_DESPIPI= F4_DESPIPI
                   ,  @VF4_LIVRO  = F4_LIVRO,  @VF4_ATUTEC = F4_ATUTEC, @VF4_ATUATF = F4_ATUATF,  @VF4_TPIPI   = F4_TPIPI,  @VF4_PISCOF = F4_PISCOF
                   ,  @VF4_PISCRED= F4_PISCRED,@VF4_BASEISS= F4_BASEISS,@VF4_BSICMST= F4_BSICMST, @VF4_CREDST  = F4_CREDST, @VF4_STDESC = F4_STDESC
                   ,  @VF4_DESPICM= F4_DESPICM,@VF4_SITTRIB= F4_SITTRIB,@VF4_TESDV  = F4_TESDV,   @VF4_MOVPRJ  = F4_MOVPRJ, @VF4_IPILICM= F4_IPILICM
                   ,  @VF4_ICMSDIF= F4_ICMSDIF,@VF4_TESP3  = F4_TESP3,  @VF4_QTDZERO= F4_QTDZERO, @VF4_SLDNPT  = F4_SLDNPT, @VF4_DEVZERO= F4_DEVZERO
                   ,  @VF4_TIPOPER= F4_TIPOPER,@VF4_TRFICM = F4_TRFICM, @VF4_TESENV = F4_TESENV,  @VF4_REGDSTA = F4_REGDSTA,@VF4_LFICMST= F4_LFICMST
                   ,  @VF4_PSCFST = F4_PSCFST, @VF4_CRDTRAN= F4_CRDTRAN,@VF4_ISSST  = F4_ISSST,   @VF4_CONTSOC = F4_CONTSOC,@VF4_CRPRST = F4_CRPRST
                   ,  @VF4_IPIPC  = F4_IPIPC,  @VF4_CRPRELE= F4_CRPRELE,@VF4_CTIPI  = F4_CTIPI,   @VF4_CALCFET = F4_CALCFET,@VF4_OBSICM = F4_OBSICM
                   ,  @VF4_OBSSOL = F4_OBSSOL, @VF4_CFPS   = F4_CFPS,   @VD_E_L_E_T_= D_E_L_E_T_, @VR_E_C_N_O_ = R_E_C_N_O_,@VR_E_C_D_E_L_=R_E_C_D_E_L_
                   ,  @VF4_CFEXT  = F4_CFEXT,  @VF4_BASEPIS= F4_BASEPIS,@VF4_BASECOF= F4_BASECOF, @VF4_MSBLQL  = F4_MSBLQL, @VF4_PICMDIF= F4_PICMDIF 
                   ,  @VF4_SELO   = F4_SELO,   @VF4_FINALID= F4_FINALID,@VF4_RETISS = F4_RETISS,  @VF4_TPREG   = F4_TPREG,  @VF4_AFRMM  = F4_AFRMM
                   ,  @VF4_CRDPRES= F4_CRDPRES,@VF4_DSPRDIC= F4_DSPRDIC,@VF4_AGRCOF = F4_AGRCOF,  @VF4_AGRPIS  = F4_AGRPIS, @VF4_CRDEST = F4_CRDEST
                   ,  @VF4_COFDSZF= F4_COFDSZF,@VF4_PISBRUT= F4_PISBRUT,@VF4_COFBRUT= F4_COFBRUT, @VF4_PISDSZF = F4_PISDSZF,@VF4_BCRDPIS= F4_BCRDPIS
                   ,  @VF4_BCRDCOF= F4_BCRDCOF,@VF4_TRANFIL= F4_TRANFIL,@VF4_OPEMOV = F4_OPEMOV,  @VF4_FRETAUT = F4_FRETAUT,@VF4_MKPCMP = F4_MKPCMP
                   ,  @VF4_ICMSST = F4_ICMSST, @VF4_BENSATF= F4_BENSATF,@VF4_AGRRETC= F4_AGRRETC, @VF4_TESE3   = F4_TESE3,  @VF4_IPIOBS = F4_IPIOBS
                   ,  @VF4_MKPSOL = F4_MKPSOL, @VF4_MARGEM = F4_MARGEM
                 FROM INTEGRACAO_PROTHEUS_SF4
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [dbo].[MERCP_SF4010] 0, @VF4_FILIAL, @VF4_CODIGO,  @VF4_TIPO  , @VF4_ICM   , @VF4_IPI   , @VF4_CREDICM,@VF4_CREDIPI,@VF4_DUPLIC, 
                               @VF4_ESTOQUE,@VF4_CF    , @VF4_TEXTO,   @VF4_BASEIPI,@VF4_PODER3, @VF4_LFICM , @VF4_LFIPI , @VF4_DESTACA, 
                               @VF4_INCIDE, @VF4_COMPL , @VF4_IPIFRET, @VF4_ISS   , @VF4_LFISS , @VF4_NRLIVRO,@VF4_UPRC  , @VF4_CONSUMO,@VF4_FORMULA, 
                               @VF4_AGREG , @VF4_CIAP  , @VF4_INCSOL,  @VF4_DESPIPI,@VF4_LIVRO,  @VF4_ATUTEC, @VF4_ATUATF, @VF4_TPIPI , @VF4_PISCOF, 
                               @VF4_PISCRED,@VF4_BASEISS,@VF4_BSICMST, @VF4_CREDST, @VF4_STDESC, @VF4_DESPICM,@VF4_SITTRIB,@VF4_TESDV , @VF4_MOVPRJ, 
                               @VF4_IPILICM,@VF4_ICMSDIF,@VF4_TESP3 ,  @VF4_QTDZERO,@VF4_SLDNPT, @VF4_DEVZERO,@VF4_TIPOPER,@VF4_TRFICM, @VF4_TESENV, 
                               @VF4_REGDSTA,@VF4_LFICMST,@VF4_PSCFST,  @VF4_CRDTRAN,@VF4_ISSST , @VF4_CONTSOC,@VF4_CRPRST, @VF4_IPIPC , @VF4_CRPRELE, 
                               @VF4_CTIPI , @VF4_CALCFET,@VF4_OBSICM,  @VF4_OBSSOL, @VF4_CFPS  , @VD_E_L_E_T_,@VR_E_C_N_O_,@VR_E_C_D_E_L_,@VF4_CFEXT, 
                               @VF4_BASEPIS,@VF4_BASECOF,@VF4_MSBLQL,  @VF4_PICMDIF,@VF4_SELO  , @VF4_FINALID,@VF4_RETISS, @VF4_TPREG , @VF4_AFRMM, 
                               @VF4_CRDPRES,@VF4_DSPRDIC,@VF4_AGRCOF,  @VF4_AGRPIS, @VF4_CRDEST, @VF4_COFDSZF,@VF4_PISBRUT,@VF4_COFBRUT,@VF4_PISDSZF, 
                               @VF4_BCRDPIS,@VF4_BCRDCOF,@VF4_TRANFIL, @VF4_OPEMOV, @VF4_FRETAUT,@VF4_MKPCMP, @VF4_ICMSST, @VF4_BENSATF,@VF4_AGRRETC, 
                               @VF4_TESE3 , @VF4_IPIOBS, @VF4_MKPSOL,  @VF4_MARGEM

            END;
           ---------------------------
           ---- FIM 8007 - OPERACAO VENDA
           ---------------------------


           ---------------------------
           ---- 41 - LISTAS DE PRECOS
           ----        Listas de Preços sempre carrega a capa (db_preco = DA0) e itens (db_preco_prod = DA1)
           ---------------------------
           IF @P_TIPO = 41
           BEGIN
               SELECT @VDA0_CODTAB= DA0_CODTAB,@VDA0_DESCRI= DA0_DESCRI,@VDA0_DATDE = DA0_DATDE,  @VDA0_HORADE = DA0_HORADE,@VDA0_DATATE= DA0_DATATE
                ,     @VDA0_HORATE= DA0_HORATE,@VDA0_CONDPG= DA0_CONDPG,@VDA0_TPHORA= DA0_TPHORA, @VDA0_ATIVO  = DA0_ATIVO, @VDA0_FILIAL= DA0_FILIAL
                ,     @VD_E_L_E_T_= D_E_L_E_T_,@VR_E_C_N_O_= R_E_C_N_O_,@VR_E_C_D_E_L_= R_E_C_D_E_L_,@VDA0_VAUF = DA0_VAUF,  @VDA0_VAESDI= DA0_VAESDI
				,     @VDA0_PERMAX = DA0_PERMAX,@VDA0_PERMIN = DA0_PERMIN
                 FROM INTEGRACAO_PROTHEUS_DA0
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR
       
               EXEC [dbo].[MERCP_DA0010] 0, @VDA0_CODTAB,@VDA0_DESCRI, @VDA0_DATDE, @VDA0_HORADE,@VDA0_DATATE,@VDA0_HORATE,@VDA0_CONDPG,@VDA0_TPHORA,
                               @VDA0_ATIVO, @VDA0_FILIAL,@VD_E_L_E_T_, @VR_E_C_N_O_,@VR_E_C_D_E_L_,@VDA0_VAUF,@VDA0_VAESDI,@VDA0_PERMAX,@VDA0_PERMIN

                --- Busca todos os itens da lista de precos que está logada
                SET @C_LISTA_PROD = CURSOR STATIC FOR
                
                        SELECT DA1_FILIAL   , DA1_ITEM     , DA1_CODTAB   , DA1_CODPRO   , DA1_GRUPO    , DA1_REFGRD   , DA1_PRCVEN   , DA1_VLRDES   
                             , DA1_PERDES   , DA1_ATIVO    , DA1_FRETE    , DA1_ESTADO   , DA1_TPOPER   , DA1_QTDLOT   , DA1_INDLOT   , DA1_MOEDA    
                             , DA1_DATVIG   , D_E_L_E_T_   , R_E_C_N_O_   , R_E_C_D_E_L_ 
                          FROM INTEGRACAO_PROTHEUS_DA1
                         WHERE DA1_CODTAB = @VDA0_CODTAB

                  OPEN @C_LISTA_PROD
                 FETCH NEXT FROM @C_LISTA_PROD
                  INTO @VDA1_FILIAL, @VDA1_ITEM,   @VDA1_CODTAB, @VDA1_CODPRO, @VDA1_GRUPO,  @VDA1_REFGRD, @VDA1_PRCVEN, @VDA1_VLRDES,
                       @VDA1_PERDES, @VDA1_ATIVO,  @VDA1_FRETE,  @VDA1_ESTADO, @VDA1_TPOPER, @VDA1_QTDLOT, @VDA1_INDLOT, @VDA1_MOEDA,
                       @VDA1_DATVIG, @VD_E_L_E_T_, @VR_E_C_N_O_, @VR_E_C_D_E_L_
                 WHILE @@FETCH_STATUS = 0
                 BEGIN

                    EXEC [dbo].[MERCP_DA1010] 0, @VDA1_FILIAL, @VDA1_ITEM,   @VDA1_CODTAB, @VDA1_CODPRO, @VDA1_GRUPO,  @VDA1_REFGRD, @VDA1_PRCVEN, @VDA1_VLRDES,
                                                 @VDA1_PERDES, @VDA1_ATIVO,  @VDA1_FRETE,  @VDA1_ESTADO, @VDA1_TPOPER, @VDA1_QTDLOT, @VDA1_INDLOT, @VDA1_MOEDA,
                                                 @VDA1_DATVIG, @VD_E_L_E_T_, @VR_E_C_N_O_, @VR_E_C_D_E_L_


                    FETCH NEXT FROM @C_LISTA_PROD
                    INTO @VDA1_FILIAL, @VDA1_ITEM,   @VDA1_CODTAB, @VDA1_CODPRO, @VDA1_GRUPO,  @VDA1_REFGRD, @VDA1_PRCVEN, @VDA1_VLRDES,
                         @VDA1_PERDES, @VDA1_ATIVO,  @VDA1_FRETE,  @VDA1_ESTADO, @VDA1_TPOPER, @VDA1_QTDLOT, @VDA1_INDLOT, @VDA1_MOEDA,
                         @VDA1_DATVIG, @VD_E_L_E_T_, @VR_E_C_N_O_, @VR_E_C_D_E_L_
                 END

                 CLOSE @C_LISTA_PROD
                 DEALLOCATE @C_LISTA_PROD

            END;
           ---------------------------
           ---- FIM 41 - LISTAS DE PRECOS
           ---------------------------



           ---------------------------
           ---- 30 - PEDIDOS
           ----        Pedidos sempre carrega a capa (db_pedido = SA5) e itens (db_pedido_prod = SA6)
           ---------------------------
           IF @P_TIPO = 30
           BEGIN
               SELECT @VC5_FILIAL = C5_FILIAL, @VC5_NUM    = C5_NUM,    @VC5_TIPO   = C5_TIPO,    @VC5_CLIENTE = C5_CLIENTE,@VC5_LOJACLI= C5_LOJACLI
                ,     @VC5_CLIENT = C5_CLIENT, @VC5_LOJAENT= C5_LOJAENT,@VC5_TRANSP = C5_TRANSP,  @VC5_TIPOCLI = C5_TIPOCLI,@VC5_CONDPAG= C5_CONDPAG
                ,     @VC5_TABELA = C5_TABELA, @VC5_VEND1  = C5_VEND1,  @VC5_COMIS1 = C5_COMIS1,  @VC5_VEND2   = C5_VEND2,  @VC5_COMIS2 = C5_COMIS2
                ,     @VC5_VEND3  = C5_VEND3,  @VC5_COMIS3 = C5_COMIS3, @VC5_VEND4  = C5_VEND4,   @VC5_COMIS4  = C5_COMIS4, @VC5_VEND5  = C5_VEND5
                ,     @VC5_COMIS5 = C5_COMIS5, @VC5_DESC1  = C5_DESC1,  @VC5_DESC2  = C5_DESC2,   @VC5_DESC3   = C5_DESC3,  @VC5_DESC4  = C5_DESC4
                ,     @VC5_BANCO  = C5_BANCO,  @VC5_DESCFI = C5_DESCFI, @VC5_EMISSAO= C5_EMISSAO, @VC5_COTACAO = C5_COTACAO,@VC5_PARC1  = C5_PARC1
                ,     @VC5_DATA1  = C5_DATA1,  @VC5_PARC2  = C5_PARC2,  @VC5_DATA2  = C5_DATA2,   @VC5_PARC3   = C5_PARC3,  @VC5_DATA3  = C5_DATA3
                ,     @VC5_PARC4  = C5_PARC4,  @VC5_DATA4  = C5_DATA4,  @VC5_TPFRETE= C5_TPFRETE, @VC5_FRETE   = C5_FRETE,  @VC5_DESPESA= C5_DESPESA
                ,     @VC5_FRETAUT= C5_FRETAUT,@VC5_REAJUST= C5_REAJUST,@VC5_MOEDA  = C5_MOEDA,   @VC5_SEGURO  = C5_SEGURO, @VC5_PESOL  = C5_PESOL
                ,     @VC5_PBRUTO = C5_PBRUTO, @VC5_REIMP  = C5_REIMP,  @VC5_REDESP = C5_REDESP,  @VC5_VOLUME1 = C5_VOLUME1,@VC5_VOLUME2= C5_VOLUME2
                ,     @VC5_VOLUME3= C5_VOLUME3,@VC5_VOLUME4= C5_VOLUME4,@VC5_ESPECI1= C5_ESPECI1, @VC5_ESPECI2 = C5_ESPECI2,@VC5_ESPECI3= C5_ESPECI3
                ,     @VC5_ESPECI4= C5_ESPECI4,@VC5_ACRSFIN= C5_ACRSFIN,@VC5_INCISS = C5_INCISS,  @VC5_LIBEROK = C5_LIBEROK,@VC5_OK     = C5_OK
                ,     @VC5_NOTA   = C5_NOTA,   @VC5_MENNOTA= C5_MENNOTA,@VC5_MENPAD = C5_MENPAD,  @VC5_OS      = C5_OS,     @VC5_SERIE  = C5_SERIE
                ,     @VC5_KITREP = C5_KITREP, @VC5_TIPLIB = C5_TIPLIB, @VC5_TXMOEDA= C5_TXMOEDA, @VC5_DESCONT = C5_DESCONT,@VC5_PEDEXP = C5_PEDEXP
                ,     @VC5_TPCARGA= C5_TPCARGA,@VC5_PDESCAB= C5_PDESCAB,@VC5_BLQ    = C5_BLQ,     @VC5_FORNISS = C5_FORNISS,@VC5_CONTRA = C5_CONTRA
                ,     @VC5_VLR_FRT= C5_VLR_FRT,@VD_E_L_E_T_= D_E_L_E_T_,@VR_E_C_N_O_=R_E_C_N_O_,  @VR_E_C_D_E_L_= R_E_C_D_E_L_, @VC5_VAPDMER = C5_VAPDMER
                 FROM INTEGRACAO_PROTHEUS_SC5
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [DBO].[MERCP_SC5010] 0, @VC5_FILIAL ,@VC5_NUM    , @VC5_TIPO   ,@VC5_CLIENTE,@VC5_LOJACLI,@VC5_CLIENT ,@VC5_LOJAENT,@VC5_TRANSP,
                              @VC5_TIPOCLI, @VC5_CONDPAG,@VC5_TABELA , @VC5_VEND1  ,@VC5_COMIS1 ,@VC5_VEND2  ,@VC5_COMIS2 ,@VC5_VEND3  ,@VC5_COMIS3,
                              @VC5_VEND4  , @VC5_COMIS4 ,@VC5_VEND5  , @VC5_COMIS5 ,@VC5_DESC1  ,@VC5_DESC2  ,@VC5_DESC3  ,@VC5_DESC4  ,@VC5_BANCO ,
                              @VC5_DESCFI , @VC5_EMISSAO,@VC5_COTACAO, @VC5_PARC1  ,@VC5_DATA1  ,@VC5_PARC2  ,@VC5_DATA2  ,@VC5_PARC3  ,@VC5_DATA3 ,
                              @VC5_PARC4  , @VC5_DATA4  ,@VC5_TPFRETE, @VC5_FRETE  ,@VC5_DESPESA,@VC5_FRETAUT,@VC5_REAJUST,@VC5_MOEDA  ,@VC5_SEGURO,
                              @VC5_PESOL  , @VC5_PBRUTO ,@VC5_REIMP  , @VC5_REDESP ,@VC5_VOLUME1,@VC5_VOLUME2,@VC5_VOLUME3,@VC5_VOLUME4,@VC5_ESPECI1,
                              @VC5_ESPECI2, @VC5_ESPECI3,@VC5_ESPECI4, @VC5_ACRSFIN,@VC5_INCISS ,@VC5_LIBEROK,@VC5_OK     ,@VC5_NOTA   ,@VC5_MENNOTA,
                              @VC5_MENPAD , @VC5_OS     ,@VC5_SERIE  , @VC5_KITREP ,@VC5_TIPLIB ,@VC5_TXMOEDA,@VC5_DESCONT,@VC5_PEDEXP ,@VC5_TPCARGA,
                              @VC5_PDESCAB, @VC5_BLQ    ,@VC5_FORNISS, @VC5_CONTRA ,@VC5_VLR_FRT,@VD_E_L_E_T_,@VR_E_C_N_O_,@VR_E_C_D_E_L_, @VC5_VAPDMER

                --- Busca todos os itens do pedido que está logado
                SET @C_PEDIDO_PROD  = CURSOR STATIC FOR
                
                       SELECT C6_FILIAL,      C6_ITEM,       C6_PRODUTO,    C6_DESCRI,     C6_UM,         C6_QTDVEN,      C6_PRCVEN,    C6_VALOR
                          ,   C6_PEDCLI,      C6_SEGUM,      C6_QTDLIB,     C6_UNSVEN,     C6_QTDLIB2,    C6_TES,         C6_QTDENT,    C6_QTDENT2
                          ,   C6_LOCAL,       C6_CF,         C6_CLI,        C6_ENTREG,     C6_LA,         C6_DESCONT,     C6_VALDESC,   C6_LOJA
                          ,   C6_DATFAT,      C6_NOTA,       C6_SERIE,      C6_NUM,        C6_COMIS1,     C6_COMIS2,      C6_COMIS3,    C6_COMIS4
                          ,   C6_COMIS5,      C6_PRUNIT,     C6_BLOQUEI,    C6_RESERVA,    C6_OP,         C6_OK,          C6_NFORI,     C6_SERIORI
                          ,   C6_ITEMORI,     C6_IPIDEV,     C6_IDENTB6,    C6_BLQ,        C6_PICMRET,    C6_CODISS,      C6_GRADE,     C6_ITEMGRD
                          ,   C6_LOTECTL,     C6_NUMLOTE,    C6_DTVALID,    C6_NUMORC,     C6_CHASSI,     C6_OPC,         C6_LOCALIZ,   C6_NUMSERI
                          ,   C6_NUMOP,       C6_ITEMOP,     C6_CLASFIS,    C6_QTDRESE,    C6_CONTRAT,    C6_NUMOS,       C6_NUMOSFA,   C6_CODFAB
                          ,   C6_LOJAFA,      C6_ITEMCON,    C6_TPOP,       C6_REVISAO,    C6_SERVIC,     C6_ENDPAD,      C6_TPCONTR,   C6_ITCONTR
                          ,   C6_GEROUPV,     C6_PROJPMS,    C6_EDTPMS,     C6_TASKPMS,    C6_TRT,        C6_QTDEMP,      C6_QTDEMP2,   C6_PROJET
                          ,   C6_ITPROJ,      C6_POTENCI,    C6_LICITA,     C6_REGWMS,     C6_NUMCP,      C6_NUMSC,       C6_ITEMSC,    C6_SUGENTR
                          ,   C6_ITEMED,      C6_ABSCINS,    C6_ABATISS,    C6_ABATMAT,    C6_FUNRURA,    C6_FETAB,     C6_CODROM
                          ,   C6_PEDCOM,      C6_ITPC,       C6_FILPED,     C6_TPDEDUZ,    C6_MOTDED,     C6_FORDED,      C6_LOJDED,    C6_SERDED
                          ,   C6_NFDED,       C6_VLNFD,      C6_PCDED,      C6_VLDED,      C6_ABATINS,    C6_CODLAN,      D_E_L_E_T_,   R_E_C_N_O_
                          ,   R_E_C_D_E_L_
                         FROM INTEGRACAO_PROTHEUS_SC6
                        WHERE C6_FILIAL = @VC5_FILIAL
                          AND C6_NUM    = @VC5_NUM

                  OPEN @C_PEDIDO_PROD
                 FETCH NEXT FROM @C_PEDIDO_PROD
                  INTO  @VC6_FILIAL,      @VC6_ITEM,       @VC6_PRODUTO,    @VC6_DESCRI,     @VC6_UM,         @VC6_QTDVEN,      @VC6_PRCVEN,    @VC6_VALOR
                    ,   @VC6_PEDCLI,      @VC6_SEGUM,      @VC6_QTDLIB,     @VC6_UNSVEN,     @VC6_QTDLIB2,    @VC6_TES,         @VC6_QTDENT,    @VC6_QTDENT2
                    ,   @VC6_LOCAL,       @VC6_CF,         @VC6_CLI,        @VC6_ENTREG,     @VC6_LA,         @VC6_DESCONT,     @VC6_VALDESC,   @VC6_LOJA
                    ,   @VC6_DATFAT,      @VC6_NOTA,       @VC6_SERIE,      @VC6_NUM,        @VC6_COMIS1,     @VC6_COMIS2,      @VC6_COMIS3,    @VC6_COMIS4
                    ,   @VC6_COMIS5,      @VC6_PRUNIT,     @VC6_BLOQUEI,    @VC6_RESERVA,    @VC6_OP,         @VC6_OK,          @VC6_NFORI,     @VC6_SERIORI
                    ,   @VC6_ITEMORI,     @VC6_IPIDEV,     @VC6_IDENTB6,    @VC6_BLQ,        @VC6_PICMRET,    @VC6_CODISS,      @VC6_GRADE,     @VC6_ITEMGRD
                    ,   @VC6_LOTECTL,     @VC6_NUMLOTE,    @VC6_DTVALID,    @VC6_NUMORC,     @VC6_CHASSI,     @VC6_OPC,         @VC6_LOCALIZ,   @VC6_NUMSERI
                    ,   @VC6_NUMOP,       @VC6_ITEMOP,     @VC6_CLASFIS,    @VC6_QTDRESE,    @VC6_CONTRAT,    @VC6_NUMOS,       @VC6_NUMOSFA,   @VC6_CODFAB
                    ,   @VC6_LOJAFA,      @VC6_ITEMCON,    @VC6_TPOP,       @VC6_REVISAO,    @VC6_SERVIC,     @VC6_ENDPAD,      @VC6_TPCONTR,   @VC6_ITCONTR
                    ,   @VC6_GEROUPV,     @VC6_PROJPMS,    @VC6_EDTPMS,     @VC6_TASKPMS,    @VC6_TRT,        @VC6_QTDEMP,      @VC6_QTDEMP2,   @VC6_PROJET
                    ,   @VC6_ITPROJ,      @VC6_POTENCI,    @VC6_LICITA,     @VC6_REGWMS,     @VC6_NUMCP,      @VC6_NUMSC,       @VC6_ITEMSC,    @VC6_SUGENTR
                    ,   @VC6_ITEMED,      @VC6_ABSCINS,    @VC6_ABATISS,    @VC6_ABATMAT,    @VC6_FUNRURA,    @VC6_FETAB,       @VC6_CODROM
                    ,   @VC6_PEDCOM,      @VC6_ITPC,       @VC6_FILPED,     @VC6_TPDEDUZ,    @VC6_MOTDED,     @VC6_FORDED,      @VC6_LOJDED,    @VC6_SERDED
                    ,   @VC6_NFDED,       @VC6_VLNFD,      @VC6_PCDED,      @VC6_VLDED,      @VC6_ABATINS,    @VC6_CODLAN,      @VD_E_L_E_T_,   @VR_E_C_N_O_
                    ,   @VR_E_C_D_E_L_
                 WHILE @@FETCH_STATUS = 0
                 BEGIN

                    EXEC [dbo].[MERCP_SC6010] 0, @VC6_FILIAL,     @VC6_ITEM,       @VC6_PRODUTO,    @VC6_DESCRI,     @VC6_UM,         @VC6_QTDVEN
                         ,      @VC6_PRCVEN,     @VC6_VALOR,      @VC6_PEDCLI,     @VC6_SEGUM,      @VC6_QTDLIB,     @VC6_UNSVEN,     @VC6_QTDLIB2
                         ,      @VC6_TES,        @VC6_QTDENT,     @VC6_QTDENT2,    @VC6_LOCAL,      @VC6_CF,         @VC6_CLI,        @VC6_ENTREG
                         ,      @VC6_LA,         @VC6_DESCONT,    @VC6_VALDESC,    @VC6_LOJA,       @VC6_DATFAT,     @VC6_NOTA,       @VC6_SERIE
                         ,      @VC6_NUM,        @VC6_COMIS1,     @VC6_COMIS2,     @VC6_COMIS3,     @VC6_COMIS4,     @VC6_COMIS5,     @VC6_PRUNIT
                         ,      @VC6_BLOQUEI,    @VC6_RESERVA,    @VC6_OP,         @VC6_OK,         @VC6_NFORI,      @VC6_SERIORI,    @VC6_ITEMORI
                         ,      @VC6_IPIDEV,     @VC6_IDENTB6,    @VC6_BLQ,        @VC6_PICMRET,    @VC6_CODISS,     @VC6_GRADE,      @VC6_ITEMGRD
                         ,      @VC6_LOTECTL,    @VC6_NUMLOTE,    @VC6_DTVALID,    @VC6_NUMORC,     @VC6_CHASSI,     @VC6_OPC,        @VC6_LOCALIZ
                         ,      @VC6_NUMSERI,    @VC6_NUMOP,      @VC6_ITEMOP,     @VC6_CLASFIS,    @VC6_QTDRESE,    @VC6_CONTRAT,    @VC6_NUMOS
                         ,      @VC6_NUMOSFA,    @VC6_CODFAB,     @VC6_LOJAFA,     @VC6_ITEMCON,    @VC6_TPOP,       @VC6_REVISAO,    @VC6_SERVIC
                         ,      @VC6_ENDPAD,     @VC6_TPCONTR,    @VC6_ITCONTR,    @VC6_GEROUPV,    @VC6_PROJPMS,    @VC6_EDTPMS,     @VC6_TASKPMS
                         ,      @VC6_TRT,        @VC6_QTDEMP,     @VC6_QTDEMP2,    @VC6_PROJET,     @VC6_ITPROJ,     @VC6_POTENCI,    @VC6_LICITA
                         ,      @VC6_REGWMS,     @VC6_NUMCP,      @VC6_NUMSC,      @VC6_ITEMSC,     @VC6_SUGENTR,    @VC6_ITEMED,     @VC6_ABSCINS
                         ,      @VC6_ABATISS,    @VC6_ABATMAT,    @VC6_FUNRURA,    @VC6_FETAB,      @VC6_CODROM,     @VC6_PEDCOM
                         ,      @VC6_ITPC,       @VC6_FILPED,     @VC6_TPDEDUZ,    @VC6_MOTDED,     @VC6_FORDED,     @VC6_LOJDED,     @VC6_SERDED
                         ,      @VC6_NFDED,      @VC6_VLNFD,      @VC6_PCDED,      @VC6_VLDED,      @VC6_ABATINS,    @VC6_CODLAN,     @VD_E_L_E_T_
                         ,      @VR_E_C_N_O_,    @VR_E_C_D_E_L_


                    FETCH NEXT FROM @C_PEDIDO_PROD
                      INTO  @VC6_FILIAL,      @VC6_ITEM,       @VC6_PRODUTO,    @VC6_DESCRI,     @VC6_UM,         @VC6_QTDVEN,      @VC6_PRCVEN,    @VC6_VALOR
                        ,   @VC6_PEDCLI,      @VC6_SEGUM,      @VC6_QTDLIB,     @VC6_UNSVEN,     @VC6_QTDLIB2,    @VC6_TES,         @VC6_QTDENT,    @VC6_QTDENT2
                        ,   @VC6_LOCAL,       @VC6_CF,         @VC6_CLI,        @VC6_ENTREG,     @VC6_LA,         @VC6_DESCONT,     @VC6_VALDESC,   @VC6_LOJA
                        ,   @VC6_DATFAT,      @VC6_NOTA,       @VC6_SERIE,      @VC6_NUM,        @VC6_COMIS1,     @VC6_COMIS2,      @VC6_COMIS3,    @VC6_COMIS4
                        ,   @VC6_COMIS5,      @VC6_PRUNIT,     @VC6_BLOQUEI,    @VC6_RESERVA,    @VC6_OP,         @VC6_OK,          @VC6_NFORI,     @VC6_SERIORI
                        ,   @VC6_ITEMORI,     @VC6_IPIDEV,     @VC6_IDENTB6,    @VC6_BLQ,        @VC6_PICMRET,    @VC6_CODISS,      @VC6_GRADE,     @VC6_ITEMGRD
                        ,   @VC6_LOTECTL,     @VC6_NUMLOTE,    @VC6_DTVALID,    @VC6_NUMORC,     @VC6_CHASSI,     @VC6_OPC,         @VC6_LOCALIZ,   @VC6_NUMSERI
                        ,   @VC6_NUMOP,       @VC6_ITEMOP,     @VC6_CLASFIS,    @VC6_QTDRESE,    @VC6_CONTRAT,    @VC6_NUMOS,       @VC6_NUMOSFA,   @VC6_CODFAB
                        ,   @VC6_LOJAFA,      @VC6_ITEMCON,    @VC6_TPOP,       @VC6_REVISAO,    @VC6_SERVIC,     @VC6_ENDPAD,      @VC6_TPCONTR,   @VC6_ITCONTR
                        ,   @VC6_GEROUPV,     @VC6_PROJPMS,    @VC6_EDTPMS,     @VC6_TASKPMS,    @VC6_TRT,        @VC6_QTDEMP,      @VC6_QTDEMP2,   @VC6_PROJET
                        ,   @VC6_ITPROJ,      @VC6_POTENCI,    @VC6_LICITA,     @VC6_REGWMS,     @VC6_NUMCP,      @VC6_NUMSC,       @VC6_ITEMSC,    @VC6_SUGENTR
                        ,   @VC6_ITEMED,      @VC6_ABSCINS,    @VC6_ABATISS,    @VC6_ABATMAT,    @VC6_FUNRURA,    @VC6_FETAB,       @VC6_CODROM
                        ,   @VC6_PEDCOM,      @VC6_ITPC,       @VC6_FILPED,     @VC6_TPDEDUZ,    @VC6_MOTDED,     @VC6_FORDED,      @VC6_LOJDED,    @VC6_SERDED
                        ,   @VC6_NFDED,       @VC6_VLNFD,      @VC6_PCDED,      @VC6_VLDED,      @VC6_ABATINS,    @VC6_CODLAN,      @VD_E_L_E_T_,   @VR_E_C_N_O_
                        ,   @VR_E_C_D_E_L_
                 END

                 CLOSE @C_PEDIDO_PROD
                 DEALLOCATE @C_PEDIDO_PROD

            END;
           ---------------------------
           ---- FIM 30 - PEDIDOS
           ---------------------------



           ---------------------------
           ---- 37 - NOTAS FISCAIS VENDA
           ----        Notas de Vendas sempre carrega a capa (db_nota_fiscal = SF2) e itens (db_nota_prod = SD2)
           ---------------------------
           IF @P_TIPO = 37
           BEGIN
               SELECT @VF2_FILIAL = F2_FILIAL, @VF2_DOC    = F2_DOC,    @VF2_SERIE  = F2_SERIE   ,@VF2_CLIENTE = F2_CLIENTE,@VF2_LOJA   = F2_LOJA  
                ,     @VF2_COND   = F2_COND ,  @VF2_DUPL   = F2_DUPL   ,@VF2_EMISSAO= F2_EMISSAO ,@VF2_EST     = F2_EST    ,@VF2_FRETE  = F2_FRETE    
                ,     @VF2_SEGURO = F2_SEGURO ,@VF2_ICMFRET= F2_ICMFRET,@VF2_TIPOCLI= F2_TIPOCLI ,@VF2_VALBRUT = F2_VALBRUT,@VF2_VALINSS= F2_VALINSS
                ,     @VF2_VALICM = F2_VALICM ,@VF2_BASEICM= F2_BASEICM,@VF2_VALIPI = F2_VALIPI  ,@VF2_BASEIPI = F2_BASEIPI,@VF2_VALMERC= F2_VALMERC
                ,     @VF2_NFORI  = F2_NFORI  ,@VF2_DESCONT= F2_DESCONT,@VF2_SERIORI= F2_SERIORI ,@VF2_TIPO    = F2_TIPO   ,@VF2_ESPECI1= F2_ESPECI1
                ,     @VF2_ESPECI2= F2_ESPECI2,@VF2_ESPECI3= F2_ESPECI3,@VF2_ESPECI4= F2_ESPECI4 ,@VF2_VOLUME1 = F2_VOLUME1,@VF2_VOLUME2= F2_VOLUME2  
                ,     @VF2_VOLUME3= F2_VOLUME3,@VF2_VOLUME4= F2_VOLUME4,@VF2_ICMSRET= F2_ICMSRET ,@VF2_PLIQUI  = F2_PLIQUI ,@VF2_PBRUTO = F2_PBRUTO
                ,     @VF2_TRANSP = F2_TRANSP ,@VF2_REDESP = F2_REDESP ,@VF2_VEND1  = F2_VEND1   ,@VF2_VEND2   = F2_VEND2  ,@VF2_VEND3  = F2_VEND3    
                ,     @VF2_VEND4  = F2_VEND4  ,@VF2_VEND5  = F2_VEND5  ,@VF2_OK     = F2_OK      ,@VF2_FIMP    = F2_FIMP   ,@VF2_DTLANC = F2_DTLANC   
                ,     @VF2_DTREAJ = F2_DTREAJ ,@VF2_REAJUST= F2_REAJUST,@VF2_DTBASE0= F2_DTBASE0 ,@VF2_FATORB0 = F2_FATORB0,@VF2_DTBASE1= F2_DTBASE1  
                ,     @VF2_FATORB1= F2_FATORB1,@VF2_VARIAC = F2_VARIAC ,@VF2_BASEISS= F2_BASEISS ,@VF2_VALISS  = F2_VALISS ,@VF2_VALFAT = F2_VALFAT   
                ,     @VF2_CONTSOC= F2_CONTSOC,@VF2_BRICMS = F2_BRICMS ,@VF2_FRETAUT= F2_FRETAUT ,@VF2_ICMAUTO = F2_ICMAUTO,@VF2_DESPESA= F2_DESPESA  
                ,     @VF2_NEXTDOC= F2_NEXTDOC,@VF2_ESPECIE= F2_ESPECIE,@VF2_PDV    = F2_PDV     ,@VF2_MAPA    = F2_MAPA   ,@VF2_ECF    = F2_ECF      
                ,     @VF2_BASIMP1= F2_BASIMP1,@VF2_PREFIXO= F2_PREFIXO,@VF2_BASIMP2= F2_BASIMP2 ,@VF2_BASIMP3 = F2_BASIMP3,@VF2_BASIMP4= F2_BASIMP4  
                ,     @VF2_BASIMP5= F2_BASIMP5,@VF2_BASIMP6= F2_BASIMP6,@VF2_VALIMP1= F2_VALIMP1 ,@VF2_VALIMP2 = F2_VALIMP2,@VF2_VALIMP3= F2_VALIMP3  
                ,     @VF2_VALIMP4= F2_VALIMP4,@VF2_VALIMP5= F2_VALIMP5,@VF2_VALIMP6= F2_VALIMP6 ,@VF2_ORDPAGO = F2_ORDPAGO,@VF2_NFCUPOM= F2_NFCUPOM  
                ,     @VF2_HORA   = F2_HORA   ,@VF2_BASEINS= F2_BASEINS,@VF2_LOTE   = F2_LOTE    ,@VF2_MOEDA   = F2_MOEDA  ,@VF2_REGIAO = F2_REGIAO   
                ,     @VF2_TXMOEDA= F2_TXMOEDA,@VF2_VALCOFI= F2_VALCOFI,@VF2_VALCSLL= F2_VALCSLL ,@VF2_VALPIS  = F2_VALPIS ,@VF2_VALIRRF= F2_VALIRRF
                ,     @VF2_CARGA  = F2_CARGA  ,@VF2_SEQCAR = F2_SEQCAR ,@VF2_NEXTSER= F2_NEXTSER ,@VF2_PEDPEND = F2_PEDPEND,@VF2_DESCCAB= F2_DESCCAB  
                ,     @VF2_DTENTR = F2_DTENTR ,@VF2_FORMUL = F2_FORMUL ,@VF2_TIPODOC= F2_TIPODOC ,@VF2_NFEACRS = F2_NFEACRS,@VF2_TIPOREM= F2_TIPOREM  
                ,     @VF2_SEQENT = F2_SEQENT ,@VF2_VEICUL1= F2_VEICUL1,@VF2_VEICUL2= F2_VEICUL2 ,@VF2_VEICUL3 = F2_VEICUL3,@VF2_ICMSDIF= F2_ICMSDIF
                ,     @VF2_BASEPS3= F2_BASEPS3,@VF2_VALPS3 = F2_VALPS3 ,@VF2_BASECF3= F2_BASECF3 ,@VF2_VALCF3  = F2_VALCF3 ,@VF2_NFELETR= F2_NFELETR
                ,     @VF2_EMINFE = F2_EMINFE ,@VF2_HORNFE = F2_HORNFE ,@VF2_CODNFE = F2_CODNFE  ,@VF2_CREDNFE = F2_CREDNFE,@VD_E_L_E_T_= D_E_L_E_T_ 
                ,  @VR_E_C_N_O_= R_E_C_N_O_,@VR_E_C_D_E_L_=R_E_C_D_E_L_,@VF2_VALACRS= F2_VALACRS ,@VF2_RECISS  = F2_RECISS ,@VF2_TIPORET= F2_TIPORET
                ,     @VF2_HAWB   = F2_HAWB   ,@VF2_VLR_FRT= F2_VLR_FRT,@VF2_DTDIGIT= F2_DTDIGIT
                 FROM INTEGRACAO_PROTHEUS_SF2
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [DBO].[MERCP_SF2010] 0, @VF2_FILIAL ,@VF2_DOC    , @VF2_SERIE  ,@VF2_CLIENTE,@VF2_LOJA   ,@VF2_COND   ,@VF2_DUPL   ,@VF2_EMISSAO,
                              @VF2_EST    , @VF2_FRETE  ,@VF2_SEGURO , @VF2_ICMFRET,@VF2_TIPOCLI,@VF2_VALBRUT,@VF2_VALINSS,@VF2_VALICM ,@VF2_BASEICM,
                              @VF2_VALIPI , @VF2_BASEIPI,@VF2_VALMERC, @VF2_NFORI  ,@VF2_DESCONT,@VF2_SERIORI,@VF2_TIPO   ,@VF2_ESPECI1,@VF2_ESPECI2,
                              @VF2_ESPECI3, @VF2_ESPECI4,@VF2_VOLUME1, @VF2_VOLUME2,@VF2_VOLUME3,@VF2_VOLUME4,@VF2_ICMSRET,@VF2_PLIQUI ,@VF2_PBRUTO, 
                              @VF2_TRANSP , @VF2_REDESP ,@VF2_VEND1  , @VF2_VEND2  ,@VF2_VEND3  ,@VF2_VEND4  ,@VF2_VEND5  ,@VF2_OK     ,@VF2_FIMP,     
                              @VF2_DTLANC , @VF2_DTREAJ ,@VF2_REAJUST, @VF2_DTBASE0,@VF2_FATORB0,@VF2_DTBASE1,@VF2_FATORB1,@VF2_VARIAC ,@VF2_BASEISS,  
                              @VF2_VALISS , @VF2_VALFAT ,@VF2_CONTSOC, @VF2_BRICMS ,@VF2_FRETAUT,@VF2_ICMAUTO,@VF2_DESPESA,@VF2_NEXTDOC,@VF2_ESPECIE,  
                              @VF2_PDV    , @VF2_MAPA   ,@VF2_ECF    , @VF2_BASIMP1,@VF2_PREFIXO,@VF2_BASIMP2,@VF2_BASIMP3,@VF2_BASIMP4,@VF2_BASIMP5,  
                              @VF2_BASIMP6, @VF2_VALIMP1,@VF2_VALIMP2, @VF2_VALIMP3,@VF2_VALIMP4,@VF2_VALIMP5,@VF2_VALIMP6,@VF2_ORDPAGO,@VF2_NFCUPOM,  
                              @VF2_HORA   , @VF2_BASEINS,@VF2_LOTE   , @VF2_MOEDA  ,@VF2_REGIAO ,@VF2_TXMOEDA,@VF2_VALCOFI,@VF2_VALCSLL,@VF2_VALPIS,  
                              @VF2_VALIRRF, @VF2_CARGA  ,@VF2_SEQCAR , @VF2_NEXTSER,@VF2_PEDPEND,@VF2_DESCCAB,@VF2_DTENTR ,@VF2_FORMUL ,@VF2_TIPODOC,  
                              @VF2_NFEACRS, @VF2_TIPOREM,@VF2_SEQENT , @VF2_VEICUL1,@VF2_VEICUL2,@VF2_VEICUL3,@VF2_ICMSDIF,@VF2_BASEPS3,@VF2_VALPS3,  
                              @VF2_BASECF3, @VF2_VALCF3 ,@VF2_NFELETR, @VF2_EMINFE ,@VF2_HORNFE ,@VF2_CODNFE ,@VF2_CREDNFE,@VD_E_L_E_T_,@VR_E_C_N_O_,  
                              @VR_E_C_D_E_L_,@VF2_VALACRS,@VF2_RECISS , @VF2_TIPORET,@VF2_HAWB   ,@VF2_VLR_FRT,@VF2_DTDIGIT



                --- Busca todos os itens da nota que está logada
                SET @C_NOTA_PROD  = CURSOR STATIC FOR
                
                       SELECT D2_FILIAL ,     D2_COD    ,    D2_UM     ,    D2_SEGUM  ,    D2_QUANT  ,    D2_PRCVEN ,     D2_TOTAL  ,   D2_VALIPI 
                        ,     D2_VALICM ,     D2_TES    ,    D2_CF     ,    D2_DESC   ,    D2_IPI    ,    D2_PICM   ,     D2_PESO   ,   D2_CONTA   
                        ,     D2_PEDIDO ,     D2_ITEMPV ,    D2_CLIENTE,    D2_LOJA   ,    D2_LOCAL  ,    D2_DOC    ,     D2_EMISSAO,   D2_GRUPO  
                        ,     D2_TP     ,     D2_SERIE  ,    D2_CUSTO1 ,    D2_CUSTO2 ,    D2_CUSTO3 ,    D2_CUSTO4 ,     D2_CUSTO5 ,   D2_PRUNIT 
                        ,     D2_QTSEGUM,     D2_NUMSEQ ,    D2_EST    ,    D2_DESCON ,    D2_TIPO   ,    D2_NFORI  ,     D2_SERIORI,   D2_QTDEDEV
                        ,     D2_VALDEV ,     D2_ORIGLAN,    D2_BRICMS ,    D2_BASEORI,    D2_BASEICM,    D2_VALACRS,     D2_IDENTB6,   D2_ITEM   
                        ,     D2_CODISS ,     D2_GRADE  ,    D2_SEQCALC,    D2_ICMSRET,    D2_COMIS1 ,    D2_COMIS2 ,     D2_COMIS3 ,   D2_COMIS4 
                        ,     D2_COMIS5 ,     D2_LOTECTL,    D2_NUMLOTE,    D2_DTVALID,    D2_DESCZFR,    D2_PDV    ,     D2_NUMSERI,   D2_DTLCTCT
                        ,     D2_CUSFF1 ,     D2_CUSFF2 ,    D2_CUSFF3 ,    D2_CUSFF4 ,    D2_CUSFF5 ,    D2_CLASFIS,     D2_BASIMP1,   D2_BASIMP2
                        ,     D2_BASIMP3,     D2_BASIMP4,    D2_BASIMP5,    D2_BASIMP6,    D2_VALIMP1,    D2_VALIMP2,     D2_VALIMP3,   D2_VALIMP4
                        ,     D2_VALIMP5,     D2_VALIMP6,    D2_ITEMORI,    D2_CODFAB ,    D2_LOJAFA ,    D2_ALIQINS,     D2_ALIQISS,   D2_BASEINS
                        ,     D2_BASEIPI,     D2_BASEISS,    D2_CCUSTO ,    D2_DESPESA,    D2_ENVCNAB,    D2_ITEMCC ,     D2_LOCALIZ,   D2_PREEMB  
                        ,     D2_SEGURO ,     D2_VALFRE ,    D2_VALINS ,    D2_VALISS ,    D2_CLVL   ,    D2_ICMFRET,     D2_SERVIC ,   D2_STSERV  
                        ,     D2_PROJPMS,     D2_TASKPMS,    D2_LICITA ,    D2_REMITO ,    D2_SERIREM,    D2_ITEMREM,     D2_ALQIMP1,   D2_ALQIMP2
                        ,     D2_ALQIMP3,     D2_ALQIMP4,    D2_ALQIMP5,    D2_ALQIMP6,    D2_TPDCENV,    D2_OK     ,     D2_EDTPMS ,   D2_VARPRUN
                        ,     D2_FORMUL ,     D2_TIPODOC,    D2_VAC    ,    D2_TIPOREM,    D2_QTDEFAT,    D2_QTDAFAT,     D2_SEQUEN ,   D2_POTENCI
                        ,     D2_DESCICM,     D2_BASEPS3,    D2_ALIQPS3,    D2_VALPS3 ,    D2_BASECF3,    D2_ALIQCF3,     D2_VALCF3 ,   D_E_L_E_T_ 
                        ,     R_E_C_N_O_,     R_E_C_D_E_L_,  D2_OP     ,    D2_TPESTR ,    D2_VALBRUT,    D2_REGWMS ,     D2_DTDIGIT,   D2_NUMCP   
                        ,     D2_CFPS   
                         FROM INTEGRACAO_PROTHEUS_SD2
                        WHERE D2_FILIAL = @VF2_FILIAL
                          AND D2_DOC    = @VF2_DOC

                  OPEN @C_NOTA_PROD
                 FETCH NEXT FROM @C_NOTA_PROD
                  INTO  @VD2_FILIAL ,     @VD2_COD    ,    @VD2_UM     ,    @VD2_SEGUM  ,    @VD2_QUANT  ,    @VD2_PRCVEN ,     @VD2_TOTAL  ,   @VD2_VALIPI 
                    ,   @VD2_VALICM ,     @VD2_TES    ,    @VD2_CF     ,    @VD2_DESC   ,    @VD2_IPI    ,    @VD2_PICM   ,     @VD2_PESO   ,   @VD2_CONTA   
                    ,   @VD2_PEDIDO ,     @VD2_ITEMPV ,    @VD2_CLIENTE,    @VD2_LOJA   ,    @VD2_LOCAL  ,    @VD2_DOC    ,     @VD2_EMISSAO,   @VD2_GRUPO  
                    ,   @VD2_TP     ,     @VD2_SERIE  ,    @VD2_CUSTO1 ,    @VD2_CUSTO2 ,    @VD2_CUSTO3 ,    @VD2_CUSTO4 ,     @VD2_CUSTO5 ,   @VD2_PRUNIT 
                    ,   @VD2_QTSEGUM,     @VD2_NUMSEQ ,    @VD2_EST    ,    @VD2_DESCON ,    @VD2_TIPO   ,    @VD2_NFORI  ,     @VD2_SERIORI,   @VD2_QTDEDEV
                    ,   @VD2_VALDEV ,     @VD2_ORIGLAN,    @VD2_BRICMS ,    @VD2_BASEORI,    @VD2_BASEICM,    @VD2_VALACRS,     @VD2_IDENTB6,   @VD2_ITEM   
                    ,   @VD2_CODISS ,     @VD2_GRADE  ,    @VD2_SEQCALC,    @VD2_ICMSRET,    @VD2_COMIS1 ,    @VD2_COMIS2 ,     @VD2_COMIS3 ,   @VD2_COMIS4 
                    ,   @VD2_COMIS5 ,     @VD2_LOTECTL,    @VD2_NUMLOTE,    @VD2_DTVALID,    @VD2_DESCZFR,    @VD2_PDV    ,     @VD2_NUMSERI,   @VD2_DTLCTCT
                    ,   @VD2_CUSFF1 ,     @VD2_CUSFF2 ,    @VD2_CUSFF3 ,    @VD2_CUSFF4 ,    @VD2_CUSFF5 ,    @VD2_CLASFIS,     @VD2_BASIMP1,   @VD2_BASIMP2
                    ,   @VD2_BASIMP3,     @VD2_BASIMP4,    @VD2_BASIMP5,    @VD2_BASIMP6,    @VD2_VALIMP1,    @VD2_VALIMP2,     @VD2_VALIMP3,   @VD2_VALIMP4
                    ,   @VD2_VALIMP5,     @VD2_VALIMP6,    @VD2_ITEMORI,    @VD2_CODFAB ,    @VD2_LOJAFA ,    @VD2_ALIQINS,     @VD2_ALIQISS,   @VD2_BASEINS
                    ,   @VD2_BASEIPI,     @VD2_BASEISS,    @VD2_CCUSTO ,    @VD2_DESPESA,    @VD2_ENVCNAB,    @VD2_ITEMCC ,     @VD2_LOCALIZ,   @VD2_PREEMB  
                    ,   @VD2_SEGURO ,     @VD2_VALFRE ,    @VD2_VALINS ,    @VD2_VALISS ,    @VD2_CLVL   ,    @VD2_ICMFRET,     @VD2_SERVIC ,   @VD2_STSERV  
                    ,   @VD2_PROJPMS,     @VD2_TASKPMS,    @VD2_LICITA ,    @VD2_REMITO ,    @VD2_SERIREM,    @VD2_ITEMREM,     @VD2_ALQIMP1,   @VD2_ALQIMP2
                    ,   @VD2_ALQIMP3,     @VD2_ALQIMP4,    @VD2_ALQIMP5,    @VD2_ALQIMP6,    @VD2_TPDCENV,    @VD2_OK     ,     @VD2_EDTPMS ,   @VD2_VARPRUN
                    ,   @VD2_FORMUL ,     @VD2_TIPODOC,    @VD2_VAC    ,    @VD2_TIPOREM,    @VD2_QTDEFAT,    @VD2_QTDAFAT,     @VD2_SEQUEN ,   @VD2_POTENCI
                    ,   @VD2_DESCICM,     @VD2_BASEPS3,    @VD2_ALIQPS3,    @VD2_VALPS3 ,    @VD2_BASECF3,    @VD2_ALIQCF3,     @VD2_VALCF3 ,   @VD_E_L_E_T_ 
                    ,   @VR_E_C_N_O_,     @VR_E_C_D_E_L_,  @VD2_OP     ,    @VD2_TPESTR ,    @VD2_VALBRUT,    @VD2_REGWMS ,     @VD2_DTDIGIT,   @VD2_NUMCP   
                    ,   @VD2_CFPS   

                 WHILE @@FETCH_STATUS = 0
                 BEGIN

                    EXEC [dbo].[MERCP_SD2010] 0, @VD2_FILIAL ,     @VD2_COD    ,    @VD2_UM     ,    @VD2_SEGUM  ,    @VD2_QUANT  ,    @VD2_PRCVEN ,     @VD2_TOTAL  ,   @VD2_VALIPI 
                            ,   @VD2_VALICM ,     @VD2_TES    ,    @VD2_CF     ,    @VD2_DESC   ,    @VD2_IPI    ,    @VD2_PICM   ,     @VD2_PESO   ,   @VD2_CONTA   
                            ,   @VD2_PEDIDO ,     @VD2_ITEMPV ,    @VD2_CLIENTE,    @VD2_LOJA   ,    @VD2_LOCAL  ,    @VD2_DOC    ,     @VD2_EMISSAO,   @VD2_GRUPO  
                            ,   @VD2_TP     ,     @VD2_SERIE  ,    @VD2_CUSTO1 ,    @VD2_CUSTO2 ,    @VD2_CUSTO3 ,    @VD2_CUSTO4 ,     @VD2_CUSTO5 ,   @VD2_PRUNIT 
                            ,   @VD2_QTSEGUM,     @VD2_NUMSEQ ,    @VD2_EST    ,    @VD2_DESCON ,    @VD2_TIPO   ,    @VD2_NFORI  ,     @VD2_SERIORI,   @VD2_QTDEDEV
                            ,   @VD2_VALDEV ,     @VD2_ORIGLAN,    @VD2_BRICMS ,    @VD2_BASEORI,    @VD2_BASEICM,    @VD2_VALACRS,     @VD2_IDENTB6,   @VD2_ITEM   
                            ,   @VD2_CODISS ,     @VD2_GRADE  ,    @VD2_SEQCALC,    @VD2_ICMSRET,    @VD2_COMIS1 ,    @VD2_COMIS2 ,     @VD2_COMIS3 ,   @VD2_COMIS4 
                            ,   @VD2_COMIS5 ,     @VD2_LOTECTL,    @VD2_NUMLOTE,    @VD2_DTVALID,    @VD2_DESCZFR,    @VD2_PDV    ,     @VD2_NUMSERI,   @VD2_DTLCTCT
                            ,   @VD2_CUSFF1 ,     @VD2_CUSFF2 ,    @VD2_CUSFF3 ,    @VD2_CUSFF4 ,    @VD2_CUSFF5 ,    @VD2_CLASFIS,     @VD2_BASIMP1,   @VD2_BASIMP2
                            ,   @VD2_BASIMP3,     @VD2_BASIMP4,    @VD2_BASIMP5,    @VD2_BASIMP6,    @VD2_VALIMP1,    @VD2_VALIMP2,     @VD2_VALIMP3,   @VD2_VALIMP4
                            ,   @VD2_VALIMP5,     @VD2_VALIMP6,    @VD2_ITEMORI,    @VD2_CODFAB ,    @VD2_LOJAFA ,    @VD2_ALIQINS,     @VD2_ALIQISS,   @VD2_BASEINS
                            ,   @VD2_BASEIPI,     @VD2_BASEISS,    @VD2_CCUSTO ,    @VD2_DESPESA,    @VD2_ENVCNAB,    @VD2_ITEMCC ,     @VD2_LOCALIZ,   @VD2_PREEMB  
                            ,   @VD2_SEGURO ,     @VD2_VALFRE ,    @VD2_VALINS ,    @VD2_VALISS ,    @VD2_CLVL   ,    @VD2_ICMFRET,     @VD2_SERVIC ,   @VD2_STSERV  
                            ,   @VD2_PROJPMS,     @VD2_TASKPMS,    @VD2_LICITA ,    @VD2_REMITO ,    @VD2_SERIREM,    @VD2_ITEMREM,     @VD2_ALQIMP1,   @VD2_ALQIMP2
                            ,   @VD2_ALQIMP3,     @VD2_ALQIMP4,    @VD2_ALQIMP5,    @VD2_ALQIMP6,    @VD2_TPDCENV,    @VD2_OK     ,     @VD2_EDTPMS ,   @VD2_VARPRUN
                            ,   @VD2_FORMUL ,     @VD2_TIPODOC,    @VD2_VAC    ,    @VD2_TIPOREM,    @VD2_QTDEFAT,    @VD2_QTDAFAT,     @VD2_SEQUEN ,   @VD2_POTENCI
                            ,   @VD2_DESCICM,     @VD2_BASEPS3,    @VD2_ALIQPS3,    @VD2_VALPS3 ,    @VD2_BASECF3,    @VD2_ALIQCF3,     @VD2_VALCF3 ,   @VD_E_L_E_T_ 
                            ,   @VR_E_C_N_O_,     @VR_E_C_D_E_L_,  @VD2_OP     ,    @VD2_TPESTR ,    @VD2_VALBRUT,    @VD2_REGWMS ,     @VD2_DTDIGIT,   @VD2_NUMCP   
                            ,   @VD2_CFPS   


                    FETCH NEXT FROM @C_NOTA_PROD
                      INTO  @VD2_FILIAL ,     @VD2_COD    ,    @VD2_UM     ,    @VD2_SEGUM  ,    @VD2_QUANT  ,    @VD2_PRCVEN ,     @VD2_TOTAL  ,   @VD2_VALIPI 
                        ,   @VD2_VALICM ,     @VD2_TES    ,    @VD2_CF     ,    @VD2_DESC   ,    @VD2_IPI    ,    @VD2_PICM   ,     @VD2_PESO   ,   @VD2_CONTA   
                        ,   @VD2_PEDIDO ,     @VD2_ITEMPV ,    @VD2_CLIENTE,    @VD2_LOJA   ,    @VD2_LOCAL  ,    @VD2_DOC    ,     @VD2_EMISSAO,   @VD2_GRUPO  
                        ,   @VD2_TP     ,     @VD2_SERIE  ,    @VD2_CUSTO1 ,    @VD2_CUSTO2 ,    @VD2_CUSTO3 ,    @VD2_CUSTO4 ,     @VD2_CUSTO5 ,   @VD2_PRUNIT 
                        ,   @VD2_QTSEGUM,     @VD2_NUMSEQ ,    @VD2_EST    ,    @VD2_DESCON ,    @VD2_TIPO   ,    @VD2_NFORI  ,     @VD2_SERIORI,   @VD2_QTDEDEV
                        ,   @VD2_VALDEV ,     @VD2_ORIGLAN,    @VD2_BRICMS ,    @VD2_BASEORI,    @VD2_BASEICM,    @VD2_VALACRS,     @VD2_IDENTB6,   @VD2_ITEM   
                        ,   @VD2_CODISS ,     @VD2_GRADE  ,    @VD2_SEQCALC,    @VD2_ICMSRET,    @VD2_COMIS1 ,    @VD2_COMIS2 ,     @VD2_COMIS3 ,   @VD2_COMIS4 
                        ,   @VD2_COMIS5 ,     @VD2_LOTECTL,    @VD2_NUMLOTE,    @VD2_DTVALID,    @VD2_DESCZFR,    @VD2_PDV    ,     @VD2_NUMSERI,   @VD2_DTLCTCT
                        ,   @VD2_CUSFF1 ,     @VD2_CUSFF2 ,    @VD2_CUSFF3 ,    @VD2_CUSFF4 ,    @VD2_CUSFF5 ,    @VD2_CLASFIS,     @VD2_BASIMP1,   @VD2_BASIMP2
                        ,   @VD2_BASIMP3,     @VD2_BASIMP4,    @VD2_BASIMP5,    @VD2_BASIMP6,    @VD2_VALIMP1,    @VD2_VALIMP2,     @VD2_VALIMP3,   @VD2_VALIMP4
                        ,   @VD2_VALIMP5,     @VD2_VALIMP6,    @VD2_ITEMORI,    @VD2_CODFAB ,    @VD2_LOJAFA ,    @VD2_ALIQINS,     @VD2_ALIQISS,   @VD2_BASEINS
                        ,   @VD2_BASEIPI,     @VD2_BASEISS,    @VD2_CCUSTO ,    @VD2_DESPESA,    @VD2_ENVCNAB,    @VD2_ITEMCC ,     @VD2_LOCALIZ,   @VD2_PREEMB  
                        ,   @VD2_SEGURO ,     @VD2_VALFRE ,    @VD2_VALINS ,    @VD2_VALISS ,    @VD2_CLVL   ,    @VD2_ICMFRET,     @VD2_SERVIC ,   @VD2_STSERV  
                        ,   @VD2_PROJPMS,     @VD2_TASKPMS,    @VD2_LICITA ,    @VD2_REMITO ,    @VD2_SERIREM,    @VD2_ITEMREM,     @VD2_ALQIMP1,   @VD2_ALQIMP2
                        ,   @VD2_ALQIMP3,     @VD2_ALQIMP4,    @VD2_ALQIMP5,    @VD2_ALQIMP6,    @VD2_TPDCENV,    @VD2_OK     ,     @VD2_EDTPMS ,   @VD2_VARPRUN
                        ,   @VD2_FORMUL ,     @VD2_TIPODOC,    @VD2_VAC    ,    @VD2_TIPOREM,    @VD2_QTDEFAT,    @VD2_QTDAFAT,     @VD2_SEQUEN ,   @VD2_POTENCI
                        ,   @VD2_DESCICM,     @VD2_BASEPS3,    @VD2_ALIQPS3,    @VD2_VALPS3 ,    @VD2_BASECF3,    @VD2_ALIQCF3,     @VD2_VALCF3 ,   @VD_E_L_E_T_ 
                        ,   @VR_E_C_N_O_,     @VR_E_C_D_E_L_,  @VD2_OP     ,    @VD2_TPESTR ,    @VD2_VALBRUT,    @VD2_REGWMS ,     @VD2_DTDIGIT,   @VD2_NUMCP   
                        ,   @VD2_CFPS   
                 END

                 CLOSE @C_NOTA_PROD
                 DEALLOCATE @C_NOTA_PROD

            END;
           ---------------------------
           ---- FIM 37 - NOTAS FISCAIS VENDA
           ---------------------------



           ---------------------------
           ---- 35 - NOTAS FISCAIS DEVOLUCAO
           ----        Notas de Vendas sempre carrega a capa (db_nota_fiscal = SF1) e itens (db_nota_prod = SD1)
           ---------------------------
           IF @P_TIPO = 35
           BEGIN
               SELECT @VF1_FILIAL  = F1_FILIAL ,@VF1_DOC     = F1_DOC    ,@VF1_SERIE   = F1_SERIE  ,@VF1_FORNECE = F1_FORNECE,@VF1_LOJA    = F1_LOJA   
                ,     @VF1_COND    = F1_COND   ,@VF1_DUPL    = F1_DUPL   ,@VF1_EMISSAO = F1_EMISSAO,@VF1_EST     = F1_EST    ,@VF1_FRETE   = F1_FRETE  
                ,     @VF1_DESPESA = F1_DESPESA,@VF1_BASEICM = F1_BASEICM,@VF1_VALICM  = F1_VALICM ,@VF1_BASEIPI = F1_BASEIPI,@VF1_VALIPI  = F1_VALIPI 
                ,     @VF1_VALMERC = F1_VALMERC,@VF1_VALBRUT = F1_VALBRUT,@VF1_TIPO    = F1_TIPO   ,@VF1_DESCONT = F1_DESCONT,@VF1_DTDIGIT = F1_DTDIGIT
                ,     @VF1_CPROVA  = F1_CPROVA ,@VF1_BRICMS  = F1_BRICMS ,@VF1_ICMSRET = F1_ICMSRET,@VF1_BASEFD  = F1_BASEFD ,@VF1_DTLANC  = F1_DTLANC 
                ,     @VF1_OK      = F1_OK     ,@VF1_ORIGLAN = F1_ORIGLAN,@VF1_TX      = F1_TX     ,@VF1_CONTSOC = F1_CONTSOC,@VF1_IRRF    = F1_IRRF   
                ,     @VF1_FORMUL  = F1_FORMUL ,@VF1_NFORIG  = F1_NFORIG ,@VF1_SERORIG = F1_SERORIG,@VF1_ESPECIE = F1_ESPECIE,@VF1_IMPORT  = F1_IMPORT 
                ,     @VF1_II      = F1_II     ,@VF1_REMITO  = F1_REMITO ,@VF1_BASIMP2 = F1_BASIMP2,@VF1_BASIMP3 = F1_BASIMP3,@VF1_BASIMP4 = F1_BASIMP4
                ,     @VF1_BASIMP5 = F1_BASIMP5,@VF1_BASIMP6 = F1_BASIMP6,@VF1_VALIMP1 = F1_VALIMP1,@VF1_VALIMP2 = F1_VALIMP2,@VF1_VALIMP3 = F1_VALIMP3
                ,     @VF1_VALIMP4 = F1_VALIMP4,@VF1_VALIMP5 = F1_VALIMP5,@VF1_VALIMP6 = F1_VALIMP6,@VF1_ORDPAGO = F1_ORDPAGO,@VF1_HORA    = F1_HORA   
                ,     @VF1_INSS    = F1_INSS   ,@VF1_ISS     = F1_ISS    ,@VF1_BASIMP1 = F1_BASIMP1,@VF1_HAWB    = F1_HAWB   ,@VF1_TIPO_NF = F1_TIPO_NF
                ,     @VF1_IPI     = F1_IPI    ,@VF1_ICMS    = F1_ICMS   ,@VF1_PESOL   = F1_PESOL  ,@VF1_FOB_R   = F1_FOB_R  ,@VF1_SEGURO  = F1_SEGURO 
                ,     @VF1_CIF     = F1_CIF    ,@VF1_MOEDA   = F1_MOEDA  ,@VF1_PREFIXO = F1_PREFIXO,@VF1_STATUS  = F1_STATUS ,@VF1_VALEMB  = F1_VALEMB 
                ,     @VF1_RECBMTO = F1_RECBMTO,@VF1_APROV   = F1_APROV  ,@VF1_CTR_NFC = F1_CTR_NFC,@VF1_TXMOEDA = F1_TXMOEDA,@VF1_PEDVEND = F1_PEDVEND
                ,     @VF1_TIPODOC = F1_TIPODOC,@VF1_TIPOREM = F1_TIPOREM,@VF1_GNR     = F1_GNR    ,@VF1_VALPIS  = F1_VALPIS ,@VF1_VALCOFI = F1_VALCOFI
                ,     @VF1_VALCSLL = F1_VALCSLL,@VF1_BASEPS3 = F1_BASEPS3,@VF1_VALPS3  = F1_VALPS3 ,@VF1_BASECF3 = F1_BASECF3,@VF1_VALCF3  = F1_VALCF3 
                ,     @VF1_NFELETR = F1_NFELETR,@VF1_EMINFE  = F1_EMINFE ,@VF1_HORNFE  = F1_HORNFE ,@VF1_CODNFE  = F1_CODNFE ,@VF1_CREDNFE = F1_CREDNFE
                ,     @VF1_VNAGREG = F1_VNAGREG,@VF1_NUMRPS  = F1_NUMRPS ,@VF1_VALIRF  = F1_VALIRF ,@VF1_NUMMOV  = F1_NUMMOV ,@VF1_RECISS  = F1_RECISS 
                ,     @VF1_FILORIG = F1_FILORIG,@VF1_NUMRA   = F1_NUMRA  ,@VF1_BASEINS = F1_BASEINS,@VF1_DOCFOL  = F1_DOCFOL ,@VF1_VERBAFO = F1_VERBAFO
                ,     @VF1_VALFDS  = F1_VALFDS ,@VF1_CHVNFE  = F1_CHVNFE ,@VF1_ESTCRED = F1_ESTCRED,@VF1_FIMP    = F1_FIMP   ,@VF1_TPFRETE = F1_TPFRETE
                ,     @VF1_TPNFEXP = F1_TPNFEXP,@VF1_NODIA   = F1_NODIA  ,@VF1_DIACTB  = F1_DIACTB ,@VF1_TRANSP  = F1_TRANSP ,@VF1_PLIQUI  = F1_PLIQUI 
                ,     @VF1_PBRUTO  = F1_PBRUTO ,@VF1_ESPECI1 = F1_ESPECI1,@VF1_VOLUME1 = F1_VOLUME1,@VF1_ESPECI2 = F1_ESPECI2,@VF1_VOLUME2 = F1_VOLUME2
                ,     @VF1_ESPECI3 = F1_ESPECI3,@VF1_VOLUME3 = F1_VOLUME3,@VF1_ESPECI4 = F1_ESPECI4,@VF1_VOLUME4 = F1_VOLUME4,@VF1_VALFAB  = F1_VALFAB 
                ,     @VF1_VALFAC  = F1_VALFAC ,@VF1_VALFET  = F1_VALFET ,@VF1_PLACA   = F1_PLACA  ,@VD_E_L_E_T_ = D_E_L_E_T_,@VR_E_C_N_O_ = R_E_C_N_O_
                ,     @VR_E_C_D_E_L_ = R_E_C_D_E_L_
                 FROM INTEGRACAO_PROTHEUS_SF1
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [DBO].[MERCP_SF1010] 0, @VF1_FILIAL ,@VF1_DOC    , @VF1_SERIE ,@VF1_FORNECE,@VF1_LOJA   ,@VF1_COND   ,@VF1_DUPL   ,@VF1_EMISSAO,
                              @VF1_EST    , @VF1_FRETE  ,@VF1_DESPESA,@VF1_BASEICM,@VF1_VALICM ,@VF1_BASEIPI,@VF1_VALIPI ,@VF1_VALMERC,@VF1_VALBRUT,
                              @VF1_TIPO   , @VF1_DESCONT,@VF1_DTDIGIT,@VF1_CPROVA ,@VF1_BRICMS ,@VF1_ICMSRET,@VF1_BASEFD ,@VF1_DTLANC ,@VF1_OK,     
                              @VF1_ORIGLAN, @VF1_TX     ,@VF1_CONTSOC,@VF1_IRRF   ,@VF1_FORMUL ,@VF1_NFORIG ,@VF1_SERORIG,@VF1_ESPECIE,@VF1_IMPORT, 
                              @VF1_II     , @VF1_REMITO ,@VF1_BASIMP2,@VF1_BASIMP3,@VF1_BASIMP4,@VF1_BASIMP5,@VF1_BASIMP6,@VF1_VALIMP1,@VF1_VALIMP2,
                              @VF1_VALIMP3, @VF1_VALIMP4,@VF1_VALIMP5,@VF1_VALIMP6,@VF1_ORDPAGO,@VF1_HORA   ,@VF1_INSS   ,@VF1_ISS    ,@VF1_BASIMP1,
                              @VF1_HAWB   , @VF1_TIPO_NF,@VF1_IPI    ,@VF1_ICMS   ,@VF1_PESOL  ,@VF1_FOB_R  ,@VF1_SEGURO ,@VF1_CIF    ,@VF1_MOEDA,  
                              @VF1_PREFIXO, @VF1_STATUS ,@VF1_VALEMB ,@VF1_RECBMTO,@VF1_APROV  ,@VF1_CTR_NFC,@VF1_TXMOEDA,@VF1_PEDVEND,@VF1_TIPODOC,
                              @VF1_TIPOREM, @VF1_GNR    ,@VF1_VALPIS ,@VF1_VALCOFI,@VF1_VALCSLL,@VF1_BASEPS3,@VF1_VALPS3 ,@VF1_BASECF3,@VF1_VALCF3, 
                              @VF1_NFELETR, @VF1_EMINFE ,@VF1_HORNFE ,@VF1_CODNFE ,@VF1_CREDNFE,@VF1_VNAGREG,@VF1_NUMRPS ,@VF1_VALIRF ,@VF1_NUMMOV, 
                              @VF1_RECISS , @VF1_FILORIG,@VF1_NUMRA  ,@VF1_BASEINS,@VF1_DOCFOL ,@VF1_VERBAFO,@VF1_VALFDS ,@VF1_CHVNFE ,@VF1_ESTCRED,
                              @VF1_FIMP   , @VF1_TPFRETE,@VF1_TPNFEXP,@VF1_NODIA  ,@VF1_DIACTB ,@VF1_TRANSP ,@VF1_PLIQUI ,@VF1_PBRUTO ,@VF1_ESPECI1,
                              @VF1_VOLUME1, @VF1_ESPECI2,@VF1_VOLUME2,@VF1_ESPECI3,@VF1_VOLUME3,@VF1_ESPECI4,@VF1_VOLUME4,@VF1_VALFAB ,@VF1_VALFAC,
                              @VF1_VALFET , @VF1_PLACA  ,@VD_E_L_E_T_,@VR_E_C_N_O_,@VR_E_C_D_E_L_


                --- Busca todos os itens da nota de devolucao que está logada
                SET @C_NOTA_DEV_PROD  = CURSOR STATIC FOR
                
                       SELECT D1_FILIAL   , D1_ITEM     , D1_COD      , D1_UM       , D1_QUANT    , D1_VUNIT    , D1_TOTAL    , D1_LOCAL    
                            , D1_SEGUM    , D1_VALIPI   , D1_VALICM   , D1_TES      , D1_NFORI    , D1_CONTA    , D1_ITEMCTA  , D1_CC       
                            , D1_CLVL     , D1_CF       , D1_DESC     , D1_FORNECE  , D1_LOJA     , D1_IPI      , D1_DOC      , D1_EMISSAO  
                            , D1_DTDIGIT  , D1_PICM     , D1_PESO     , D1_SERIE    , D1_OP       , D1_PEDIDO   , D1_ITEMPC   , D1_GRUPO    
                            , D1_TIPO     , D1_CUSTO2   , D1_NUMSEQ   , D1_CUSTO3   , D1_CUSTO4   , D1_CUSTO5   , D1_ITEMORI  , D1_TP       
                            , D1_QTSEGUM  , D1_ORIGLAN  , D1_DATACUS  , D1_SERIORI  , D1_NUMCQ    , D1_QTDEDEV  , D1_VALDEV   , D1_ICMSRET  
                            , D1_IDENTB6  , D1_BRICMS   , D1_SKIPLOT  , D1_DATORI   , D1_SEQCALC  , D1_BASEICM  , D1_VALDESC  , D1_LOTEFOR  
                            , D1_BASEIPI  , D1_LOTECTL  , D1_NUMLOTE  , D1_DTVALID  , D1_PLACA    , D1_CHASSI   , D1_ANOFAB   , D1_MODFAB   
                            , D1_FORMUL   , D1_MODELO   , D1_COMBUST  , D1_COR      , D1_NUMPV    , D1_ITEMPV   , D1_EQUIPS   , D1_II       
                            , D1_TEC      , D1_CONHEC   , D1_CUSFF1   , D1_CUSFF2   , D1_CLASFIS  , D1_CUSFF3   , D1_REMITO   , D1_SERIREM  
                            , D1_CUSFF4   , D1_CUSFF5   , D1_CODCIAP  , D1_BASIMP1  , D1_CUSTO    , D1_BASIMP3  , D1_BASIMP4  , D1_BASIMP5  
                            , D1_BASIMP6  , D1_VALIMP1  , D1_VALIMP2  , D1_VALIMP3  , D1_VALIMP4  , D1_CIF      , D1_ITEMREM  , D1_VALIMP5  
                            , D1_TIPO_NF  , D1_VALIMP6  , D1_CBASEAF  , D1_ICMSCOM  , D1_BASIMP2  , D1_ALQIMP1  , D1_ALQIMP2  , D1_ALQIMP3  
                            , D1_ALQIMP4  , D1_ALQIMP5  , D1_ALQIMP6  , D1_QTDPEDI  , D1_VALFRE   , D1_RATEIO   , D1_SEGURO   , D1_DESPESA  
                            , D1_BASEIRR  , D1_ALIQIRR  , D1_VALIRR   , D1_BASEISS  , D1_ALIQISS  , D1_CUSORI   , D1_VALISS   , D1_BASEINS  
                            , D1_ALIQINS  , D1_VALINS   , D1_VALACRS  , D1_LOCPAD   , D1_ORDEM    , D1_SERVIC   , D1_STSERV   , D1_ENDER    
                            , D1_TIPODOC  , D1_REGWMS   , D1_POTENCI  , D1_TRT      , D1_GRADE    , D1_ITEMGRD  , D1_TESACLA  , D1_PRUNDA   
                            , D1_BASEPS3  , D1_ALIQPS3  , D1_VALPS3   , D1_BASECF3  , D1_ALIQCF3  , D1_VALCF3   , D1_CODISS   , D1_CFPS     
                            , D1_NUMDESP  , D1_ORIGEM   , D1_DESCICM  , D1_BASESES  , D1_VALSES   , D1_ALIQSES  , D1_RGESPST  , D1_ABATISS  
                            , D1_ABATMAT  , D1_BASNDES  , D1_ICMNDES  , D1_VALFDS   , D1_PRFDSUL  , D1_UFERMS   , D1_ESTCRED  , D1_VALANTI  
                            , D1_CRPRSIM  , D1_ALIQSOL  , D1_CRPRESC  , D1_ALIQII   , D1_MARGEM   , D1_SLDDEP   , D1_NFVINC   , D1_SERVINC  
                            , D1_ITMVINC  , D1_ICMSDIF  , D1_GARANTI  , D1_PCCENTR  , D1_ITPCCEN  , D1_QTPCCEN  , D1_DFABRIC  , D1_ABATINS  
                            , D1_BASEFAB  , D1_ALIQFAB  , D1_VALFAB   , D1_BASEFAC  , D1_ALIQFAC  , D1_VALFAC   , D1_BASEFET  , D1_ALIQFET  
                            , D1_VALFET   , D1_CODLAN   , D1_AVLINSS  , D_E_L_E_T_  , R_E_C_N_O_  , R_E_C_D_E_L_ 
                         FROM INTEGRACAO_PROTHEUS_SD1
                        WHERE D1_FILIAL = @VF1_FILIAL
                          AND D1_DOC    = @VF1_DOC

                  OPEN @C_NOTA_DEV_PROD
                 FETCH NEXT FROM @C_NOTA_DEV_PROD
                  INTO  @VD1_FILIAL ,     @VD1_ITEM   ,    @VD1_COD    ,    @VD1_UM     ,    @VD1_QUANT  ,    @VD1_VUNIT  ,     @VD1_TOTAL  ,   @VD1_LOCAL   
                    ,   @VD1_SEGUM  ,     @VD1_VALIPI ,    @VD1_VALICM ,    @VD1_TES    ,    @VD1_NFORI  ,    @VD1_CONTA  ,     @VD1_ITEMCTA,   @VD1_CC      
                    ,   @VD1_CLVL   ,     @VD1_CF     ,    @VD1_DESC   ,    @VD1_FORNECE,    @VD1_LOJA   ,    @VD1_IPI    ,     @VD1_DOC    ,   @VD1_EMISSAO 
                    ,   @VD1_DTDIGIT,     @VD1_PICM   ,    @VD1_PESO   ,    @VD1_SERIE  ,    @VD1_OP     ,    @VD1_PEDIDO ,     @VD1_ITEMPC ,   @VD1_GRUPO   
                    ,   @VD1_TIPO   ,     @VD1_CUSTO2 ,    @VD1_NUMSEQ ,    @VD1_CUSTO3 ,    @VD1_CUSTO4 ,    @VD1_CUSTO5 ,     @VD1_ITEMORI,   @VD1_TP      
                    ,   @VD1_QTSEGUM,     @VD1_ORIGLAN,    @VD1_DATACUS,    @VD1_SERIORI,    @VD1_NUMCQ  ,    @VD1_QTDEDEV,     @VD1_VALDEV ,   @VD1_ICMSRET 
                    ,   @VD1_IDENTB6,     @VD1_BRICMS ,    @VD1_SKIPLOT,    @VD1_DATORI ,    @VD1_SEQCALC,    @VD1_BASEICM,     @VD1_VALDESC,   @VD1_LOTEFOR 
                    ,   @VD1_BASEIPI,     @VD1_LOTECTL,    @VD1_NUMLOTE,    @VD1_DTVALID,    @VD1_PLACA  ,    @VD1_CHASSI ,     @VD1_ANOFAB ,   @VD1_MODFAB  
                    ,   @VD1_FORMUL ,     @VD1_MODELO ,    @VD1_COMBUST,    @VD1_COR    ,    @VD1_NUMPV  ,    @VD1_ITEMPV ,     @VD1_EQUIPS ,   @VD1_II      
                    ,   @VD1_TEC    ,     @VD1_CONHEC ,    @VD1_CUSFF1 ,    @VD1_CUSFF2 ,    @VD1_CLASFIS,    @VD1_CUSFF3 ,     @VD1_REMITO ,   @VD1_SERIREM 
                    ,   @VD1_CUSFF4 ,     @VD1_CUSFF5 ,    @VD1_CODCIAP,    @VD1_BASIMP1,    @VD1_CUSTO  ,    @VD1_BASIMP3,     @VD1_BASIMP4,   @VD1_BASIMP5 
                    ,   @VD1_BASIMP6,     @VD1_VALIMP1,    @VD1_VALIMP2,    @VD1_VALIMP3,    @VD1_VALIMP4,    @VD1_CIF    ,     @VD1_ITEMREM,   @VD1_VALIMP5 
                    ,   @VD1_TIPO_NF,     @VD1_VALIMP6,    @VD1_CBASEAF,    @VD1_ICMSCOM,    @VD1_BASIMP2,    @VD1_ALQIMP1,     @VD1_ALQIMP2,   @VD1_ALQIMP3 
                    ,   @VD1_ALQIMP4,     @VD1_ALQIMP5,    @VD1_ALQIMP6,    @VD1_QTDPEDI,    @VD1_VALFRE ,    @VD1_RATEIO ,     @VD1_SEGURO ,   @VD1_DESPESA 
                    ,   @VD1_BASEIRR,     @VD1_ALIQIRR,    @VD1_VALIRR ,    @VD1_BASEISS,    @VD1_ALIQISS,    @VD1_CUSORI ,     @VD1_VALISS ,   @VD1_BASEINS 
                    ,   @VD1_ALIQINS,     @VD1_VALINS ,    @VD1_VALACRS,    @VD1_LOCPAD ,    @VD1_ORDEM  ,    @VD1_SERVIC ,     @VD1_STSERV ,   @VD1_ENDER   
                    ,   @VD1_TIPODOC,     @VD1_REGWMS ,    @VD1_POTENCI,    @VD1_TRT    ,    @VD1_GRADE  ,    @VD1_ITEMGRD,     @VD1_TESACLA,   @VD1_PRUNDA  
                    ,   @VD1_BASEPS3,     @VD1_ALIQPS3,    @VD1_VALPS3 ,    @VD1_BASECF3,    @VD1_ALIQCF3,    @VD1_VALCF3 ,     @VD1_CODISS ,   @VD1_CFPS    
                    ,   @VD1_NUMDESP,     @VD1_ORIGEM ,    @VD1_DESCICM,    @VD1_BASESES,    @VD1_VALSES ,    @VD1_ALIQSES,     @VD1_RGESPST,   @VD1_ABATISS 
                    ,   @VD1_ABATMAT,     @VD1_BASNDES,    @VD1_ICMNDES,    @VD1_VALFDS ,    @VD1_PRFDSUL,    @VD1_UFERMS ,     @VD1_ESTCRED,   @VD1_VALANTI 
                    ,   @VD1_CRPRSIM,     @VD1_ALIQSOL,    @VD1_CRPRESC,    @VD1_ALIQII ,    @VD1_MARGEM ,    @VD1_SLDDEP ,     @VD1_NFVINC ,   @VD1_SERVINC 
                    ,   @VD1_ITMVINC,     @VD1_ICMSDIF,    @VD1_GARANTI,    @VD1_PCCENTR,    @VD1_ITPCCEN,    @VD1_QTPCCEN,     @VD1_DFABRIC,   @VD1_ABATINS 
                    ,   @VD1_BASEFAB,     @VD1_ALIQFAB,    @VD1_VALFAB ,    @VD1_BASEFAC,    @VD1_ALIQFAC,    @VD1_VALFAC ,     @VD1_BASEFET,   @VD1_ALIQFET 
                    ,   @VD1_VALFET ,     @VD1_CODLAN ,    @VD1_AVLINSS,    @VD_E_L_E_T_,    @VR_E_C_N_O_ ,   @VR_E_C_D_E_L_

                 WHILE @@FETCH_STATUS = 0
                 BEGIN

                    EXEC [dbo].[MERCP_SD1010] 0, @VD1_FILIAL ,     @VD1_ITEM   ,    @VD1_COD    ,    @VD1_UM     ,    @VD1_QUANT  ,    @VD1_VUNIT  ,     @VD1_TOTAL  ,   @VD1_LOCAL   
                            ,   @VD1_SEGUM  ,     @VD1_VALIPI ,    @VD1_VALICM ,    @VD1_TES    ,    @VD1_NFORI  ,    @VD1_CONTA  ,     @VD1_ITEMCTA,   @VD1_CC      
                            ,   @VD1_CLVL   ,     @VD1_CF     ,    @VD1_DESC   ,    @VD1_FORNECE,    @VD1_LOJA   ,    @VD1_IPI    ,     @VD1_DOC    ,   @VD1_EMISSAO 
                            ,   @VD1_DTDIGIT,     @VD1_PICM   ,    @VD1_PESO   ,    @VD1_SERIE  ,    @VD1_OP     ,    @VD1_PEDIDO ,     @VD1_ITEMPC ,   @VD1_GRUPO   
                            ,   @VD1_TIPO   ,     @VD1_CUSTO2 ,    @VD1_NUMSEQ ,    @VD1_CUSTO3 ,    @VD1_CUSTO4 ,    @VD1_CUSTO5 ,     @VD1_ITEMORI,   @VD1_TP      
                            ,   @VD1_QTSEGUM,     @VD1_ORIGLAN,    @VD1_DATACUS,    @VD1_SERIORI,    @VD1_NUMCQ  ,    @VD1_QTDEDEV,     @VD1_VALDEV ,   @VD1_ICMSRET 
                            ,   @VD1_IDENTB6,     @VD1_BRICMS ,    @VD1_SKIPLOT,    @VD1_DATORI ,    @VD1_SEQCALC,    @VD1_BASEICM,     @VD1_VALDESC,   @VD1_LOTEFOR 
                            ,   @VD1_BASEIPI,     @VD1_LOTECTL,    @VD1_NUMLOTE,    @VD1_DTVALID,    @VD1_PLACA  ,    @VD1_CHASSI ,     @VD1_ANOFAB ,   @VD1_MODFAB  
                            ,   @VD1_FORMUL ,     @VD1_MODELO ,    @VD1_COMBUST,    @VD1_COR    ,    @VD1_NUMPV  ,    @VD1_ITEMPV ,     @VD1_EQUIPS ,   @VD1_II      
                            ,   @VD1_TEC    ,     @VD1_CONHEC ,    @VD1_CUSFF1 ,    @VD1_CUSFF2 ,    @VD1_CLASFIS,    @VD1_CUSFF3 ,     @VD1_REMITO ,   @VD1_SERIREM 
                            ,   @VD1_CUSFF4 ,     @VD1_CUSFF5 ,    @VD1_CODCIAP,    @VD1_BASIMP1,    @VD1_CUSTO  ,    @VD1_BASIMP3,     @VD1_BASIMP4,   @VD1_BASIMP5 
                            ,   @VD1_BASIMP6,     @VD1_VALIMP1,    @VD1_VALIMP2,    @VD1_VALIMP3,    @VD1_VALIMP4,    @VD1_CIF    ,     @VD1_ITEMREM,   @VD1_VALIMP5 
                            ,   @VD1_TIPO_NF,     @VD1_VALIMP6,    @VD1_CBASEAF,    @VD1_ICMSCOM,    @VD1_BASIMP2,    @VD1_ALQIMP1,     @VD1_ALQIMP2,   @VD1_ALQIMP3 
                            ,   @VD1_ALQIMP4,     @VD1_ALQIMP5,    @VD1_ALQIMP6,    @VD1_QTDPEDI,    @VD1_VALFRE ,    @VD1_RATEIO ,     @VD1_SEGURO ,   @VD1_DESPESA 
                            ,   @VD1_BASEIRR,     @VD1_ALIQIRR,    @VD1_VALIRR ,    @VD1_BASEISS,    @VD1_ALIQISS,    @VD1_CUSORI ,     @VD1_VALISS ,   @VD1_BASEINS 
                            ,   @VD1_ALIQINS,     @VD1_VALINS ,    @VD1_VALACRS,    @VD1_LOCPAD ,    @VD1_ORDEM  ,    @VD1_SERVIC ,     @VD1_STSERV ,   @VD1_ENDER   
                            ,   @VD1_TIPODOC,     @VD1_REGWMS ,    @VD1_POTENCI,    @VD1_TRT    ,    @VD1_GRADE  ,    @VD1_ITEMGRD,     @VD1_TESACLA,   @VD1_PRUNDA  
                            ,   @VD1_BASEPS3,     @VD1_ALIQPS3,    @VD1_VALPS3 ,    @VD1_BASECF3,    @VD1_ALIQCF3,    @VD1_VALCF3 ,     @VD1_CODISS ,   @VD1_CFPS    
                            ,   @VD1_NUMDESP,     @VD1_ORIGEM ,    @VD1_DESCICM,    @VD1_BASESES,    @VD1_VALSES ,    @VD1_ALIQSES,     @VD1_RGESPST,   @VD1_ABATISS 
                            ,   @VD1_ABATMAT,     @VD1_BASNDES,    @VD1_ICMNDES,    @VD1_VALFDS ,    @VD1_PRFDSUL,    @VD1_UFERMS ,     @VD1_ESTCRED,   @VD1_VALANTI 
                            ,   @VD1_CRPRSIM,     @VD1_ALIQSOL,    @VD1_CRPRESC,    @VD1_ALIQII ,    @VD1_MARGEM ,    @VD1_SLDDEP ,     @VD1_NFVINC ,   @VD1_SERVINC 
                            ,   @VD1_ITMVINC,     @VD1_ICMSDIF,    @VD1_GARANTI,    @VD1_PCCENTR,    @VD1_ITPCCEN,    @VD1_QTPCCEN,     @VD1_DFABRIC,   @VD1_ABATINS 
                            ,   @VD1_BASEFAB,     @VD1_ALIQFAB,    @VD1_VALFAB ,    @VD1_BASEFAC,    @VD1_ALIQFAC,    @VD1_VALFAC ,     @VD1_BASEFET,   @VD1_ALIQFET 
                            ,   @VD1_VALFET ,     @VD1_CODLAN ,    @VD1_AVLINSS,    @VD_E_L_E_T_,    @VR_E_C_N_O_ ,   @VR_E_C_D_E_L_


                    FETCH NEXT FROM @C_NOTA_DEV_PROD
                      INTO  @VD1_FILIAL ,     @VD1_ITEM   ,    @VD1_COD    ,    @VD1_UM     ,    @VD1_QUANT  ,    @VD1_VUNIT  ,     @VD1_TOTAL  ,   @VD1_LOCAL   
                        ,   @VD1_SEGUM  ,     @VD1_VALIPI ,    @VD1_VALICM ,    @VD1_TES    ,    @VD1_NFORI  ,    @VD1_CONTA  ,     @VD1_ITEMCTA,   @VD1_CC      
                        ,   @VD1_CLVL   ,     @VD1_CF     ,    @VD1_DESC   ,    @VD1_FORNECE,    @VD1_LOJA   ,    @VD1_IPI    ,     @VD1_DOC    ,   @VD1_EMISSAO 
                        ,   @VD1_DTDIGIT,     @VD1_PICM   ,    @VD1_PESO   ,    @VD1_SERIE  ,    @VD1_OP     ,    @VD1_PEDIDO ,     @VD1_ITEMPC ,   @VD1_GRUPO   
                        ,   @VD1_TIPO   ,     @VD1_CUSTO2 ,    @VD1_NUMSEQ ,    @VD1_CUSTO3 ,    @VD1_CUSTO4 ,    @VD1_CUSTO5 ,     @VD1_ITEMORI,   @VD1_TP      
                        ,   @VD1_QTSEGUM,     @VD1_ORIGLAN,    @VD1_DATACUS,    @VD1_SERIORI,    @VD1_NUMCQ  ,    @VD1_QTDEDEV,     @VD1_VALDEV ,   @VD1_ICMSRET 
                        ,   @VD1_IDENTB6,     @VD1_BRICMS ,    @VD1_SKIPLOT,    @VD1_DATORI ,    @VD1_SEQCALC,    @VD1_BASEICM,     @VD1_VALDESC,   @VD1_LOTEFOR 
                        ,   @VD1_BASEIPI,     @VD1_LOTECTL,    @VD1_NUMLOTE,    @VD1_DTVALID,    @VD1_PLACA  ,    @VD1_CHASSI ,     @VD1_ANOFAB ,   @VD1_MODFAB  
                        ,   @VD1_FORMUL ,     @VD1_MODELO ,    @VD1_COMBUST,    @VD1_COR    ,    @VD1_NUMPV  ,    @VD1_ITEMPV ,     @VD1_EQUIPS ,   @VD1_II      
                        ,   @VD1_TEC    ,     @VD1_CONHEC ,    @VD1_CUSFF1 ,    @VD1_CUSFF2 ,    @VD1_CLASFIS,    @VD1_CUSFF3 ,     @VD1_REMITO ,   @VD1_SERIREM 
                        ,   @VD1_CUSFF4 ,     @VD1_CUSFF5 ,    @VD1_CODCIAP,    @VD1_BASIMP1,    @VD1_CUSTO  ,    @VD1_BASIMP3,     @VD1_BASIMP4,   @VD1_BASIMP5 
                        ,   @VD1_BASIMP6,     @VD1_VALIMP1,    @VD1_VALIMP2,    @VD1_VALIMP3,    @VD1_VALIMP4,    @VD1_CIF    ,     @VD1_ITEMREM,   @VD1_VALIMP5 
                        ,   @VD1_TIPO_NF,     @VD1_VALIMP6,    @VD1_CBASEAF,    @VD1_ICMSCOM,    @VD1_BASIMP2,    @VD1_ALQIMP1,     @VD1_ALQIMP2,   @VD1_ALQIMP3 
                        ,   @VD1_ALQIMP4,     @VD1_ALQIMP5,    @VD1_ALQIMP6,    @VD1_QTDPEDI,    @VD1_VALFRE ,    @VD1_RATEIO ,     @VD1_SEGURO ,   @VD1_DESPESA 
                        ,   @VD1_BASEIRR,     @VD1_ALIQIRR,    @VD1_VALIRR ,    @VD1_BASEISS,    @VD1_ALIQISS,    @VD1_CUSORI ,     @VD1_VALISS ,   @VD1_BASEINS 
                        ,   @VD1_ALIQINS,     @VD1_VALINS ,    @VD1_VALACRS,    @VD1_LOCPAD ,    @VD1_ORDEM  ,    @VD1_SERVIC ,     @VD1_STSERV ,   @VD1_ENDER   
                        ,   @VD1_TIPODOC,     @VD1_REGWMS ,    @VD1_POTENCI,    @VD1_TRT    ,    @VD1_GRADE  ,    @VD1_ITEMGRD,     @VD1_TESACLA,   @VD1_PRUNDA  
                        ,   @VD1_BASEPS3,     @VD1_ALIQPS3,    @VD1_VALPS3 ,    @VD1_BASECF3,    @VD1_ALIQCF3,    @VD1_VALCF3 ,     @VD1_CODISS ,   @VD1_CFPS    
                        ,   @VD1_NUMDESP,     @VD1_ORIGEM ,    @VD1_DESCICM,    @VD1_BASESES,    @VD1_VALSES ,    @VD1_ALIQSES,     @VD1_RGESPST,   @VD1_ABATISS 
                        ,   @VD1_ABATMAT,     @VD1_BASNDES,    @VD1_ICMNDES,    @VD1_VALFDS ,    @VD1_PRFDSUL,    @VD1_UFERMS ,     @VD1_ESTCRED,   @VD1_VALANTI 
                        ,   @VD1_CRPRSIM,     @VD1_ALIQSOL,    @VD1_CRPRESC,    @VD1_ALIQII ,    @VD1_MARGEM ,    @VD1_SLDDEP ,     @VD1_NFVINC ,   @VD1_SERVINC 
                        ,   @VD1_ITMVINC,     @VD1_ICMSDIF,    @VD1_GARANTI,    @VD1_PCCENTR,    @VD1_ITPCCEN,    @VD1_QTPCCEN,     @VD1_DFABRIC,   @VD1_ABATINS 
                        ,   @VD1_BASEFAB,     @VD1_ALIQFAB,    @VD1_VALFAB ,    @VD1_BASEFAC,    @VD1_ALIQFAC,    @VD1_VALFAC ,     @VD1_BASEFET,   @VD1_ALIQFET 
                        ,   @VD1_VALFET ,     @VD1_CODLAN ,    @VD1_AVLINSS,    @VD_E_L_E_T_,    @VR_E_C_N_O_ ,   @VR_E_C_D_E_L_
                 END

                 CLOSE @C_NOTA_DEV_PROD
                 DEALLOCATE @C_NOTA_DEV_PROD

            END;
           ---------------------------
           ---- FIM 35 - NOTAS FISCAIS DEVOLUCAO
           ---------------------------


           ---------------------------
           ---- 50 - TITULOS
           ---------------------------
           IF @P_TIPO = 50
           BEGIN

               SELECT @VE1_FILIAL  = E1_FILIAL  ,@VE1_PREFIXO = E1_PREFIXO ,@VE1_NUM     = E1_NUM     ,@VE1_PARCELA = E1_PARCELA ,@VE1_EMISSAO = E1_EMISSAO, 
                      @VE1_VENCTO  = E1_VENCTO  ,@VE1_VENCREA = E1_VENCREA ,@VE1_CLIENTE = E1_CLIENTE ,@VE1_NOMCLI  = E1_NOMCLI  ,@VE1_VALOR   = E1_VALOR,   
                      @VE1_TIPO    = E1_TIPO    ,@VE1_NATUREZ = E1_NATUREZ ,@VE1_PORTADO = E1_PORTADO ,@VE1_AGEDEP  = E1_AGEDEP  ,@VE1_LOJA    = E1_LOJA,    
                      @VE1_IRRF    = E1_IRRF    ,@VE1_ISS     = E1_ISS     ,@VE1_INSS    = E1_INSS    ,@VE1_NUMBCO  = E1_NUMBCO  ,@VE1_INDICE  = E1_INDICE,  
                      @VE1_BAIXA   = E1_BAIXA   ,@VE1_NUMBOR  = E1_NUMBOR  ,@VE1_DATABOR = E1_DATABOR ,@VE1_EMIS1   = E1_EMIS1   ,@VE1_HIST    = E1_HIST,    
                      @VE1_LA      = E1_LA      ,@VE1_LOTE    = E1_LOTE    ,@VE1_MOTIVO  = E1_MOTIVO  ,@VE1_MOVIMEN = E1_MOVIMEN ,@VE1_OP      = E1_OP,      
                      @VE1_SITUACA = E1_SITUACA ,@VE1_CONTRAT = E1_CONTRAT ,@VE1_SALDO   = E1_SALDO   ,@VE1_SUPERVI = E1_SUPERVI ,@VE1_VEND1   = E1_VEND1,   
                      @VE1_VEND2   = E1_VEND2   ,@VE1_VEND3   = E1_VEND3   ,@VE1_VEND4   = E1_VEND4   ,@VE1_VEND5   = E1_VEND5   ,@VE1_COMIS1  = E1_COMIS1,  
                      @VE1_COMIS2  = E1_COMIS2  ,@VE1_COMIS3  = E1_COMIS3  ,@VE1_COMIS4  = E1_COMIS4  ,@VE1_COMIS5  = E1_COMIS5  ,@VE1_DESCONT = E1_DESCONT, 
                      @VE1_MULTA   = E1_MULTA   ,@VE1_JUROS   = E1_JUROS   ,@VE1_CORREC  = E1_CORREC  ,@VE1_VALLIQ  = E1_VALLIQ  ,@VE1_VENCORI = E1_VENCORI, 
                      @VE1_CONTA   = E1_CONTA   ,@VE1_VALJUR  = E1_VALJUR  ,@VE1_PORCJUR = E1_PORCJUR ,@VE1_MOEDA   = E1_MOEDA   ,@VE1_BASCOM1 = E1_BASCOM1, 
                      @VE1_BASCOM2 = E1_BASCOM2 ,@VE1_BASCOM3 = E1_BASCOM3 ,@VE1_BASCOM4 = E1_BASCOM4 ,@VE1_BASCOM5 = E1_BASCOM5 ,@VE1_OK      = E1_OK,      
                      @VE1_FATPREF = E1_FATPREF ,@VE1_FATURA  = E1_FATURA  ,@VE1_PROJETO = E1_PROJETO ,@VE1_CLASCON = E1_CLASCON ,@VE1_VALCOM1 = E1_VALCOM1, 
                      @VE1_VALCOM2 = E1_VALCOM2 ,@VE1_VALCOM3 = E1_VALCOM3 ,@VE1_VALCOM4 = E1_VALCOM4 ,@VE1_VALCOM5 = E1_VALCOM5 ,@VE1_OCORREN = E1_OCORREN, 
                      @VE1_INSTR1  = E1_INSTR1  ,@VE1_INSTR2  = E1_INSTR2  ,@VE1_PEDIDO  = E1_PEDIDO  ,@VE1_DTVARIA = E1_DTVARIA ,@VE1_VARURV  = E1_VARURV,  
                      @VE1_NUMNOTA = E1_NUMNOTA ,@VE1_SERIE   = E1_SERIE   ,@VE1_VLCRUZ  = E1_VLCRUZ  ,@VE1_DTFATUR = E1_DTFATUR ,@VE1_IDENTEE = E1_IDENTEE, 
                      @VE1_STATUS  = E1_STATUS  ,@VE1_ORIGEM  = E1_ORIGEM  ,@VE1_NUMCART = E1_NUMCART ,@VE1_FLUXO   = E1_FLUXO   ,@VE1_DESCFIN = E1_DESCFIN, 
                      @VE1_DIADESC = E1_DIADESC ,@VE1_CARTAO  = E1_CARTAO  ,@VE1_CARTVAL = E1_CARTVAL ,@VE1_VLRREAL = E1_VLRREAL ,@VE1_CARTAUT = E1_CARTAUT, 
                      @VE1_ADM     = E1_ADM     ,@VE1_TRANSF  = E1_TRANSF  ,@VE1_ORDPAGO = E1_ORDPAGO ,@VE1_BCOCHQ  = E1_BCOCHQ  ,@VE1_AGECHQ  = E1_AGECHQ,  
                      @VE1_CTACHQ  = E1_CTACHQ  ,@VE1_NUMLIQ  = E1_NUMLIQ  ,@VE1_COFINS  = E1_COFINS  ,@VE1_FLAGFAT = E1_FLAGFAT ,@VE1_CSLL    = E1_CSLL,    
                      @VE1_FILORIG = E1_FILORIG ,@VE1_PIS     = E1_PIS     ,@VE1_TIPOFAT = E1_TIPOFAT ,@VE1_TIPOLIQ = E1_TIPOLIQ ,@VE1_MESBASE = E1_MESBASE, 
                      @VE1_ANOBASE = E1_ANOBASE ,@VE1_PLNUCOB = E1_PLNUCOB ,@VE1_CODINT  = E1_CODINT  ,@VE1_CODEMP  = E1_CODEMP  ,@VE1_MATRIC  = E1_MATRIC,  
                      @VE1_ACRESC  = E1_ACRESC  ,@VE1_SDACRES = E1_SDACRES ,@VE1_DECRESC = E1_DECRESC ,@VE1_SDDECRE = E1_SDDECRE ,@VE1_MULTNAT = E1_MULTNAT, 
                      @VE1_MSFIL   = E1_MSFIL   ,@VE1_MSEMP   = E1_MSEMP   ,@VE1_PROJPMS = E1_PROJPMS ,@VE1_TIPODES = E1_TIPODES ,@VE1_TXMOEDA = E1_TXMOEDA, 
                      @VE1_DESDOBR = E1_DESDOBR ,@VE1_NRDOC   = E1_NRDOC   ,@VE1_MODSPB  = E1_MODSPB  ,@VE1_FETHAB  = E1_FETHAB  ,@VE1_NFELETR = E1_NFELETR, 
                      @VE1_IDCNAB  = E1_IDCNAB  ,@VE1_PARCFET = E1_PARCFET ,@VE1_PLCOEMP = E1_PLCOEMP ,@VE1_PLTPCOE = E1_PLTPCOE ,@VE1_BASEPIS = E1_BASEPIS, 
                      @VE1_BASECOF = E1_BASECOF ,@VE1_BASECSL = E1_BASECSL ,@VE1_CODCOR  = E1_CODCOR  ,@VE1_PARCCSS = E1_PARCCSS ,@VE1_SABTPIS = E1_SABTPIS, 
                      @VE1_SABTCOF = E1_SABTCOF ,@VE1_SABTCSL = E1_SABTCSL ,@VD_E_L_E_T_ = D_E_L_E_T_ ,@VR_E_C_N_O_ = R_E_C_N_O_ ,@VR_E_C_D_E_L_= R_E_C_D_E_L_,
                      @VE1_RECIBO  = E1_RECIBO  ,@VE1_DTACRED = E1_DTACRED ,@VE1_EMITCHQ = E1_EMITCHQ ,@VE1_CODORCA = E1_CODORCA ,@VE1_CODIMOV = E1_CODIMOV, 
                      @VE1_FILDEB  = E1_FILDEB  ,@VE1_NUMSOL  = E1_NUMSOL  ,@VE1_NUMRA   = E1_NUMRA   ,@VE1_INSCRIC = E1_INSCRIC ,@VE1_SERREC  = E1_SERREC,  
                      @VE1_DATAEDI = E1_DATAEDI ,@VE1_CODBAR  = E1_CODBAR  ,@VE1_CHQDEV  = E1_CHQDEV  ,@VE1_CODDIG  = E1_CODDIG  ,@VE1_VLBOLSA = E1_VLBOLSA, 
                      @VE1_LIDESCF = E1_LIDESCF ,@VE1_VLFIES  = E1_VLFIES  ,@VE1_NUMCRD  = E1_NUMCRD  ,@VE1_DEBITO  = E1_DEBITO  ,@VE1_CCD     = E1_CCD,     
                      @VE1_ITEMD   = E1_ITEMD   ,@VE1_CLVLDB  = E1_CLVLDB  ,@VE1_CREDIT  = E1_CREDIT  ,@VE1_CCC     = E1_CCC     ,@VE1_ITEMC   = E1_ITEMC,   
                      @VE1_CLVLCR  = E1_CLVLCR  ,@VE1_DESCON1 = E1_DESCON1 ,@VE1_DESCON2 = E1_DESCON2 ,@VE1_DTDESC3 = E1_DTDESC3 ,@VE1_DTDESC1 = E1_DTDESC1, 
                      @VE1_DTDESC2 = E1_DTDESC2 ,@VE1_VLMULTA = E1_VLMULTA ,@VE1_DESCON3 = E1_DESCON3 ,@VE1_MOTNEG  = E1_MOTNEG  ,@VE1_FORNISS = E1_FORNISS, 
                      @VE1_PARTOT  = E1_PARTOT  ,@VE1_SITFAT  = E1_SITFAT  ,@VE1_VRETISS = E1_VRETISS ,@VE1_PARCIRF = E1_PARCIRF ,@VE1_SCORGP  = E1_SCORGP,  
                      @VE1_FRETISS = E1_FRETISS ,@VE1_TXMDCOR = E1_TXMDCOR ,@VE1_SATBIRF = E1_SATBIRF ,@VE1_TIPREG  = E1_TIPREG  ,@VE1_CONEMP  = E1_CONEMP,  
                      @VE1_VERCON  = E1_VERCON  ,@VE1_SUBCON  = E1_SUBCON  ,@VE1_VERSUB  = E1_VERSUB  ,@VE1_PLLOTE  = E1_PLLOTE  ,@VE1_PLOPELT = E1_PLOPELT, 
                      @VE1_CODRDA  = E1_CODRDA  ,@VE1_FORMREC = E1_FORMREC ,@VE1_BCOCLI  = E1_BCOCLI  ,@VE1_AGECLI  = E1_AGECLI  ,@VE1_CTACLI  = E1_CTACLI,  
                      @VE1_NUMCON  = E1_NUMCON  
                 FROM INTEGRACAO_PROTHEUS_SE1
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [dbo].[MERCP_SE1010] 0,  @VE1_FILIAL  ,@VE1_PREFIXO ,@VE1_NUM     ,@VE1_PARCELA ,@VE1_EMISSAO ,@VE1_VENCTO  ,@VE1_VENCREA ,@VE1_CLIENTE ,@VE1_NOMCLI  
                            ,  @VE1_VALOR   ,@VE1_TIPO    ,@VE1_NATUREZ ,@VE1_PORTADO ,@VE1_AGEDEP  ,@VE1_LOJA    ,@VE1_IRRF    ,@VE1_ISS     ,@VE1_INSS    ,@VE1_NUMBCO  
                            ,  @VE1_INDICE  ,@VE1_BAIXA   ,@VE1_NUMBOR  ,@VE1_DATABOR ,@VE1_EMIS1   ,@VE1_HIST    ,@VE1_LA      ,@VE1_LOTE    ,@VE1_MOTIVO  
                            ,  @VE1_MOVIMEN ,@VE1_OP      ,@VE1_SITUACA ,@VE1_CONTRAT ,@VE1_SALDO   ,@VE1_SUPERVI ,@VE1_VEND1   ,@VE1_VEND2   ,@VE1_VEND3   
                            ,  @VE1_VEND4   ,@VE1_VEND5   ,@VE1_COMIS1  ,@VE1_COMIS2  ,@VE1_COMIS3  ,@VE1_COMIS4  ,@VE1_COMIS5  ,@VE1_DESCONT ,@VE1_MULTA   
                            ,  @VE1_JUROS   ,@VE1_CORREC  ,@VE1_VALLIQ  ,@VE1_VENCORI ,@VE1_CONTA   ,@VE1_VALJUR  ,@VE1_PORCJUR ,@VE1_MOEDA   ,@VE1_BASCOM1 
                            ,  @VE1_BASCOM2 ,@VE1_BASCOM3 ,@VE1_BASCOM4 ,@VE1_BASCOM5 ,@VE1_OK      ,@VE1_FATPREF ,@VE1_FATURA  ,@VE1_PROJETO ,@VE1_CLASCON 
                            ,  @VE1_VALCOM1 ,@VE1_VALCOM2 ,@VE1_VALCOM3 ,@VE1_VALCOM4 ,@VE1_VALCOM5 ,@VE1_OCORREN ,@VE1_INSTR1  ,@VE1_INSTR2  ,@VE1_PEDIDO  
                            ,  @VE1_DTVARIA ,@VE1_VARURV  ,@VE1_NUMNOTA ,@VE1_SERIE   ,@VE1_VLCRUZ  ,@VE1_DTFATUR ,@VE1_IDENTEE ,@VE1_STATUS  ,@VE1_ORIGEM  
                            ,  @VE1_NUMCART ,@VE1_FLUXO   ,@VE1_DESCFIN ,@VE1_DIADESC ,@VE1_CARTAO  ,@VE1_CARTVAL ,@VE1_VLRREAL ,@VE1_CARTAUT ,@VE1_ADM     
                            ,  @VE1_TRANSF  ,@VE1_ORDPAGO ,@VE1_BCOCHQ  ,@VE1_AGECHQ  ,@VE1_CTACHQ  ,@VE1_NUMLIQ  ,@VE1_COFINS  ,@VE1_FLAGFAT ,@VE1_CSLL    
                            ,  @VE1_FILORIG ,@VE1_PIS     ,@VE1_TIPOFAT ,@VE1_TIPOLIQ ,@VE1_MESBASE ,@VE1_ANOBASE ,@VE1_PLNUCOB ,@VE1_CODINT  ,@VE1_CODEMP  
                            ,  @VE1_MATRIC  ,@VE1_ACRESC  ,@VE1_SDACRES ,@VE1_DECRESC ,@VE1_SDDECRE ,@VE1_MULTNAT ,@VE1_MSFIL   ,@VE1_MSEMP   ,@VE1_PROJPMS 
                            ,  @VE1_TIPODES ,@VE1_TXMOEDA ,@VE1_DESDOBR ,@VE1_NRDOC   ,@VE1_MODSPB  ,@VE1_FETHAB  ,@VE1_NFELETR ,@VE1_IDCNAB  ,@VE1_PARCFET 
                            ,  @VE1_PLCOEMP ,@VE1_PLTPCOE ,@VE1_BASEPIS ,@VE1_BASECOF ,@VE1_BASECSL ,@VE1_CODCOR  ,@VE1_PARCCSS ,@VE1_SABTPIS ,@VE1_SABTCOF 
                            ,  @VE1_SABTCSL ,@VD_E_L_E_T_ ,@VR_E_C_N_O_ ,@VR_E_C_D_E_L_,@VE1_RECIBO  ,@VE1_DTACRED ,@VE1_EMITCHQ ,@VE1_CODORCA ,@VE1_CODIMOV 
                            ,  @VE1_FILDEB  ,@VE1_NUMSOL  ,@VE1_NUMRA   ,@VE1_INSCRIC ,@VE1_SERREC  ,@VE1_DATAEDI ,@VE1_CODBAR  ,@VE1_CHQDEV  ,@VE1_CODDIG  
                            ,  @VE1_VLBOLSA ,@VE1_LIDESCF ,@VE1_VLFIES  ,@VE1_NUMCRD  ,@VE1_DEBITO  ,@VE1_CCD     ,@VE1_ITEMD   ,@VE1_CLVLDB  ,@VE1_CREDIT  
                            ,  @VE1_CCC     ,@VE1_ITEMC   ,@VE1_CLVLCR  ,@VE1_DESCON1 ,@VE1_DESCON2 ,@VE1_DTDESC3 ,@VE1_DTDESC1 ,@VE1_DTDESC2 ,@VE1_VLMULTA 
                            ,  @VE1_DESCON3 ,@VE1_MOTNEG  ,@VE1_FORNISS ,@VE1_PARTOT  ,@VE1_SITFAT  ,@VE1_VRETISS ,@VE1_PARCIRF ,@VE1_SCORGP  ,@VE1_FRETISS 
                            ,  @VE1_TXMDCOR ,@VE1_SATBIRF ,@VE1_TIPREG  ,@VE1_CONEMP  ,@VE1_VERCON  ,@VE1_SUBCON  ,@VE1_VERSUB  ,@VE1_PLLOTE  ,@VE1_PLOPELT 
                            ,  @VE1_CODRDA  ,@VE1_FORMREC ,@VE1_BCOCLI  ,@VE1_AGECLI  ,@VE1_CTACLI  ,@VE1_NUMCON  


            END;
           ---------------------------
           ---- FIM 50 - TITULOS
           ---------------------------


           ---------------------------
           ---- 8108 - MOVIMENTOS DO TITULOS
           ---------------------------
           IF @P_TIPO = 8108
           BEGIN
               SELECT @VE5_FILIAL   = E5_FILIAL  , @VE5_DATA      = E5_DATA,         @VE5_TIPO      = E5_TIPO       ,@VE5_MOEDA    = E5_MOEDA  ,@VE5_VALOR     = E5_VALOR,    
                      @VE5_NATUREZ  = E5_NATUREZ , @VE5_BANCO      = E5_BANCO   , @VE5_AGENCIA = E5_AGENCIA ,@VE5_CONTA      = E5_CONTA  ,@VE5_NUMCHEQ  = E5_NUMCHEQ,    
                      @VE5_DOCUMEN  = E5_DOCUMEN , @VE5_VENCTO      = E5_VENCTO  , @VE5_RECPAG  = E5_RECPAG  ,@VE5_BENEF      = E5_BENEF  ,@VE5_HISTOR   = E5_HISTOR,    
                      @VE5_TIPODOC  = E5_TIPODOC , @VE5_VLMOED2   = E5_VLMOED2 , @VE5_LA      = E5_LA      ,@VE5_SITUACA  = E5_SITUACA,@VE5_LOTE     = E5_LOTE,    
                      @VE5_PREFIXO  = E5_PREFIXO , @VE5_NUMERO      = E5_NUMERO  , @VE5_PARCELA = E5_PARCELA ,@VE5_CLIFOR      = E5_CLIFOR ,@VE5_LOJA     = E5_LOJA,
                      @VE5_DTDIGIT  = E5_DTDIGIT , @VE5_TIPOLAN   = E5_TIPOLAN , @VE5_DEBITO  = E5_DEBITO  ,@VE5_CREDITO  = E5_CREDITO,@VE5_MOTBX     = E5_MOTBX,    
                      @VE5_RATEIO   = E5_RATEIO     , @VE5_RECONC      = E5_RECONC  , @VE5_SEQ     = E5_SEQ     ,@VE5_DTDISPO  = E5_DTDISPO,@VE5_CCD         = E5_CCD,    
                      @VE5_CCC        = E5_CCC     , @VE5_OK        = E5_OK,        @VE5_ARQRAT  = E5_ARQRAT  ,@VE5_IDENTEE  = E5_IDENTEE,@VE5_ORDREC     = E5_ORDREC,    
                      @VE5_FILORIG  = E5_FILORIG , @VE5_ARQCNAB   = E5_ARQCNAB , @VE5_VLJUROS = E5_VLJUROS ,@VE5_VLMULTA  = E5_VLMULTA,@VE5_VLCORRE  = E5_VLCORRE,    
                      @VE5_VLDESCO  = E5_VLDESCO , @VE5_CNABOC    = E5_CNABOC  , @VE5_SITUA   = E5_SITUA   ,@VE5_ITEMD      = E5_ITEMD  ,@VE5_ITEMC     = E5_ITEMC,    
                      @VE5_CLVLDB    = E5_CLVLDB     , @VE5_CLVLCR      = E5_CLVLCR  , @VE5_PROJPMS = E5_PROJPMS ,@VE5_EDTPMS      = E5_EDTPMS ,@VE5_TASKPMS  = E5_TASKPMS,    
                      @VE5_MODSPB   = E5_MODSPB     , @VE5_FATURA      = E5_FATURA  , @VE5_TXMOEDA = E5_TXMOEDA ,@VE5_CODORCA  = E5_CODORCA,@VE5_FATPREF  = E5_FATPREF,    
                      @VE5_SITCOB    = E5_SITCOB     , @VE5_FORNADT   = E5_FORNADT , @VE5_LOJAADT = E5_LOJAADT ,@VE5_CLIENTE  = E5_CLIENTE,@VE5_FORNECE  = E5_FORNECE,    
                      @VE5_SERREC    = E5_SERREC     , @VE5_OPERAD      = E5_OPERAD  , @VE5_MOVCX      = E5_MOVCX   ,@VE5_KEY      = E5_KEY      ,@VE5_MULTNAT  = E5_MULTNAT,    
                      @VE5_AGLIMP   = E5_AGLIMP     , @VE5_VLACRES   = E5_VLACRES , @VE5_VLDECRE = E5_VLDECRE ,@VE5_VRETPIS  = E5_VRETPIS,@VE5_VRETCOF  = E5_VRETCOF,    
                      @VE5_VRETCSL  = E5_VRETCSL , @VE5_PRETPIS   = E5_PRETPIS , @VE5_PRETCOF = E5_PRETCOF ,@VE5_PRETCSL  = E5_PRETCSL,@VE5_AUTBCO     = E5_AUTBCO,    
                      @VE5_PRETIRF  = E5_PRETIRF , @VE5_VRETIRF   = E5_VRETIRF , @VE5_VRETISS = E5_VRETISS ,@VE5_NUMMOV   = E5_NUMMOV ,@VE5_DIACTB   = E5_DIACTB,
                      @VE5_NODIA    = E5_NODIA     , @VE5_BASEIRF   = E5_BASEIRF , @VE5_PROCTRA = E5_PROCTRA ,@VD_E_L_E_T_  = D_E_L_E_T_,@VR_E_C_N_O_  = R_E_C_N_O_,    
                      @VE5_ORIGEM    = E5_ORIGEM     , @VE5_FORMAPG   = E5_FORMAPG , @VE5_TPDESC  = E5_TPDESC  ,@VE5_PRINSS      = E5_PRINSS ,@VE5_PRISS     = E5_PRISS,    
                      @VE5_PRETINS  = E5_PRETINS , @VE5_VRETINS   = E5_VRETINS , @VE5_IDMOVI  = E5_IDMOVI  ,@VE5_DTCANBX  = E5_DTCANBX,@VE5_FLDMED     = E5_FLDMED,    
                      @VE5_CGC      = E5_CGC    
                 FROM INTEGRACAO_PROTHEUS_SE5
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [dbo].[MERCP_SE5010] 0,  @VE5_FILIAL   ,@VE5_DATA      ,@VE5_TIPO      ,@VE5_MOEDA     ,@VE5_VALOR      ,@VE5_NATUREZ   ,@VE5_BANCO     ,@VE5_AGENCIA,  
                               @VE5_CONTA   ,@VE5_NUMCHEQ  ,@VE5_DOCUMEN  ,@VE5_VENCTO      ,@VE5_RECPAG      ,@VE5_BENEF      ,@VE5_HISTOR      ,@VE5_TIPODOC  ,@VE5_VLMOED2  
                             ,@VE5_LA       ,@VE5_SITUACA  ,@VE5_LOTE      ,@VE5_PREFIXO   ,@VE5_NUMERO      ,@VE5_PARCELA   ,@VE5_CLIFOR      ,@VE5_LOJA     ,@VE5_DTDIGIT  
                             ,@VE5_TIPOLAN  ,@VE5_DEBITO   ,@VE5_CREDITO  ,@VE5_MOTBX      ,@VE5_RATEIO      ,@VE5_RECONC      ,@VE5_SEQ       ,@VE5_DTDISPO  ,@VE5_CCD      
                             ,@VE5_CCC        ,@VE5_OK       ,@VE5_ARQRAT      ,@VE5_IDENTEE   ,@VE5_ORDREC      ,@VE5_FILORIG   ,@VE5_ARQCNAB   ,@VE5_VLJUROS  ,@VE5_VLMULTA  
                             ,@VE5_VLCORRE  ,@VE5_VLDESCO  ,@VE5_CNABOC   ,@VE5_SITUA     ,@VE5_ITEMD      ,@VE5_ITEMC      ,@VE5_CLVLDB      ,@VE5_CLVLCR     ,@VE5_PROJPMS  
                             ,@VE5_EDTPMS   ,@VE5_TASKPMS  ,@VE5_MODSPB      ,@VE5_FATURA      ,@VE5_TXMOEDA   ,@VE5_CODORCA   ,@VE5_FATPREF   ,@VE5_SITCOB     ,@VE5_FORNADT  
                             ,@VE5_LOJAADT  ,@VE5_CLIENTE  ,@VE5_FORNECE  ,@VE5_SERREC      ,@VE5_OPERAD      ,@VE5_MOVCX      ,@VE5_KEY          ,@VE5_MULTNAT  ,@VE5_AGLIMP      
                             ,@VE5_VLACRES  ,@VE5_VLDECRE  ,@VE5_VRETPIS  ,@VE5_VRETCOF   ,@VE5_VRETCSL   ,@VE5_PRETPIS   ,@VE5_PRETCOF   ,@VE5_PRETCSL  ,@VE5_AUTBCO      
                             ,@VE5_PRETIRF  ,@VE5_VRETIRF  ,@VE5_VRETISS  ,@VE5_NUMMOV    ,@VE5_DIACTB    ,@VE5_NODIA      ,@VE5_BASEIRF   ,@VE5_PROCTRA  ,@VD_E_L_E_T_  
                             ,@VR_E_C_N_O_  ,@VE5_ORIGEM   ,@VE5_FORMAPG  ,@VE5_TPDESC      ,@VE5_PRINSS      ,@VE5_PRISS      ,@VE5_PRETINS   ,@VE5_VRETINS  ,@VE5_IDMOVI      
                             ,@VE5_DTCANBX  ,@VE5_FLDMED   ,@VE5_CGC      

            END;
           ---------------------------
           ---- FIM 8108 - MOVIMENTOS DO TITULOS
           ---------------------------



           ---------------------------
           ---- 8109 - COMISSOES
           ---------------------------
           IF @P_TIPO = 8109
           BEGIN
               SELECT @VE3_FILIAL  = E3_FILIAL  , @VE3_VEND    = E3_VEND    , @VE3_NUM     = E3_NUM     , @VE3_EMISSAO = E3_EMISSAO , @VE3_SERIE   = E3_SERIE,
                      @VE3_CODCLI  = E3_CODCLI  , @VE3_LOJA    = E3_LOJA    , @VE3_BASE    = E3_BASE    , @VE3_PORC       = E3_PORC    , @VE3_COMIS   = E3_COMIS,
                      @VE3_DATA       = E3_DATA    , @VE3_PREFIXO = E3_PREFIXO , @VE3_PARCELA = E3_PARCELA , @VE3_TIPO    = E3_TIPO    , @VE3_BAIEMI  = E3_BAIEMI,
                      @VE3_PEDIDO  = E3_PEDIDO  , @VE3_SEQ     = E3_SEQ     , @VE3_ORIGEM  = E3_ORIGEM  , @VE3_VENCTO  = E3_VENCTO  , @VD_E_L_E_T_ = D_E_L_E_T_,
                      @VR_E_C_N_O_ = R_E_C_N_O_  
                 FROM INTEGRACAO_PROTHEUS_SE3
                WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR

               EXEC [dbo].[MERCP_SE3010] 0, @VE3_FILIAL    , @VE3_VEND,        @VE3_NUM,         @VE3_EMISSAO   , @VE3_SERIE     , @VE3_CODCLI    , @VE3_LOJA,
                             @VE3_BASE,        @VE3_PORC,         @VE3_COMIS,          @VE3_DATA,           @VE3_PREFIXO   , @VE3_PARCELA   , @VE3_TIPO,        @VE3_BAIEMI,
                             @VE3_PEDIDO  , @VE3_SEQ,         @VE3_ORIGEM    , @VE3_VENCTO    , @VD_E_L_E_T_   , @VR_E_C_N_O_
      

            END;
           ---------------------------
           ---- FIM 8109 - COMISSOES
           ---------------------------


  
            --- Após atualizar a informacao marca o registro como processado
            UPDATE DB_INTERFACE_PROTHEUS
               SET STATUS = 'PRO'
                 , DATA_PROCESSADO = GETDATE()
             WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR
               AND STATUS  = 'INS'
        
            FETCH NEXT FROM @C_INTERFACE
            INTO @VR_E_C_N_O_CURSOR
         END

         CLOSE @C_INTERFACE
         DEALLOCATE @C_INTERFACE


        --------------------------------------------
        --- PASSO 3 - Elimina da tabela de interface os registros ja processados a mais de 30 dias
        --------------------------------------------
        DELETE DB_INTERFACE_PROTHEUS
         WHERE TIPO = @P_TIPO
           AND STATUS  = 'PRO'
           AND DATA_PROCESSADO <= GETDATE() - 30

    END --- ELSE PASSO 2
     
END TRY

BEGIN CATCH
   SELECT @VERRO = cast(ERROR_NUMBER() as varchar) + ERROR_MESSAGE()

   UPDATE DB_INTERFACE_PROTHEUS
      SET STATUS = 'ERR'
        , DATA_PROCESSADO = GETDATE()
        , ERRO = @VERRO
     WHERE R_E_C_N_O_ = @VR_E_C_N_O_CURSOR
       AND STATUS  = 'INS'

   INSERT INTO DBS_ERROS_TRIGGERS
          (DBS_ERROS_ERRO, DBS_ERROS_DATA, DBS_ERROS_OBJETO)
        VALUES
          ( @VERRO, getdate(), @VOBJETO );            
END CATCH

END
GO


